import datetime

def getSQLScript(Request):
    nowdate = datetime.datetime.today()
    currentDate = datetime.datetime.today()- datetime.timedelta(hours =24) # yesterday
    tigahariyanglalu = datetime.datetime.today()- datetime.timedelta(hours =96) # yesterday
    yesterday = datetime.date.today() - datetime.timedelta(hours =192) # seminggu yang lalu


    todayminus4hour = datetime.datetime.today()- datetime.timedelta(hours =4)
    enamjamyanglalu = datetime.datetime.now()- datetime.timedelta(hours =8)

    if Request == "2G" :
        sqlscript_query = """Select a.xDate,b.oss
        ,sum(period_duration*ave_busy_tch/res_av_denom14/60) as TCH_Traffic
        ,100*(sum(((ifnull(sdcch_assign,0)))*((ifnull(tch_new_call_assign,0)))*(((ifnull(sdcch_assign,0)+ifnull(msc_i_sdcch,0)+ifnull(cell_sdcch,0)+ifnull(bsc_i_sdcch,0)))-((ifnull(sdcch_radio_fail,0)+ifnull(sdcch_rf_old_ho,0)+ifnull(sdcch_user_act,0)+ifnull(sdcch_bcsu_reset,0)+ifnull(sdcch_netw_act,0)+ifnull(sdcch_abis_fail_call,0)+ifnull(sdcch_abis_fail_old,0)+ifnull(sdcch_bts_fail,0)+ifnull(sdcch_lapd_fail,0)+ifnull(sdcch_a_if_fail_call,0)+ifnull(sdcch_a_if_fail_old,0)-ifnull(T3101_EXPIRED,0)))))/sum(((ifnull(sdcch_req,0)))*((ifnull(sdcch_assign,0)+ifnull(msc_i_sdcch,0)+ifnull(cell_sdcch,0)+ifnull(bsc_i_sdcch,0)))*((ifnull(tch_requests_call_attempt,0)))))  as CSSR
        ,100*(sum(ifnull(drop_after_tch_assign,0))/ sum(ifnull(tch_new_call_assign,0)+ifnull(bsc_i_tch_tch,0)+ifnull(msc_i_tch_tch,0)-ifnull(msc_o_tch_tch,0)-ifnull(bsc_o_tch_tch,0))) as DCR
        ,100*(sum(ifnull(msc_o_succ_ho,0)+ifnull(bsc_o_succ_ho,0)+ifnull(cell_succ_ho,0))/sum(ifnull(msc_o_ho_cmd,0)+ifnull(bsc_o_ho_cmd_assgn,0)+ifnull(bts_ho_assgn,0))) as HOSR
        from isat_project.t_2g_counter_day a Join isat_cm.bts b On a.xDate = b.xdate and a.BSC_ID = b.BSC and a.BCF_ID = b.BCF and a.BTS_ID = b.BTS
        Where a.xDate = '""" + currentDate.strftime("%Y-%m-%d") + """' Or a.xDate = '""" + yesterday.strftime("%Y-%m-%d") + """'
        group by a.xDate,b.oss"""
    elif Request == "3G" :
        sqlscript_query = """select a.xDate,f.oss
        ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2 + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traf_CS'
        ,round((sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL+NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL+RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000)/1000,2) as 'Traf_PS (Gb)'

        ,round(100*if(sum(a.moc_conv_call_atts+a.mtc_conv_call_atts+a.emergency_call_atts-a.RRC_ACC_REL_EMERGENCY-a.RRC_ACC_REL_MO_CONV-a.RRC_ACC_REL_MT_CONV-a.RRC_CONN_STP_REJ_EMERG_CALL+CELL_UPDATE_ATT_CS_CALL)=0, 0,
        (sum(a.moc_conv_call_atts-a.moc_conv_call_fails+a.mtc_conv_call_atts-a.mtc_conv_call_fails+a.emergency_call_atts-a.emergency_call_fails -a.RRC_ACC_REL_EMERGENCY-a.RRC_ACC_REL_MO_CONV-a.RRC_ACC_REL_MT_CONV + CELL_UPDATE_SUCC_CS_CALL)/sum(a.moc_conv_call_atts+a.mtc_conv_call_atts
        +a.emergency_call_atts-a.RRC_ACC_REL_EMERGENCY-a.RRC_ACC_REL_MO_CONV-a.RRC_ACC_REL_MT_CONV-a.RRC_CONN_STP_REJ_EMERG_CALL+CELL_UPDATE_ATT_CS_CALL)))
        *if(sum(a.rab_stp_att_cs_voice+a.rab_stp_att_cs_conv)=0, NULL,sum(a.rab_acc_comp_cs_voice+a.rab_acc_comp_cs_conv)/sum(a.rab_stp_att_cs_voice+a.rab_stp_att_cs_conv)),2) as 'CSSR_CS'

        ,round(100*((((sum(MOC_INTER_CALL_ATTS + MOC_BACKG_CALL_ATTS + MOC_HIGH_PRIOR_SIGN_ATTS + MTC_INTER_CALL_ATTS + MTC_BACKG_CALL_ATTS + MTC_HIGH_PRIOR_SIGN_ATTS - RRC_ACC_REL_INTERACTIVE - RRC_ACC_REL_MO_BACKGROUND - RRC_ACC_REL_MO_HIGH_PR_SIGN - RRC_ACC_REL_MO_INTERACTIVE - RRC_ACC_REL_MT_BACKGROUND - RRC_ACC_REL_MT_HIGH_PR_SIGN - RRC_ATT_REP_INTERACTIVE - RRC_ATT_REP_MO_INTERACTIVE - RRC_ATT_REP_MO_HIGH_PR_SIGN - RRC_ATT_REP_MO_BACKGROUND - RRC_ATT_REP_MT_BACKGROUND - RRC_ATT_REP_MT_HIGH_PR_SIGN))/(sum(MOC_INTER_CALL_ATTS + MOC_BACKG_CALL_ATTS + MOC_HIGH_PRIOR_SIGN_ATTS + MTC_INTER_CALL_ATTS + MTC_BACKG_CALL_ATTS + MTC_HIGH_PRIOR_SIGN_ATTS - RRC_ACC_REL_INTERACTIVE - RRC_ACC_REL_MO_BACKGROUND - RRC_ACC_REL_MO_HIGH_PR_SIGN - RRC_ACC_REL_MO_INTERACTIVE - RRC_ACC_REL_MT_BACKGROUND - RRC_ACC_REL_MT_HIGH_PR_SIGN - RRC_ATT_REP_INTERACTIVE - RRC_ATT_REP_MO_INTERACTIVE - RRC_ATT_REP_MO_HIGH_PR_SIGN - RRC_ATT_REP_MO_BACKGROUND - RRC_ATT_REP_MT_BACKGROUND - RRC_ATT_REP_MT_HIGH_PR_SIGN + PS_ATT_HSDSCH_EDCH_INT + PS_ATT_HSDSCH_EDCH_BGR + PS_ATT_HSDSCH_DCH_INT + PS_ATT_HSDSCH_DCH_BGR + PS_ATT_DCH_DCH_INT + PS_ATT_DCH_DCH_BGR + PS_ATT_HSDSCH_EDCH_STRE + PS_ATT_HSDSCH_DCH_STRE + PS_ATT_DCH_DCH_STRE))) *
        ((sum(MOC_INTER_CALL_ATTS - MOC_INTER_CALL_FAILS + MOC_BACKG_CALL_ATTS - MOC_BACKG_CALL_FAILS + MTC_INTER_CALL_ATTS - MTC_INTER_CALL_FAILS + MTC_BACKG_CALL_ATTS - MTC_BACKG_CALL_FAILS + MOC_HIGH_PRIOR_SIGN_ATTS - MOC_HIGH_PRIOR_SIGN_FAILS + MTC_HIGH_PRIOR_SIGN_ATTS - MTC_HIGH_PRIOR_SIGN_FAILS - RRC_ACC_REL_INTERACTIVE - RRC_ACC_REL_MO_BACKGROUND - RRC_ACC_REL_MO_HIGH_PR_SIGN - RRC_ACC_REL_MO_INTERACTIVE - RRC_ACC_REL_MT_BACKGROUND - RRC_ACC_REL_MT_HIGH_PR_SIGN))/(sum(MOC_INTER_CALL_ATTS + MOC_BACKG_CALL_ATTS + MOC_HIGH_PRIOR_SIGN_ATTS + MTC_INTER_CALL_ATTS + MTC_BACKG_CALL_ATTS + MTC_HIGH_PRIOR_SIGN_ATTS - RRC_ACC_REL_INTERACTIVE - RRC_ACC_REL_MO_BACKGROUND - RRC_ACC_REL_MO_HIGH_PR_SIGN - RRC_ACC_REL_MO_INTERACTIVE - RRC_ACC_REL_MT_BACKGROUND - RRC_ACC_REL_MT_HIGH_PR_SIGN - RRC_ATT_REP_INTERACTIVE - RRC_ATT_REP_MO_INTERACTIVE - RRC_ATT_REP_MO_HIGH_PR_SIGN - RRC_ATT_REP_MO_BACKGROUND - RRC_ATT_REP_MT_BACKGROUND - RRC_ATT_REP_MT_HIGH_PR_SIGN)))*((sum(RAB_ACC_COMP_PS_INTER - ALLO_SUCC_HSPA_DIREAL_INT + RAB_ACC_COMP_PS_BACKG - ALLO_SUCC_HSPA_DIREAL_BGR))/(sum(RAB_STP_ATT_PS_INTER - ALLO_SUCC_HSPA_DIREAL_INT + RAB_STP_ATT_PS_BACKG - ALLO_SUCC_HSPA_DIREAL_BGR))))+
        (((sum(PS_ATT_HSDSCH_EDCH_INT + PS_ATT_HSDSCH_EDCH_BGR + PS_ATT_HSDSCH_DCH_INT + PS_ATT_HSDSCH_DCH_BGR + PS_ATT_DCH_DCH_INT + PS_ATT_DCH_DCH_BGR + PS_ATT_HSDSCH_EDCH_STRE + PS_ATT_HSDSCH_DCH_STRE + PS_ATT_DCH_DCH_STRE))/(SUM((MOC_INTER_CALL_ATTS + MOC_BACKG_CALL_ATTS + MOC_HIGH_PRIOR_SIGN_ATTS + MTC_INTER_CALL_ATTS + MTC_BACKG_CALL_ATTS + MTC_HIGH_PRIOR_SIGN_ATTS - RRC_ACC_REL_INTERACTIVE - RRC_ACC_REL_MO_BACKGROUND - RRC_ACC_REL_MO_HIGH_PR_SIGN - RRC_ACC_REL_MO_INTERACTIVE - RRC_ACC_REL_MT_BACKGROUND - RRC_ACC_REL_MT_HIGH_PR_SIGN - RRC_ATT_REP_INTERACTIVE - RRC_ATT_REP_MO_INTERACTIVE - RRC_ATT_REP_MO_HIGH_PR_SIGN - RRC_ATT_REP_MO_BACKGROUND - RRC_ATT_REP_MT_BACKGROUND - RRC_ATT_REP_MT_HIGH_PR_SIGN)+(PS_ATT_HSDSCH_EDCH_INT + PS_ATT_HSDSCH_EDCH_BGR + PS_ATT_HSDSCH_DCH_INT + PS_ATT_HSDSCH_DCH_BGR + PS_ATT_DCH_DCH_INT + PS_ATT_DCH_DCH_BGR + PS_ATT_HSDSCH_EDCH_STRE + PS_ATT_HSDSCH_DCH_STRE + PS_ATT_DCH_DCH_STRE))))*
        ((sum(HS_E_REQ_HS_E_ALLO_INT + HS_E_REQ_HS_E_ALLO_BGR + HS_E_REQ_HS_D_ALLO_INT + HS_E_REQ_HS_D_ALLO_BGR + HS_D_REQ_HS_D_ALLO_INT + HS_D_REQ_HS_D_ALLO_BGR + HS_E_REQ_D_D_ALLO_INT + HS_E_REQ_D_D_ALLO_BGR + HS_D_REQ_D_D_ALLO_INT + HS_D_REQ_D_D_ALLO_BGR + D_D_REQ_D_D_ALLO_INT + D_D_REQ_D_D_ALLO_BGR + HS_E_REQ_HS_E_ALLO_STRE + HS_E_REQ_HS_D_ALLO_STRE + HS_D_REQ_HS_D_ALLO_STRE + HS_E_REQ_D_D_ALLO_STRE + HS_D_REQ_D_D_ALLO_STRE + D_D_REQ_D_D_ALLO_STRE))/(sum(PS_ATT_HSDSCH_EDCH_INT + PS_ATT_HSDSCH_EDCH_BGR + PS_ATT_HSDSCH_DCH_INT + PS_ATT_HSDSCH_DCH_BGR + PS_ATT_DCH_DCH_INT + PS_ATT_DCH_DCH_BGR + PS_ATT_HSDSCH_EDCH_STRE + PS_ATT_HSDSCH_DCH_STRE + PS_ATT_DCH_DCH_STRE))))),2) as 'CSSR_PS'

        ,round(100* (sum((RAB_ACT_REL_CS_VOICE_P_EMP+RAB_ACT_FAIL_CS_VOICE_IU+RAB_ACT_FAIL_CS_VOICE_RADIO+
        RAB_ACT_FAIL_CS_VOICE_BTS+RAB_ACT_FAIL_CS_VOICE_IUR+RAB_ACT_FAIL_CS_VOICE_RNC+RAB_ACT_FAIL_CS_VOICE_UE+
        RAB_ACT_FAIL_CS_VOICE_TRANS+RAB_ACT_FAIL_CS_CONV_IU+RAB_ACT_FAIL_CS_CONV_RADIO+RAB_ACT_FAIL_CS_CONV_BTS+
        RAB_ACT_FAIL_CS_CONV_RNC+RAB_ACT_FAIL_CS_CONV_IUR+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_REL_CS_CONV_P_EMP+
        RAB_ACT_FAIL_CS_CONV_TRANS+RAB_ACT_FAIL_CS_STREA_IU+RAB_ACT_FAIL_CS_STREA_RADIO+RAB_ACT_FAIL_CS_STREA_BTS+
        RAB_ACT_FAIL_CS_STREA_RNC+RAB_ACT_FAIL_CS_STREA_IUR+RAB_ACT_FAIL_CS_STREA_UE+RAB_ACT_REL_CS_STREA_P_EMP+RAB_ACT_FAIL_CS_STREA_TRANS)))/
        sum((RAB_ACT_COMP_CS_VOICE+RAB_ACT_REL_CS_VOICE_SRNC+RAB_ACT_REL_CS_VOICE_P_EMP+RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+RAB_ACT_FAIL_CS_VOICE_IU+
        RAB_ACT_FAIL_CS_VOICE_RADIO+RAB_ACT_FAIL_CS_VOICE_BTS+RAB_ACT_FAIL_CS_VOICE_IUR+RAB_ACT_FAIL_CS_VOICE_RNC+
        RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS+RAB_ACT_COMP_CS_CONV+RAB_ACT_REL_CS_CONV_SRNC+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+RAB_ACT_REL_CS_CONV_P_EMP+RAB_ACT_FAIL_CS_CONV_IU+
        RAB_ACT_FAIL_CS_CONV_RADIO+RAB_ACT_FAIL_CS_CONV_BTS+RAB_ACT_FAIL_CS_CONV_RNC+RAB_ACT_FAIL_CS_CONV_IUR+
        RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS+RAB_ACT_COMP_CS_STREA+RAB_ACT_REL_CS_STREA_SRNC+
        RAB_ACT_REL_CS_STREA_HHO+RAB_ACT_REL_CS_STREA_ISHO+RAB_ACT_REL_CS_STREA_P_EMP+RAB_ACT_FAIL_CS_STREA_IU+
        RAB_ACT_FAIL_CS_STREA_RADIO+RAB_ACT_FAIL_CS_STREA_BTS+RAB_ACT_FAIL_CS_STREA_RNC+RAB_ACT_FAIL_CS_STREA_IUR+
        RAB_ACT_FAIL_CS_STREA_UE+RAB_ACT_FAIL_CS_STREA_TRANS)),2) as 'CDR_CS'

        ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR+PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
        +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR+PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT+PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
        +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
        +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
        +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
        +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)/sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
        +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR+PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
        +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT+PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
        +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
        +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR_PS'

        ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
        + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
        100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
        sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
        + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'


        ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HS_users_thp'

        from isat_ws_3g.nokrww_ps_servlev_wcel_day a Join isat_ws_3g.nokrww_ps_traffic_wcel_day b On a.xDate=b.xDate and a.RNC_ID = b.RNC_ID and a.WBTS_ID =b.WBTS_ID and a.WCEL_ID = b.WCEL_ID
        Join isat_ws_3g.nokrww_ps_pktcall_wcel_day c On b.xDate = c.xDate and b.oss = c.oss and b.RNC_ID = c.RNC_ID and b.WBTS_ID = c.WBTS_ID and b.WCEL_ID = c.WCEL_ID
        Join isat_ws_3g.nokrww_ps_softho_wcel_day d On b.xDate = d.xDate and b.oss = d.oss and b.RNC_ID = d.RNC_ID and b.WBTS_ID = d.WBTS_ID and b.WCEL_ID = d.WCEL_ID
        Join isat_ws_3g.nokrww_ps_intsysho_wcel_day e On b.xDate = e.xDate and b.oss = e.oss and b.RNC_ID = e.RNC_ID and b.WBTS_ID = e.WBTS_ID and b.WCEL_ID = e.WCEL_ID
        Join isat_cm.wcel f ON a.xdate = f.xdate and a.RNC_ID = f.rnc and a.WBTS_ID = f.wbts and a.WCEL_ID = f.wcel
        Join isat_ws_3g.nokrww_ps_rrc_wcel_day g On b.xDate = g.xDate and b.oss = g.oss and b.RNC_ID = g.RNC_ID and b.WBTS_ID = g.WBTS_ID and b.WCEL_ID = g.WCEL_ID
        JOIN isat_ws_3g.nokrww_ps_celltp_wcel_day h On b.xDate = h.xDate and b.oss = h.oss and b.RNC_ID = h.RNC_ID and b.WBTS_ID = h.WBTS_ID and b.WCEL_ID = h.WCEL_ID
        JOIN isat_ws_3g.nokrww_ps_hsdpaw_wcel_day i On b.xDate = i.xDate and b.oss = i.oss and b.RNC_ID = i.RNC_ID and b.WBTS_ID = i.WBTS_ID and b.WCEL_ID = i.WCEL_ID
        JOIN isat_ws_3g.nokrww_ps_celtpw_wcel_day j On b.xDate = j.xDate and b.oss = j.oss and b.RNC_ID = j.RNC_ID and b.WBTS_ID = j.WBTS_ID and b.WCEL_ID = j.WCEL_ID

        where a.xDate = '""" + currentDate.strftime("%Y-%m-%d") + """' Or a.xDate = '""" + yesterday.strftime("%Y-%m-%d") + """'
        group by xdate,f.oss"""
    elif Request == "4G" :
        sqlscript_query = """SELECT a.xDate,g.oss
        ,round((sum(d.PDCP_SDU_VOL_DL)/1000000 + Sum(d.PDCP_SDU_VOL_UL)/1000000)/1000,2) as 'Payload (Gb)'
        ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg+SIGN_CONN_ESTAB_ATT_OTHERS)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`
        ,round(100*(sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)+ ERAB_REL_ENB_INI_S1_GLOB_RESET + ERAB_REL_ENB_INI_S1_PART_RESET + ERAB_REL_S1_OUTAGE) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0)+ERAB_REL_SUCC_HO_UTRAN + ERAB_REL_SUCC_HO_GERAN + ERAB_REL_ENB_INI_S1_GLOB_RESET + ERAB_REL_MME_INI_S1_GLOB_RESET + ERAB_REL_ENB_INI_S1_PART_RESET + ERAB_REL_MME_INI_S1_PART_RESET + ERAB_REL_S1_OUTAGE)),2) as `ERAB Drop`
        ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) as IntraHO
        ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) as 'DL_User_Thp'
        ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) as 'UL_User_Thp'


        From isat_ws_4g.noklte_ps_lepsb_lncel_day a
        JOIN isat_ws_4g.noklte_ps_luest_lncel_day c On a.xDate = c.xDate and a.MRBTS_ID = c.MRBTS_ID and a.LNBTS_ID = c.LNBTS_ID and a.LNCEL_ID = c.LNCEL_ID
        JOIN isat_ws_4g.noklte_ps_lho_lncel_day d On a.xDate = d.xDate and a.MRBTS_ID = d.MRBTS_ID and a.LNBTS_ID = d.LNBTS_ID and a.LNCEL_ID = d.LNCEL_ID
        JOIN isat_ws_4g.noklte_ps_lianbho_lncel_day e On a.xDate = e.xDate and a.MRBTS_ID = e.MRBTS_ID and a.LNBTS_ID = e.LNBTS_ID and a.LNCEL_ID = e.LNCEL_ID
        JOIN isat_ws_4g.noklte_ps_lienbho_lncel_day f On a.xDate = f.xDate and a.MRBTS_ID = f.MRBTS_ID and a.LNBTS_ID = f.LNBTS_ID and a.LNCEL_ID = f.LNCEL_ID
        JOIN isat_cm.lncel g ON a.mrbts_id = g.MRBTS and a.lnbts_id = g.LNBTS and a.lncel_id = g.LNCEL and a.xDate = g.xdate
        JOIN isat_ws_4g.noklte_ps_lcellt_lncel_day h On a.xDate = h.xDate and a.MRBTS_ID = h.MRBTS_ID and a.LNBTS_ID = h.LNBTS_ID and a.LNCEL_ID = h.LNCEL_ID

        WHERE  A.XDATE  = '""" + currentDate.strftime("%Y-%m-%d") + """' Or a.xDate = '""" + yesterday.strftime("%Y-%m-%d") + """'
        Group by a.xdate,g.oss"""
#================================
    elif Request == "Dash_Get_Data" :
        sqlscript_query = """TRUNCATE isat_report.`x_dashboard_2g_bh`;
        INSERT INTO isat_report.x_dashboard_2g_bh
        SELECT a.* FROM isat_project.t_2g_counter_bh a
        Join isat_report.local_profile_2g b On a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
        WHERE a.xDate >= '""" + currentDate.strftime("%Y-%m-%d") + """'  AND a.BSC_ID IS NOT NULL;

        TRUNCATE isat_report.`x_dashboard_3g_bh`;
        INSERT INTO isat_report.x_dashboard_3g_bh
        SELECT a.* FROM isat_project.t_3g_counter_bh_user a
        Join isat_report.local_profile_3g b On a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
        WHERE a.xDate >= '""" + currentDate.strftime("%Y-%m-%d") + """'  AND a.RNC_ID IS NOT NULL ;

        TRUNCATE isat_report.`x_dashboard_4g_BH`;
        INSERT INTO isat_report.x_dashboard_4g_BH
        SELECT a.* FROM isat_project.t_4g_counter_bh_user a
        Join isat_report.local_profile_4g b On a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
        WHERE a.xDate >= '""" + currentDate.strftime("%Y-%m-%d") + """'  AND a.MRBTS_ID IS NOT NULL ;

        TRUNCATE isat_report.`x_dashboard_2g`;
        INSERT INTO isat_report.x_dashboard_2g
        SELECT a.* FROM isat_project.t_2g_counter_day a
        Join isat_report.local_profile_2g b On a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
        WHERE a.xDate >= '""" + currentDate.strftime("%Y-%m-%d") + """'  AND a.BSC_ID IS NOT NULL;

        TRUNCATE isat_report.`x_dashboard_3g`;
        INSERT INTO isat_report.x_dashboard_3g
        SELECT a.* FROM isat_project.t_3g_counter_day a
        Join isat_report.local_profile_3g b On a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
        WHERE a.xDate >= '""" + currentDate.strftime("%Y-%m-%d") + """'  AND a.RNC_ID IS NOT NULL ;

        TRUNCATE isat_report.`x_dashboard_4g`;
        INSERT INTO isat_report.x_dashboard_4g
        SELECT a.* FROM isat_project.t_4g_counter_day a
        Join isat_report.local_profile_4g b On a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
        WHERE a.xDate >= '""" + currentDate.strftime("%Y-%m-%d") + """'  AND a.MRBTS_ID IS NOT NULL ;"""

    elif Request == "2Gdashboard_daily" :
        sqlscript_query = """(
                SELECT
                	a.xDate
                	,'All' AS `Aggregate`
                	,'Network' AS `Level`
                	,'All' AS `Band`

                	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

                	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

                	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

                	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

                	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

                	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
                	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
                	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

                	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
                + (dl_rlc_blocks_ack_mcs2)*28
                + (dl_rlc_blocks_ack_mcs3)*37
                + (dl_rlc_blocks_ack_mcs4)*44
                + (dl_rlc_blocks_ack_mcs5)*56
                + (dl_rlc_blocks_ack_mcs6)*74
                + (dl_rlc_blocks_ack_mcs7)*56
                + (dl_rlc_blocks_ack_mcs8)*68
                + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
                + (rlc_data_blocks_dl_cs2) *30
                + dl_rlc_blocks_ack_mcs11 *36
                + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
                sum((dl_rlc_blocks_ack_mcs1
                + dl_rlc_blocks_ack_mcs2
                + dl_rlc_blocks_ack_mcs3
                + dl_rlc_blocks_ack_mcs4
                + dl_rlc_blocks_ack_mcs5
                + dl_rlc_blocks_ack_mcs6)/50
                +(dl_rlc_blocks_ack_mcs7
                + dl_rlc_blocks_ack_mcs8
                + dl_rlc_blocks_ack_mcs9)/2/50
                +(rlc_data_blocks_dl_cs1
                - rlc_data_blocks_dl_unack
                + rlc_data_blocks_dl_cs2
                + retra_rlc_data_blocks_dl_cs1
                + retra_rlc_data_blocks_dl_cs2
                + dl_rlc_blocks_ack_mcs11
                + dl_rlc_blocks_ack_mcs12)/50
                ),2) as  `RLC_THP_DL`

                	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
                + (ul_rlc_blocks_ack_mcs2)*28
                + (ul_rlc_blocks_ack_mcs3)*37
                + (ul_rlc_blocks_ack_mcs4)*44
                + (ul_rlc_blocks_ack_mcs5)*56
                + (ul_rlc_blocks_ack_mcs6)*74
                + (ul_rlc_blocks_ack_mcs7)*56
                + (ul_rlc_blocks_ack_mcs8)*68
                + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
                +(rlc_data_blocks_ul_cs2) *30
                + ul_rlc_blocks_ack_mcs11 *36
                + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
                /
                sum((ul_rlc_blocks_ack_mcs1
                + ul_rlc_blocks_ack_mcs2
                + ul_rlc_blocks_ack_mcs3
                + ul_rlc_blocks_ack_mcs4
                + ul_rlc_blocks_ack_mcs5
                + ul_rlc_blocks_ack_mcs6)/50
                + (ul_rlc_blocks_ack_mcs7
                + ul_rlc_blocks_ack_mcs8
                + ul_rlc_blocks_ack_mcs9 )/2/50
                +(rlc_data_blocks_ul_cs1
                - rlc_data_blocks_ul_unack
                + rlc_data_blocks_ul_cs2
                + retra_data_blocks_ul_cs1
                + retra_data_blocks_ul_cs2
                + ul_rlc_blocks_ack_mcs11
                + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

                	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
                	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

                  ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
                  ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

                  ,COUNT(*) AS `numcel`


                  ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
                  ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
                  ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
                  ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

                  ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
                  ,sum(a.tch_radio_fail) as tch_radio_fail
                  ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
                  ,sum(a.tch_tr_fail) as tch_tr_fail
                  ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
                  ,sum(a.tch_netw_act) as tch_netw_act
                  ,sum(a.tch_lapd_fail) as tch_lapd_fail
                  ,sum(a.tch_bts_fail) as tch_bts_fail
                  ,sum(a.tch_act_fail_call)as tch_act_fail_call
                  ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
                  ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
                  ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
                  ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

                  ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
                  ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
                  ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
                  ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
                  ,sum(a.sdcch_netw_act) as sdcch_netw_act
                  ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
                  ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
                  ,sum(a.t3101_expired) as t3101_expired
                  ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
                  ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
                  ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


                FROM isat_report.x_dashboard_2g a
                LEFT JOIN isat_report.local_profile_2g b
                ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
                GROUP BY
                	a.xDate
                )

                UNION

                /* ### Aggregation (Program) ### */

                (
                SELECT
                	a.xDate
                	,'CatapultPO1' AS `Aggregate`
                	,'Network' AS `Level`
                	,'All' AS `Band`

                	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

                	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

                	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

                	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

                	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

                	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
                	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
                	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

                	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
                + (dl_rlc_blocks_ack_mcs2)*28
                + (dl_rlc_blocks_ack_mcs3)*37
                + (dl_rlc_blocks_ack_mcs4)*44
                + (dl_rlc_blocks_ack_mcs5)*56
                + (dl_rlc_blocks_ack_mcs6)*74
                + (dl_rlc_blocks_ack_mcs7)*56
                + (dl_rlc_blocks_ack_mcs8)*68
                + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
                + (rlc_data_blocks_dl_cs2) *30
                + dl_rlc_blocks_ack_mcs11 *36
                + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
                sum((dl_rlc_blocks_ack_mcs1
                + dl_rlc_blocks_ack_mcs2
                + dl_rlc_blocks_ack_mcs3
                + dl_rlc_blocks_ack_mcs4
                + dl_rlc_blocks_ack_mcs5
                + dl_rlc_blocks_ack_mcs6)/50
                +(dl_rlc_blocks_ack_mcs7
                + dl_rlc_blocks_ack_mcs8
                + dl_rlc_blocks_ack_mcs9)/2/50
                +(rlc_data_blocks_dl_cs1
                - rlc_data_blocks_dl_unack
                + rlc_data_blocks_dl_cs2
                + retra_rlc_data_blocks_dl_cs1
                + retra_rlc_data_blocks_dl_cs2
                + dl_rlc_blocks_ack_mcs11
                + dl_rlc_blocks_ack_mcs12)/50
                ),2) as  `RLC_THP_DL`

                	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
                + (ul_rlc_blocks_ack_mcs2)*28
                + (ul_rlc_blocks_ack_mcs3)*37
                + (ul_rlc_blocks_ack_mcs4)*44
                + (ul_rlc_blocks_ack_mcs5)*56
                + (ul_rlc_blocks_ack_mcs6)*74
                + (ul_rlc_blocks_ack_mcs7)*56
                + (ul_rlc_blocks_ack_mcs8)*68
                + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
                +(rlc_data_blocks_ul_cs2) *30
                + ul_rlc_blocks_ack_mcs11 *36
                + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
                /
                sum((ul_rlc_blocks_ack_mcs1
                + ul_rlc_blocks_ack_mcs2
                + ul_rlc_blocks_ack_mcs3
                + ul_rlc_blocks_ack_mcs4
                + ul_rlc_blocks_ack_mcs5
                + ul_rlc_blocks_ack_mcs6)/50
                + (ul_rlc_blocks_ack_mcs7
                + ul_rlc_blocks_ack_mcs8
                + ul_rlc_blocks_ack_mcs9 )/2/50
                +(rlc_data_blocks_ul_cs1
                - rlc_data_blocks_ul_unack
                + rlc_data_blocks_ul_cs2
                + retra_data_blocks_ul_cs1
                + retra_data_blocks_ul_cs2
                + ul_rlc_blocks_ack_mcs11
                + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

                	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
                	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

                  ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
                  ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

                  ,COUNT(*) AS `numcel`


                  ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
                  ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
                  ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
                  ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

                  ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
                  ,sum(a.tch_radio_fail) as tch_radio_fail
                  ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
                  ,sum(a.tch_tr_fail) as tch_tr_fail
                  ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
                  ,sum(a.tch_netw_act) as tch_netw_act
                  ,sum(a.tch_lapd_fail) as tch_lapd_fail
                  ,sum(a.tch_bts_fail) as tch_bts_fail
                  ,sum(a.tch_act_fail_call)as tch_act_fail_call
                  ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
                  ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
                  ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
                  ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

                  ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
                  ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
                  ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
                  ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
                  ,sum(a.sdcch_netw_act) as sdcch_netw_act
                  ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
                  ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
                  ,sum(a.t3101_expired) as t3101_expired
                  ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
                  ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
                  ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


                FROM isat_report.x_dashboard_2g a
                JOIN isat_report.local_profile_2g b
                ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
                where b.CatapultPO1 = 1
                GROUP BY
                	a.xDate
                )


                UNION

                /* ### Aggregation (Program) ### */

                (
                SELECT
                	a.xDate
                	,'CatapultPO1B' AS `Aggregate`
                	,'Network' AS `Level`
                	,'All' AS `Band`

                	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

                	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

                	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

                	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

                	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

                	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
                	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
                	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

                	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
                + (dl_rlc_blocks_ack_mcs2)*28
                + (dl_rlc_blocks_ack_mcs3)*37
                + (dl_rlc_blocks_ack_mcs4)*44
                + (dl_rlc_blocks_ack_mcs5)*56
                + (dl_rlc_blocks_ack_mcs6)*74
                + (dl_rlc_blocks_ack_mcs7)*56
                + (dl_rlc_blocks_ack_mcs8)*68
                + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
                + (rlc_data_blocks_dl_cs2) *30
                + dl_rlc_blocks_ack_mcs11 *36
                + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
                sum((dl_rlc_blocks_ack_mcs1
                + dl_rlc_blocks_ack_mcs2
                + dl_rlc_blocks_ack_mcs3
                + dl_rlc_blocks_ack_mcs4
                + dl_rlc_blocks_ack_mcs5
                + dl_rlc_blocks_ack_mcs6)/50
                +(dl_rlc_blocks_ack_mcs7
                + dl_rlc_blocks_ack_mcs8
                + dl_rlc_blocks_ack_mcs9)/2/50
                +(rlc_data_blocks_dl_cs1
                - rlc_data_blocks_dl_unack
                + rlc_data_blocks_dl_cs2
                + retra_rlc_data_blocks_dl_cs1
                + retra_rlc_data_blocks_dl_cs2
                + dl_rlc_blocks_ack_mcs11
                + dl_rlc_blocks_ack_mcs12)/50
                ),2) as  `RLC_THP_DL`

                	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
                + (ul_rlc_blocks_ack_mcs2)*28
                + (ul_rlc_blocks_ack_mcs3)*37
                + (ul_rlc_blocks_ack_mcs4)*44
                + (ul_rlc_blocks_ack_mcs5)*56
                + (ul_rlc_blocks_ack_mcs6)*74
                + (ul_rlc_blocks_ack_mcs7)*56
                + (ul_rlc_blocks_ack_mcs8)*68
                + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
                +(rlc_data_blocks_ul_cs2) *30
                + ul_rlc_blocks_ack_mcs11 *36
                + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
                /
                sum((ul_rlc_blocks_ack_mcs1
                + ul_rlc_blocks_ack_mcs2
                + ul_rlc_blocks_ack_mcs3
                + ul_rlc_blocks_ack_mcs4
                + ul_rlc_blocks_ack_mcs5
                + ul_rlc_blocks_ack_mcs6)/50
                + (ul_rlc_blocks_ack_mcs7
                + ul_rlc_blocks_ack_mcs8
                + ul_rlc_blocks_ack_mcs9 )/2/50
                +(rlc_data_blocks_ul_cs1
                - rlc_data_blocks_ul_unack
                + rlc_data_blocks_ul_cs2
                + retra_data_blocks_ul_cs1
                + retra_data_blocks_ul_cs2
                + ul_rlc_blocks_ack_mcs11
                + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

                	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
                	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

                  ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
                  ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

                  ,COUNT(*) AS `numcel`


                  ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
                  ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
                  ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
                  ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

                  ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
                  ,sum(a.tch_radio_fail) as tch_radio_fail
                  ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
                  ,sum(a.tch_tr_fail) as tch_tr_fail
                  ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
                  ,sum(a.tch_netw_act) as tch_netw_act
                  ,sum(a.tch_lapd_fail) as tch_lapd_fail
                  ,sum(a.tch_bts_fail) as tch_bts_fail
                  ,sum(a.tch_act_fail_call)as tch_act_fail_call
                  ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
                  ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
                  ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
                  ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

                  ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
                  ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
                  ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
                  ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
                  ,sum(a.sdcch_netw_act) as sdcch_netw_act
                  ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
                  ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
                  ,sum(a.t3101_expired) as t3101_expired
                  ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
                  ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
                  ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


                FROM isat_report.x_dashboard_2g a
                JOIN isat_report.local_profile_2g b
                ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
                where b.CatapultPO1B = 1
                GROUP BY
                	a.xDate
                )

                UNION

                /* ### Aggregation (Program) ### */

                (
                SELECT
                	a.xDate
                	,'4GOverlayPack3' AS `Aggregate`
                	,'Network' AS `Level`
                	,'All' AS `Band`

                	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

                	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

                	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

                	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

                	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

                	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
                	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
                	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

                	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
                + (dl_rlc_blocks_ack_mcs2)*28
                + (dl_rlc_blocks_ack_mcs3)*37
                + (dl_rlc_blocks_ack_mcs4)*44
                + (dl_rlc_blocks_ack_mcs5)*56
                + (dl_rlc_blocks_ack_mcs6)*74
                + (dl_rlc_blocks_ack_mcs7)*56
                + (dl_rlc_blocks_ack_mcs8)*68
                + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
                + (rlc_data_blocks_dl_cs2) *30
                + dl_rlc_blocks_ack_mcs11 *36
                + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
                sum((dl_rlc_blocks_ack_mcs1
                + dl_rlc_blocks_ack_mcs2
                + dl_rlc_blocks_ack_mcs3
                + dl_rlc_blocks_ack_mcs4
                + dl_rlc_blocks_ack_mcs5
                + dl_rlc_blocks_ack_mcs6)/50
                +(dl_rlc_blocks_ack_mcs7
                + dl_rlc_blocks_ack_mcs8
                + dl_rlc_blocks_ack_mcs9)/2/50
                +(rlc_data_blocks_dl_cs1
                - rlc_data_blocks_dl_unack
                + rlc_data_blocks_dl_cs2
                + retra_rlc_data_blocks_dl_cs1
                + retra_rlc_data_blocks_dl_cs2
                + dl_rlc_blocks_ack_mcs11
                + dl_rlc_blocks_ack_mcs12)/50
                ),2) as  `RLC_THP_DL`

                	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
                + (ul_rlc_blocks_ack_mcs2)*28
                + (ul_rlc_blocks_ack_mcs3)*37
                + (ul_rlc_blocks_ack_mcs4)*44
                + (ul_rlc_blocks_ack_mcs5)*56
                + (ul_rlc_blocks_ack_mcs6)*74
                + (ul_rlc_blocks_ack_mcs7)*56
                + (ul_rlc_blocks_ack_mcs8)*68
                + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
                +(rlc_data_blocks_ul_cs2) *30
                + ul_rlc_blocks_ack_mcs11 *36
                + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
                /
                sum((ul_rlc_blocks_ack_mcs1
                + ul_rlc_blocks_ack_mcs2
                + ul_rlc_blocks_ack_mcs3
                + ul_rlc_blocks_ack_mcs4
                + ul_rlc_blocks_ack_mcs5
                + ul_rlc_blocks_ack_mcs6)/50
                + (ul_rlc_blocks_ack_mcs7
                + ul_rlc_blocks_ack_mcs8
                + ul_rlc_blocks_ack_mcs9 )/2/50
                +(rlc_data_blocks_ul_cs1
                - rlc_data_blocks_ul_unack
                + rlc_data_blocks_ul_cs2
                + retra_data_blocks_ul_cs1
                + retra_data_blocks_ul_cs2
                + ul_rlc_blocks_ack_mcs11
                + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

                	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
                	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

                  ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
                  ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

                  ,COUNT(*) AS `numcel`


                  ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
                  ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
                  ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
                  ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

                  ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
                  ,sum(a.tch_radio_fail) as tch_radio_fail
                  ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
                  ,sum(a.tch_tr_fail) as tch_tr_fail
                  ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
                  ,sum(a.tch_netw_act) as tch_netw_act
                  ,sum(a.tch_lapd_fail) as tch_lapd_fail
                  ,sum(a.tch_bts_fail) as tch_bts_fail
                  ,sum(a.tch_act_fail_call)as tch_act_fail_call
                  ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
                  ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
                  ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
                  ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

                  ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
                  ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
                  ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
                  ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
                  ,sum(a.sdcch_netw_act) as sdcch_netw_act
                  ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
                  ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
                  ,sum(a.t3101_expired) as t3101_expired
                  ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
                  ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
                  ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


                FROM isat_report.x_dashboard_2g a
                JOIN isat_report.local_profile_2g b
                ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
                where b.4GOverlayPack3 = 1
                GROUP BY
                	a.xDate
                )

                UNION

                /* ### Aggregation (Program) ### */

                (
                SELECT
                	a.xDate
                	,'4GOverlayPack4' AS `Aggregate`
                	,'Network' AS `Level`
                	,'All' AS `Band`

                	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

                	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

                	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

                	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

                	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

                	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
                	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
                	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

                	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
                + (dl_rlc_blocks_ack_mcs2)*28
                + (dl_rlc_blocks_ack_mcs3)*37
                + (dl_rlc_blocks_ack_mcs4)*44
                + (dl_rlc_blocks_ack_mcs5)*56
                + (dl_rlc_blocks_ack_mcs6)*74
                + (dl_rlc_blocks_ack_mcs7)*56
                + (dl_rlc_blocks_ack_mcs8)*68
                + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
                + (rlc_data_blocks_dl_cs2) *30
                + dl_rlc_blocks_ack_mcs11 *36
                + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
                sum((dl_rlc_blocks_ack_mcs1
                + dl_rlc_blocks_ack_mcs2
                + dl_rlc_blocks_ack_mcs3
                + dl_rlc_blocks_ack_mcs4
                + dl_rlc_blocks_ack_mcs5
                + dl_rlc_blocks_ack_mcs6)/50
                +(dl_rlc_blocks_ack_mcs7
                + dl_rlc_blocks_ack_mcs8
                + dl_rlc_blocks_ack_mcs9)/2/50
                +(rlc_data_blocks_dl_cs1
                - rlc_data_blocks_dl_unack
                + rlc_data_blocks_dl_cs2
                + retra_rlc_data_blocks_dl_cs1
                + retra_rlc_data_blocks_dl_cs2
                + dl_rlc_blocks_ack_mcs11
                + dl_rlc_blocks_ack_mcs12)/50
                ),2) as  `RLC_THP_DL`

                	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
                + (ul_rlc_blocks_ack_mcs2)*28
                + (ul_rlc_blocks_ack_mcs3)*37
                + (ul_rlc_blocks_ack_mcs4)*44
                + (ul_rlc_blocks_ack_mcs5)*56
                + (ul_rlc_blocks_ack_mcs6)*74
                + (ul_rlc_blocks_ack_mcs7)*56
                + (ul_rlc_blocks_ack_mcs8)*68
                + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
                +(rlc_data_blocks_ul_cs2) *30
                + ul_rlc_blocks_ack_mcs11 *36
                + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
                /
                sum((ul_rlc_blocks_ack_mcs1
                + ul_rlc_blocks_ack_mcs2
                + ul_rlc_blocks_ack_mcs3
                + ul_rlc_blocks_ack_mcs4
                + ul_rlc_blocks_ack_mcs5
                + ul_rlc_blocks_ack_mcs6)/50
                + (ul_rlc_blocks_ack_mcs7
                + ul_rlc_blocks_ack_mcs8
                + ul_rlc_blocks_ack_mcs9 )/2/50
                +(rlc_data_blocks_ul_cs1
                - rlc_data_blocks_ul_unack
                + rlc_data_blocks_ul_cs2
                + retra_data_blocks_ul_cs1
                + retra_data_blocks_ul_cs2
                + ul_rlc_blocks_ack_mcs11
                + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

                	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
                	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

                  ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
                  ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

                  ,COUNT(*) AS `numcel`


                  ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
                  ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
                  ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
                  ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

                  ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
                  ,sum(a.tch_radio_fail) as tch_radio_fail
                  ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
                  ,sum(a.tch_tr_fail) as tch_tr_fail
                  ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
                  ,sum(a.tch_netw_act) as tch_netw_act
                  ,sum(a.tch_lapd_fail) as tch_lapd_fail
                  ,sum(a.tch_bts_fail) as tch_bts_fail
                  ,sum(a.tch_act_fail_call)as tch_act_fail_call
                  ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
                  ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
                  ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
                  ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

                  ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
                  ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
                  ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
                  ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
                  ,sum(a.sdcch_netw_act) as sdcch_netw_act
                  ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
                  ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
                  ,sum(a.t3101_expired) as t3101_expired
                  ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
                  ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
                  ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


                FROM isat_report.x_dashboard_2g a
                JOIN isat_report.local_profile_2g b
                ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
                where b.4GOverlayPack4 = 1
                GROUP BY
                	a.xDate
                )

                UNION

                /* ### Aggregation (Program) ### */

                (
                SELECT
                	a.xDate
                	,'SnapshotDecember2018' AS `Aggregate`
                	,'Network' AS `Level`
                	,'All' AS `Band`

                	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

                	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

                	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

                	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

                	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

                	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
                	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
                	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

                	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
                + (dl_rlc_blocks_ack_mcs2)*28
                + (dl_rlc_blocks_ack_mcs3)*37
                + (dl_rlc_blocks_ack_mcs4)*44
                + (dl_rlc_blocks_ack_mcs5)*56
                + (dl_rlc_blocks_ack_mcs6)*74
                + (dl_rlc_blocks_ack_mcs7)*56
                + (dl_rlc_blocks_ack_mcs8)*68
                + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
                + (rlc_data_blocks_dl_cs2) *30
                + dl_rlc_blocks_ack_mcs11 *36
                + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
                sum((dl_rlc_blocks_ack_mcs1
                + dl_rlc_blocks_ack_mcs2
                + dl_rlc_blocks_ack_mcs3
                + dl_rlc_blocks_ack_mcs4
                + dl_rlc_blocks_ack_mcs5
                + dl_rlc_blocks_ack_mcs6)/50
                +(dl_rlc_blocks_ack_mcs7
                + dl_rlc_blocks_ack_mcs8
                + dl_rlc_blocks_ack_mcs9)/2/50
                +(rlc_data_blocks_dl_cs1
                - rlc_data_blocks_dl_unack
                + rlc_data_blocks_dl_cs2
                + retra_rlc_data_blocks_dl_cs1
                + retra_rlc_data_blocks_dl_cs2
                + dl_rlc_blocks_ack_mcs11
                + dl_rlc_blocks_ack_mcs12)/50
                ),2) as  `RLC_THP_DL`

                	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
                + (ul_rlc_blocks_ack_mcs2)*28
                + (ul_rlc_blocks_ack_mcs3)*37
                + (ul_rlc_blocks_ack_mcs4)*44
                + (ul_rlc_blocks_ack_mcs5)*56
                + (ul_rlc_blocks_ack_mcs6)*74
                + (ul_rlc_blocks_ack_mcs7)*56
                + (ul_rlc_blocks_ack_mcs8)*68
                + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
                +(rlc_data_blocks_ul_cs2) *30
                + ul_rlc_blocks_ack_mcs11 *36
                + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
                /
                sum((ul_rlc_blocks_ack_mcs1
                + ul_rlc_blocks_ack_mcs2
                + ul_rlc_blocks_ack_mcs3
                + ul_rlc_blocks_ack_mcs4
                + ul_rlc_blocks_ack_mcs5
                + ul_rlc_blocks_ack_mcs6)/50
                + (ul_rlc_blocks_ack_mcs7
                + ul_rlc_blocks_ack_mcs8
                + ul_rlc_blocks_ack_mcs9 )/2/50
                +(rlc_data_blocks_ul_cs1
                - rlc_data_blocks_ul_unack
                + rlc_data_blocks_ul_cs2
                + retra_data_blocks_ul_cs1
                + retra_data_blocks_ul_cs2
                + ul_rlc_blocks_ack_mcs11
                + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

                	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
                	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

                  ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
                  ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

                  ,COUNT(*) AS `numcel`


                  ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
                  ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
                  ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
                  ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

                  ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
                  ,sum(a.tch_radio_fail) as tch_radio_fail
                  ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
                  ,sum(a.tch_tr_fail) as tch_tr_fail
                  ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
                  ,sum(a.tch_netw_act) as tch_netw_act
                  ,sum(a.tch_lapd_fail) as tch_lapd_fail
                  ,sum(a.tch_bts_fail) as tch_bts_fail
                  ,sum(a.tch_act_fail_call)as tch_act_fail_call
                  ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
                  ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
                  ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
                  ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

                  ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
                  ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
                  ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
                  ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
                  ,sum(a.sdcch_netw_act) as sdcch_netw_act
                  ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
                  ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
                  ,sum(a.t3101_expired) as t3101_expired
                  ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
                  ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
                  ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


                FROM isat_report.x_dashboard_2g a
                 JOIN isat_report.local_profile_2g b
                ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
                where b.SnapshotDecember2018 = 1
                GROUP BY
                	a.xDate
                )


                UNION

                /* ### Aggregation (Program), Level, Band ### */

                (
                SELECT
                	a.xDate
                	,'All' AS `Aggregate`
                	,b.AREA AS `Level`
                	,'All' AS `Band`

                	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

                	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

                	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

                	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

                	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

                	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
                	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
                	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

                	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
                + (dl_rlc_blocks_ack_mcs2)*28
                + (dl_rlc_blocks_ack_mcs3)*37
                + (dl_rlc_blocks_ack_mcs4)*44
                + (dl_rlc_blocks_ack_mcs5)*56
                + (dl_rlc_blocks_ack_mcs6)*74
                + (dl_rlc_blocks_ack_mcs7)*56
                + (dl_rlc_blocks_ack_mcs8)*68
                + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
                + (rlc_data_blocks_dl_cs2) *30
                + dl_rlc_blocks_ack_mcs11 *36
                + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
                sum((dl_rlc_blocks_ack_mcs1
                + dl_rlc_blocks_ack_mcs2
                + dl_rlc_blocks_ack_mcs3
                + dl_rlc_blocks_ack_mcs4
                + dl_rlc_blocks_ack_mcs5
                + dl_rlc_blocks_ack_mcs6)/50
                +(dl_rlc_blocks_ack_mcs7
                + dl_rlc_blocks_ack_mcs8
                + dl_rlc_blocks_ack_mcs9)/2/50
                +(rlc_data_blocks_dl_cs1
                - rlc_data_blocks_dl_unack
                + rlc_data_blocks_dl_cs2
                + retra_rlc_data_blocks_dl_cs1
                + retra_rlc_data_blocks_dl_cs2
                + dl_rlc_blocks_ack_mcs11
                + dl_rlc_blocks_ack_mcs12)/50
                ),2) as  `RLC_THP_DL`

                	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
                + (ul_rlc_blocks_ack_mcs2)*28
                + (ul_rlc_blocks_ack_mcs3)*37
                + (ul_rlc_blocks_ack_mcs4)*44
                + (ul_rlc_blocks_ack_mcs5)*56
                + (ul_rlc_blocks_ack_mcs6)*74
                + (ul_rlc_blocks_ack_mcs7)*56
                + (ul_rlc_blocks_ack_mcs8)*68
                + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
                +(rlc_data_blocks_ul_cs2) *30
                + ul_rlc_blocks_ack_mcs11 *36
                + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
                /
                sum((ul_rlc_blocks_ack_mcs1
                + ul_rlc_blocks_ack_mcs2
                + ul_rlc_blocks_ack_mcs3
                + ul_rlc_blocks_ack_mcs4
                + ul_rlc_blocks_ack_mcs5
                + ul_rlc_blocks_ack_mcs6)/50
                + (ul_rlc_blocks_ack_mcs7
                + ul_rlc_blocks_ack_mcs8
                + ul_rlc_blocks_ack_mcs9 )/2/50
                +(rlc_data_blocks_ul_cs1
                - rlc_data_blocks_ul_unack
                + rlc_data_blocks_ul_cs2
                + retra_data_blocks_ul_cs1
                + retra_data_blocks_ul_cs2
                + ul_rlc_blocks_ack_mcs11
                + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

                	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
                	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

                  ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
                  ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

                  ,COUNT(*) AS `numcel`


                  ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
                  ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
                  ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
                  ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

                  ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
                  ,sum(a.tch_radio_fail) as tch_radio_fail
                  ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
                  ,sum(a.tch_tr_fail) as tch_tr_fail
                  ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
                  ,sum(a.tch_netw_act) as tch_netw_act
                  ,sum(a.tch_lapd_fail) as tch_lapd_fail
                  ,sum(a.tch_bts_fail) as tch_bts_fail
                  ,sum(a.tch_act_fail_call)as tch_act_fail_call
                  ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
                  ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
                  ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
                  ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

                  ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
                  ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
                  ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
                  ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
                  ,sum(a.sdcch_netw_act) as sdcch_netw_act
                  ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
                  ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
                  ,sum(a.t3101_expired) as t3101_expired
                  ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
                  ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
                  ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


                FROM isat_report.x_dashboard_2g a
                JOIN isat_report.local_profile_2g b
                ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
                GROUP BY
                	a.xDate,b.AREA
                )

                UNION

                /* ### Aggregation (Program), Level, Band ### */

                (
                SELECT
                	a.xDate
                	,'All' AS `Aggregate`
                	,b.AREA AS `Level`
                	,b.BAND AS `Band`

                	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

                	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

                	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

                	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

                	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

                	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
                	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
                	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

                	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
                + (dl_rlc_blocks_ack_mcs2)*28
                + (dl_rlc_blocks_ack_mcs3)*37
                + (dl_rlc_blocks_ack_mcs4)*44
                + (dl_rlc_blocks_ack_mcs5)*56
                + (dl_rlc_blocks_ack_mcs6)*74
                + (dl_rlc_blocks_ack_mcs7)*56
                + (dl_rlc_blocks_ack_mcs8)*68
                + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
                + (rlc_data_blocks_dl_cs2) *30
                + dl_rlc_blocks_ack_mcs11 *36
                + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
                sum((dl_rlc_blocks_ack_mcs1
                + dl_rlc_blocks_ack_mcs2
                + dl_rlc_blocks_ack_mcs3
                + dl_rlc_blocks_ack_mcs4
                + dl_rlc_blocks_ack_mcs5
                + dl_rlc_blocks_ack_mcs6)/50
                +(dl_rlc_blocks_ack_mcs7
                + dl_rlc_blocks_ack_mcs8
                + dl_rlc_blocks_ack_mcs9)/2/50
                +(rlc_data_blocks_dl_cs1
                - rlc_data_blocks_dl_unack
                + rlc_data_blocks_dl_cs2
                + retra_rlc_data_blocks_dl_cs1
                + retra_rlc_data_blocks_dl_cs2
                + dl_rlc_blocks_ack_mcs11
                + dl_rlc_blocks_ack_mcs12)/50
                ),2) as  `RLC_THP_DL`

                	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
                + (ul_rlc_blocks_ack_mcs2)*28
                + (ul_rlc_blocks_ack_mcs3)*37
                + (ul_rlc_blocks_ack_mcs4)*44
                + (ul_rlc_blocks_ack_mcs5)*56
                + (ul_rlc_blocks_ack_mcs6)*74
                + (ul_rlc_blocks_ack_mcs7)*56
                + (ul_rlc_blocks_ack_mcs8)*68
                + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
                +(rlc_data_blocks_ul_cs2) *30
                + ul_rlc_blocks_ack_mcs11 *36
                + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
                /
                sum((ul_rlc_blocks_ack_mcs1
                + ul_rlc_blocks_ack_mcs2
                + ul_rlc_blocks_ack_mcs3
                + ul_rlc_blocks_ack_mcs4
                + ul_rlc_blocks_ack_mcs5
                + ul_rlc_blocks_ack_mcs6)/50
                + (ul_rlc_blocks_ack_mcs7
                + ul_rlc_blocks_ack_mcs8
                + ul_rlc_blocks_ack_mcs9 )/2/50
                +(rlc_data_blocks_ul_cs1
                - rlc_data_blocks_ul_unack
                + rlc_data_blocks_ul_cs2
                + retra_data_blocks_ul_cs1
                + retra_data_blocks_ul_cs2
                + ul_rlc_blocks_ack_mcs11
                + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

                	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
                	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

                  ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
                  ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

                  ,COUNT(*) AS `numcel`


                  ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
                  ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
                  ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
                  ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

                  ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
                  ,sum(a.tch_radio_fail) as tch_radio_fail
                  ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
                  ,sum(a.tch_tr_fail) as tch_tr_fail
                  ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
                  ,sum(a.tch_netw_act) as tch_netw_act
                  ,sum(a.tch_lapd_fail) as tch_lapd_fail
                  ,sum(a.tch_bts_fail) as tch_bts_fail
                  ,sum(a.tch_act_fail_call)as tch_act_fail_call
                  ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
                  ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
                  ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
                  ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

                  ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
                  ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
                  ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
                  ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
                  ,sum(a.sdcch_netw_act) as sdcch_netw_act
                  ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
                  ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
                  ,sum(a.t3101_expired) as t3101_expired
                  ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
                  ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
                  ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


                FROM isat_report.x_dashboard_2g a
                JOIN isat_report.local_profile_2g b
                ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
                GROUP BY
                	a.xDate,b.AREA,b.BAND
                )


                UNION
                /* ### Aggregation (Program), Level, Band ### */

                (
                SELECT
                	a.xDate
                	,'All' AS `Aggregate`
                	,'Network' AS `Level`
                	,b.Band AS `Band`

                	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

                	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

                	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

                	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

                	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

                	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
                	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
                	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

                	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
                + (dl_rlc_blocks_ack_mcs2)*28
                + (dl_rlc_blocks_ack_mcs3)*37
                + (dl_rlc_blocks_ack_mcs4)*44
                + (dl_rlc_blocks_ack_mcs5)*56
                + (dl_rlc_blocks_ack_mcs6)*74
                + (dl_rlc_blocks_ack_mcs7)*56
                + (dl_rlc_blocks_ack_mcs8)*68
                + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
                + (rlc_data_blocks_dl_cs2) *30
                + dl_rlc_blocks_ack_mcs11 *36
                + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
                sum((dl_rlc_blocks_ack_mcs1
                + dl_rlc_blocks_ack_mcs2
                + dl_rlc_blocks_ack_mcs3
                + dl_rlc_blocks_ack_mcs4
                + dl_rlc_blocks_ack_mcs5
                + dl_rlc_blocks_ack_mcs6)/50
                +(dl_rlc_blocks_ack_mcs7
                + dl_rlc_blocks_ack_mcs8
                + dl_rlc_blocks_ack_mcs9)/2/50
                +(rlc_data_blocks_dl_cs1
                - rlc_data_blocks_dl_unack
                + rlc_data_blocks_dl_cs2
                + retra_rlc_data_blocks_dl_cs1
                + retra_rlc_data_blocks_dl_cs2
                + dl_rlc_blocks_ack_mcs11
                + dl_rlc_blocks_ack_mcs12)/50
                ),2) as  `RLC_THP_DL`

                	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
                + (ul_rlc_blocks_ack_mcs2)*28
                + (ul_rlc_blocks_ack_mcs3)*37
                + (ul_rlc_blocks_ack_mcs4)*44
                + (ul_rlc_blocks_ack_mcs5)*56
                + (ul_rlc_blocks_ack_mcs6)*74
                + (ul_rlc_blocks_ack_mcs7)*56
                + (ul_rlc_blocks_ack_mcs8)*68
                + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
                +(rlc_data_blocks_ul_cs2) *30
                + ul_rlc_blocks_ack_mcs11 *36
                + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
                /
                sum((ul_rlc_blocks_ack_mcs1
                + ul_rlc_blocks_ack_mcs2
                + ul_rlc_blocks_ack_mcs3
                + ul_rlc_blocks_ack_mcs4
                + ul_rlc_blocks_ack_mcs5
                + ul_rlc_blocks_ack_mcs6)/50
                + (ul_rlc_blocks_ack_mcs7
                + ul_rlc_blocks_ack_mcs8
                + ul_rlc_blocks_ack_mcs9 )/2/50
                +(rlc_data_blocks_ul_cs1
                - rlc_data_blocks_ul_unack
                + rlc_data_blocks_ul_cs2
                + retra_data_blocks_ul_cs1
                + retra_data_blocks_ul_cs2
                + ul_rlc_blocks_ack_mcs11
                + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

                	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
                	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

                  ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
                  ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

                  ,COUNT(*) AS `numcel`


                  ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
                  ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
                  ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
                  ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

                  ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
                  ,sum(a.tch_radio_fail) as tch_radio_fail
                  ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
                  ,sum(a.tch_tr_fail) as tch_tr_fail
                  ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
                  ,sum(a.tch_netw_act) as tch_netw_act
                  ,sum(a.tch_lapd_fail) as tch_lapd_fail
                  ,sum(a.tch_bts_fail) as tch_bts_fail
                  ,sum(a.tch_act_fail_call)as tch_act_fail_call
                  ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
                  ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
                  ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
                  ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

                  ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
                  ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
                  ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
                  ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
                  ,sum(a.sdcch_netw_act) as sdcch_netw_act
                  ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
                  ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
                  ,sum(a.t3101_expired) as t3101_expired
                  ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
                  ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
                  ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


                FROM isat_report.x_dashboard_2g a
                JOIN isat_report.local_profile_2g b
                ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
                GROUP BY
                	a.xDate,b.BAND
                )


                UNION

                /* ### Aggregation (Program) ### */

                (
                SELECT
                	a.xDate
                	,'CatapultPO1' AS `Aggregate`
                	,b.AREA AS `Level`
                	,b.BAND AS `Band`

                	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

                	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

                	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

                	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

                	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

                	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
                	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
                	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

                	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
                + (dl_rlc_blocks_ack_mcs2)*28
                + (dl_rlc_blocks_ack_mcs3)*37
                + (dl_rlc_blocks_ack_mcs4)*44
                + (dl_rlc_blocks_ack_mcs5)*56
                + (dl_rlc_blocks_ack_mcs6)*74
                + (dl_rlc_blocks_ack_mcs7)*56
                + (dl_rlc_blocks_ack_mcs8)*68
                + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
                + (rlc_data_blocks_dl_cs2) *30
                + dl_rlc_blocks_ack_mcs11 *36
                + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
                sum((dl_rlc_blocks_ack_mcs1
                + dl_rlc_blocks_ack_mcs2
                + dl_rlc_blocks_ack_mcs3
                + dl_rlc_blocks_ack_mcs4
                + dl_rlc_blocks_ack_mcs5
                + dl_rlc_blocks_ack_mcs6)/50
                +(dl_rlc_blocks_ack_mcs7
                + dl_rlc_blocks_ack_mcs8
                + dl_rlc_blocks_ack_mcs9)/2/50
                +(rlc_data_blocks_dl_cs1
                - rlc_data_blocks_dl_unack
                + rlc_data_blocks_dl_cs2
                + retra_rlc_data_blocks_dl_cs1
                + retra_rlc_data_blocks_dl_cs2
                + dl_rlc_blocks_ack_mcs11
                + dl_rlc_blocks_ack_mcs12)/50
                ),2) as  `RLC_THP_DL`

                	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
                + (ul_rlc_blocks_ack_mcs2)*28
                + (ul_rlc_blocks_ack_mcs3)*37
                + (ul_rlc_blocks_ack_mcs4)*44
                + (ul_rlc_blocks_ack_mcs5)*56
                + (ul_rlc_blocks_ack_mcs6)*74
                + (ul_rlc_blocks_ack_mcs7)*56
                + (ul_rlc_blocks_ack_mcs8)*68
                + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
                +(rlc_data_blocks_ul_cs2) *30
                + ul_rlc_blocks_ack_mcs11 *36
                + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
                /
                sum((ul_rlc_blocks_ack_mcs1
                + ul_rlc_blocks_ack_mcs2
                + ul_rlc_blocks_ack_mcs3
                + ul_rlc_blocks_ack_mcs4
                + ul_rlc_blocks_ack_mcs5
                + ul_rlc_blocks_ack_mcs6)/50
                + (ul_rlc_blocks_ack_mcs7
                + ul_rlc_blocks_ack_mcs8
                + ul_rlc_blocks_ack_mcs9 )/2/50
                +(rlc_data_blocks_ul_cs1
                - rlc_data_blocks_ul_unack
                + rlc_data_blocks_ul_cs2
                + retra_data_blocks_ul_cs1
                + retra_data_blocks_ul_cs2
                + ul_rlc_blocks_ack_mcs11
                + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

                	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
                	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

                  ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
                  ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

                  ,COUNT(*) AS `numcel`


                  ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
                  ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
                  ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
                  ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

                  ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
                  ,sum(a.tch_radio_fail) as tch_radio_fail
                  ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
                  ,sum(a.tch_tr_fail) as tch_tr_fail
                  ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
                  ,sum(a.tch_netw_act) as tch_netw_act
                  ,sum(a.tch_lapd_fail) as tch_lapd_fail
                  ,sum(a.tch_bts_fail) as tch_bts_fail
                  ,sum(a.tch_act_fail_call)as tch_act_fail_call
                  ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
                  ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
                  ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
                  ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

                  ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
                  ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
                  ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
                  ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
                  ,sum(a.sdcch_netw_act) as sdcch_netw_act
                  ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
                  ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
                  ,sum(a.t3101_expired) as t3101_expired
                  ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
                  ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
                  ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


                FROM isat_report.x_dashboard_2g a
                JOIN isat_report.local_profile_2g b
                ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
                where b.CatapultPO1 = 1
                GROUP BY
                	a.xDate,b.AREA,b.BAND
                )


                UNION

                /* ### Aggregation (Program) ### */

                (
                SELECT
                	a.xDate
                	,'CatapultPO1B' AS `Aggregate`
                	,b.AREA AS `Level`
                	,b.BAND AS `Band`

                	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

                	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

                	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

                	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

                	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

                	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
                	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
                	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

                	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
                + (dl_rlc_blocks_ack_mcs2)*28
                + (dl_rlc_blocks_ack_mcs3)*37
                + (dl_rlc_blocks_ack_mcs4)*44
                + (dl_rlc_blocks_ack_mcs5)*56
                + (dl_rlc_blocks_ack_mcs6)*74
                + (dl_rlc_blocks_ack_mcs7)*56
                + (dl_rlc_blocks_ack_mcs8)*68
                + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
                + (rlc_data_blocks_dl_cs2) *30
                + dl_rlc_blocks_ack_mcs11 *36
                + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
                sum((dl_rlc_blocks_ack_mcs1
                + dl_rlc_blocks_ack_mcs2
                + dl_rlc_blocks_ack_mcs3
                + dl_rlc_blocks_ack_mcs4
                + dl_rlc_blocks_ack_mcs5
                + dl_rlc_blocks_ack_mcs6)/50
                +(dl_rlc_blocks_ack_mcs7
                + dl_rlc_blocks_ack_mcs8
                + dl_rlc_blocks_ack_mcs9)/2/50
                +(rlc_data_blocks_dl_cs1
                - rlc_data_blocks_dl_unack
                + rlc_data_blocks_dl_cs2
                + retra_rlc_data_blocks_dl_cs1
                + retra_rlc_data_blocks_dl_cs2
                + dl_rlc_blocks_ack_mcs11
                + dl_rlc_blocks_ack_mcs12)/50
                ),2) as  `RLC_THP_DL`

                	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
                + (ul_rlc_blocks_ack_mcs2)*28
                + (ul_rlc_blocks_ack_mcs3)*37
                + (ul_rlc_blocks_ack_mcs4)*44
                + (ul_rlc_blocks_ack_mcs5)*56
                + (ul_rlc_blocks_ack_mcs6)*74
                + (ul_rlc_blocks_ack_mcs7)*56
                + (ul_rlc_blocks_ack_mcs8)*68
                + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
                +(rlc_data_blocks_ul_cs2) *30
                + ul_rlc_blocks_ack_mcs11 *36
                + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
                /
                sum((ul_rlc_blocks_ack_mcs1
                + ul_rlc_blocks_ack_mcs2
                + ul_rlc_blocks_ack_mcs3
                + ul_rlc_blocks_ack_mcs4
                + ul_rlc_blocks_ack_mcs5
                + ul_rlc_blocks_ack_mcs6)/50
                + (ul_rlc_blocks_ack_mcs7
                + ul_rlc_blocks_ack_mcs8
                + ul_rlc_blocks_ack_mcs9 )/2/50
                +(rlc_data_blocks_ul_cs1
                - rlc_data_blocks_ul_unack
                + rlc_data_blocks_ul_cs2
                + retra_data_blocks_ul_cs1
                + retra_data_blocks_ul_cs2
                + ul_rlc_blocks_ack_mcs11
                + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

                	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
                	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

                  ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
                  ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

                  ,COUNT(*) AS `numcel`


                  ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
                  ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
                  ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
                  ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

                  ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
                  ,sum(a.tch_radio_fail) as tch_radio_fail
                  ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
                  ,sum(a.tch_tr_fail) as tch_tr_fail
                  ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
                  ,sum(a.tch_netw_act) as tch_netw_act
                  ,sum(a.tch_lapd_fail) as tch_lapd_fail
                  ,sum(a.tch_bts_fail) as tch_bts_fail
                  ,sum(a.tch_act_fail_call)as tch_act_fail_call
                  ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
                  ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
                  ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
                  ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

                  ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
                  ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
                  ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
                  ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
                  ,sum(a.sdcch_netw_act) as sdcch_netw_act
                  ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
                  ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
                  ,sum(a.t3101_expired) as t3101_expired
                  ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
                  ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
                  ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


                FROM isat_report.x_dashboard_2g a
                JOIN isat_report.local_profile_2g b
                ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
                where b.CatapultPO1B = 1
                GROUP BY
                	a.xDate,b.AREA,b.BAND
                )

                UNION

                /* ### Aggregation (Program) ### */

                (
                SELECT
                	a.xDate
                	,'4GOverlayPack3' AS `Aggregate`
                	,b.AREA AS `Level`
                	,b.BAND AS `Band`

                	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

                	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

                	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

                	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

                	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

                	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
                	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
                	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

                	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
                + (dl_rlc_blocks_ack_mcs2)*28
                + (dl_rlc_blocks_ack_mcs3)*37
                + (dl_rlc_blocks_ack_mcs4)*44
                + (dl_rlc_blocks_ack_mcs5)*56
                + (dl_rlc_blocks_ack_mcs6)*74
                + (dl_rlc_blocks_ack_mcs7)*56
                + (dl_rlc_blocks_ack_mcs8)*68
                + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
                + (rlc_data_blocks_dl_cs2) *30
                + dl_rlc_blocks_ack_mcs11 *36
                + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
                sum((dl_rlc_blocks_ack_mcs1
                + dl_rlc_blocks_ack_mcs2
                + dl_rlc_blocks_ack_mcs3
                + dl_rlc_blocks_ack_mcs4
                + dl_rlc_blocks_ack_mcs5
                + dl_rlc_blocks_ack_mcs6)/50
                +(dl_rlc_blocks_ack_mcs7
                + dl_rlc_blocks_ack_mcs8
                + dl_rlc_blocks_ack_mcs9)/2/50
                +(rlc_data_blocks_dl_cs1
                - rlc_data_blocks_dl_unack
                + rlc_data_blocks_dl_cs2
                + retra_rlc_data_blocks_dl_cs1
                + retra_rlc_data_blocks_dl_cs2
                + dl_rlc_blocks_ack_mcs11
                + dl_rlc_blocks_ack_mcs12)/50
                ),2) as  `RLC_THP_DL`

                	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
                + (ul_rlc_blocks_ack_mcs2)*28
                + (ul_rlc_blocks_ack_mcs3)*37
                + (ul_rlc_blocks_ack_mcs4)*44
                + (ul_rlc_blocks_ack_mcs5)*56
                + (ul_rlc_blocks_ack_mcs6)*74
                + (ul_rlc_blocks_ack_mcs7)*56
                + (ul_rlc_blocks_ack_mcs8)*68
                + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
                +(rlc_data_blocks_ul_cs2) *30
                + ul_rlc_blocks_ack_mcs11 *36
                + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
                /
                sum((ul_rlc_blocks_ack_mcs1
                + ul_rlc_blocks_ack_mcs2
                + ul_rlc_blocks_ack_mcs3
                + ul_rlc_blocks_ack_mcs4
                + ul_rlc_blocks_ack_mcs5
                + ul_rlc_blocks_ack_mcs6)/50
                + (ul_rlc_blocks_ack_mcs7
                + ul_rlc_blocks_ack_mcs8
                + ul_rlc_blocks_ack_mcs9 )/2/50
                +(rlc_data_blocks_ul_cs1
                - rlc_data_blocks_ul_unack
                + rlc_data_blocks_ul_cs2
                + retra_data_blocks_ul_cs1
                + retra_data_blocks_ul_cs2
                + ul_rlc_blocks_ack_mcs11
                + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

                	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
                	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

                  ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
                  ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

                  ,COUNT(*) AS `numcel`


                  ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
                  ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
                  ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
                  ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

                  ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
                  ,sum(a.tch_radio_fail) as tch_radio_fail
                  ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
                  ,sum(a.tch_tr_fail) as tch_tr_fail
                  ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
                  ,sum(a.tch_netw_act) as tch_netw_act
                  ,sum(a.tch_lapd_fail) as tch_lapd_fail
                  ,sum(a.tch_bts_fail) as tch_bts_fail
                  ,sum(a.tch_act_fail_call)as tch_act_fail_call
                  ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
                  ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
                  ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
                  ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

                  ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
                  ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
                  ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
                  ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
                  ,sum(a.sdcch_netw_act) as sdcch_netw_act
                  ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
                  ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
                  ,sum(a.t3101_expired) as t3101_expired
                  ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
                  ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
                  ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


                FROM isat_report.x_dashboard_2g a
                JOIN isat_report.local_profile_2g b
                ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
                where b.4GOverlayPack3 = 1
                GROUP BY
                	a.xDate,b.AREA,b.BAND
                )

                UNION

                /* ### Aggregation (Program) ### */

                (
                SELECT
                	a.xDate
                	,'4GOverlayPack4' AS `Aggregate`
                	,b.AREA AS `Level`
                	,b.BAND AS `Band`

                	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

                	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

                	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

                	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

                	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

                	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
                	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
                	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

                	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
                + (dl_rlc_blocks_ack_mcs2)*28
                + (dl_rlc_blocks_ack_mcs3)*37
                + (dl_rlc_blocks_ack_mcs4)*44
                + (dl_rlc_blocks_ack_mcs5)*56
                + (dl_rlc_blocks_ack_mcs6)*74
                + (dl_rlc_blocks_ack_mcs7)*56
                + (dl_rlc_blocks_ack_mcs8)*68
                + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
                + (rlc_data_blocks_dl_cs2) *30
                + dl_rlc_blocks_ack_mcs11 *36
                + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
                sum((dl_rlc_blocks_ack_mcs1
                + dl_rlc_blocks_ack_mcs2
                + dl_rlc_blocks_ack_mcs3
                + dl_rlc_blocks_ack_mcs4
                + dl_rlc_blocks_ack_mcs5
                + dl_rlc_blocks_ack_mcs6)/50
                +(dl_rlc_blocks_ack_mcs7
                + dl_rlc_blocks_ack_mcs8
                + dl_rlc_blocks_ack_mcs9)/2/50
                +(rlc_data_blocks_dl_cs1
                - rlc_data_blocks_dl_unack
                + rlc_data_blocks_dl_cs2
                + retra_rlc_data_blocks_dl_cs1
                + retra_rlc_data_blocks_dl_cs2
                + dl_rlc_blocks_ack_mcs11
                + dl_rlc_blocks_ack_mcs12)/50
                ),2) as  `RLC_THP_DL`

                	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
                + (ul_rlc_blocks_ack_mcs2)*28
                + (ul_rlc_blocks_ack_mcs3)*37
                + (ul_rlc_blocks_ack_mcs4)*44
                + (ul_rlc_blocks_ack_mcs5)*56
                + (ul_rlc_blocks_ack_mcs6)*74
                + (ul_rlc_blocks_ack_mcs7)*56
                + (ul_rlc_blocks_ack_mcs8)*68
                + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
                +(rlc_data_blocks_ul_cs2) *30
                + ul_rlc_blocks_ack_mcs11 *36
                + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
                /
                sum((ul_rlc_blocks_ack_mcs1
                + ul_rlc_blocks_ack_mcs2
                + ul_rlc_blocks_ack_mcs3
                + ul_rlc_blocks_ack_mcs4
                + ul_rlc_blocks_ack_mcs5
                + ul_rlc_blocks_ack_mcs6)/50
                + (ul_rlc_blocks_ack_mcs7
                + ul_rlc_blocks_ack_mcs8
                + ul_rlc_blocks_ack_mcs9 )/2/50
                +(rlc_data_blocks_ul_cs1
                - rlc_data_blocks_ul_unack
                + rlc_data_blocks_ul_cs2
                + retra_data_blocks_ul_cs1
                + retra_data_blocks_ul_cs2
                + ul_rlc_blocks_ack_mcs11
                + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

                	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
                	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

                  ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
                  ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

                  ,COUNT(*) AS `numcel`


                  ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
                  ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
                  ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
                  ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

                  ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
                  ,sum(a.tch_radio_fail) as tch_radio_fail
                  ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
                  ,sum(a.tch_tr_fail) as tch_tr_fail
                  ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
                  ,sum(a.tch_netw_act) as tch_netw_act
                  ,sum(a.tch_lapd_fail) as tch_lapd_fail
                  ,sum(a.tch_bts_fail) as tch_bts_fail
                  ,sum(a.tch_act_fail_call)as tch_act_fail_call
                  ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
                  ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
                  ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
                  ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

                  ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
                  ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
                  ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
                  ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
                  ,sum(a.sdcch_netw_act) as sdcch_netw_act
                  ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
                  ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
                  ,sum(a.t3101_expired) as t3101_expired
                  ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
                  ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
                  ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


                FROM isat_report.x_dashboard_2g a
                JOIN isat_report.local_profile_2g b
                ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
                where b.4GOverlayPack4 = 1
                GROUP BY
                	a.xDate,b.AREA,b.BAND
                )

                UNION

                /* ### Aggregation (Program) ### */

                (
                SELECT
                	a.xDate
                	,'SnapshotDecember2018' AS `Aggregate`
                	,b.AREA AS `Level`
                	,b.BAND AS `Band`

                	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

                	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

                	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

                	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

                	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

                	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
                	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
                	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

                	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
                + (dl_rlc_blocks_ack_mcs2)*28
                + (dl_rlc_blocks_ack_mcs3)*37
                + (dl_rlc_blocks_ack_mcs4)*44
                + (dl_rlc_blocks_ack_mcs5)*56
                + (dl_rlc_blocks_ack_mcs6)*74
                + (dl_rlc_blocks_ack_mcs7)*56
                + (dl_rlc_blocks_ack_mcs8)*68
                + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
                + (rlc_data_blocks_dl_cs2) *30
                + dl_rlc_blocks_ack_mcs11 *36
                + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
                sum((dl_rlc_blocks_ack_mcs1
                + dl_rlc_blocks_ack_mcs2
                + dl_rlc_blocks_ack_mcs3
                + dl_rlc_blocks_ack_mcs4
                + dl_rlc_blocks_ack_mcs5
                + dl_rlc_blocks_ack_mcs6)/50
                +(dl_rlc_blocks_ack_mcs7
                + dl_rlc_blocks_ack_mcs8
                + dl_rlc_blocks_ack_mcs9)/2/50
                +(rlc_data_blocks_dl_cs1
                - rlc_data_blocks_dl_unack
                + rlc_data_blocks_dl_cs2
                + retra_rlc_data_blocks_dl_cs1
                + retra_rlc_data_blocks_dl_cs2
                + dl_rlc_blocks_ack_mcs11
                + dl_rlc_blocks_ack_mcs12)/50
                ),2) as  `RLC_THP_DL`

                	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
                + (ul_rlc_blocks_ack_mcs2)*28
                + (ul_rlc_blocks_ack_mcs3)*37
                + (ul_rlc_blocks_ack_mcs4)*44
                + (ul_rlc_blocks_ack_mcs5)*56
                + (ul_rlc_blocks_ack_mcs6)*74
                + (ul_rlc_blocks_ack_mcs7)*56
                + (ul_rlc_blocks_ack_mcs8)*68
                + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
                +(rlc_data_blocks_ul_cs2) *30
                + ul_rlc_blocks_ack_mcs11 *36
                + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
                /
                sum((ul_rlc_blocks_ack_mcs1
                + ul_rlc_blocks_ack_mcs2
                + ul_rlc_blocks_ack_mcs3
                + ul_rlc_blocks_ack_mcs4
                + ul_rlc_blocks_ack_mcs5
                + ul_rlc_blocks_ack_mcs6)/50
                + (ul_rlc_blocks_ack_mcs7
                + ul_rlc_blocks_ack_mcs8
                + ul_rlc_blocks_ack_mcs9 )/2/50
                +(rlc_data_blocks_ul_cs1
                - rlc_data_blocks_ul_unack
                + rlc_data_blocks_ul_cs2
                + retra_data_blocks_ul_cs1
                + retra_data_blocks_ul_cs2
                + ul_rlc_blocks_ack_mcs11
                + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

                	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
                	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

                  ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
                  ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

                  ,COUNT(*) AS `numcel`


                  ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
                  ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
                  ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
                  ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

                  ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
                  ,sum(a.tch_radio_fail) as tch_radio_fail
                  ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
                  ,sum(a.tch_tr_fail) as tch_tr_fail
                  ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
                  ,sum(a.tch_netw_act) as tch_netw_act
                  ,sum(a.tch_lapd_fail) as tch_lapd_fail
                  ,sum(a.tch_bts_fail) as tch_bts_fail
                  ,sum(a.tch_act_fail_call)as tch_act_fail_call
                  ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
                  ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
                  ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
                  ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

                  ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
                  ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
                  ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
                  ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
                  ,sum(a.sdcch_netw_act) as sdcch_netw_act
                  ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
                  ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
                  ,sum(a.t3101_expired) as t3101_expired
                  ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
                  ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
                  ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


                FROM isat_report.x_dashboard_2g a
                 JOIN isat_report.local_profile_2g b
                ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
                where b.SnapshotDecember2018 = 1
                GROUP BY
                	a.xDate,b.AREA,b.BAND
                )

                UNION

                (
                SELECT
                	a.xDate
                	,'CatapultPO1' AS `Aggregate`
                	,b.AREA AS `Level`
                	,'All' AS `Band`

                	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

                	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

                	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

                	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

                	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

                	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
                	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
                	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

                	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
                + (dl_rlc_blocks_ack_mcs2)*28
                + (dl_rlc_blocks_ack_mcs3)*37
                + (dl_rlc_blocks_ack_mcs4)*44
                + (dl_rlc_blocks_ack_mcs5)*56
                + (dl_rlc_blocks_ack_mcs6)*74
                + (dl_rlc_blocks_ack_mcs7)*56
                + (dl_rlc_blocks_ack_mcs8)*68
                + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
                + (rlc_data_blocks_dl_cs2) *30
                + dl_rlc_blocks_ack_mcs11 *36
                + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
                sum((dl_rlc_blocks_ack_mcs1
                + dl_rlc_blocks_ack_mcs2
                + dl_rlc_blocks_ack_mcs3
                + dl_rlc_blocks_ack_mcs4
                + dl_rlc_blocks_ack_mcs5
                + dl_rlc_blocks_ack_mcs6)/50
                +(dl_rlc_blocks_ack_mcs7
                + dl_rlc_blocks_ack_mcs8
                + dl_rlc_blocks_ack_mcs9)/2/50
                +(rlc_data_blocks_dl_cs1
                - rlc_data_blocks_dl_unack
                + rlc_data_blocks_dl_cs2
                + retra_rlc_data_blocks_dl_cs1
                + retra_rlc_data_blocks_dl_cs2
                + dl_rlc_blocks_ack_mcs11
                + dl_rlc_blocks_ack_mcs12)/50
                ),2) as  `RLC_THP_DL`

                	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
                + (ul_rlc_blocks_ack_mcs2)*28
                + (ul_rlc_blocks_ack_mcs3)*37
                + (ul_rlc_blocks_ack_mcs4)*44
                + (ul_rlc_blocks_ack_mcs5)*56
                + (ul_rlc_blocks_ack_mcs6)*74
                + (ul_rlc_blocks_ack_mcs7)*56
                + (ul_rlc_blocks_ack_mcs8)*68
                + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
                +(rlc_data_blocks_ul_cs2) *30
                + ul_rlc_blocks_ack_mcs11 *36
                + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
                /
                sum((ul_rlc_blocks_ack_mcs1
                + ul_rlc_blocks_ack_mcs2
                + ul_rlc_blocks_ack_mcs3
                + ul_rlc_blocks_ack_mcs4
                + ul_rlc_blocks_ack_mcs5
                + ul_rlc_blocks_ack_mcs6)/50
                + (ul_rlc_blocks_ack_mcs7
                + ul_rlc_blocks_ack_mcs8
                + ul_rlc_blocks_ack_mcs9 )/2/50
                +(rlc_data_blocks_ul_cs1
                - rlc_data_blocks_ul_unack
                + rlc_data_blocks_ul_cs2
                + retra_data_blocks_ul_cs1
                + retra_data_blocks_ul_cs2
                + ul_rlc_blocks_ack_mcs11
                + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

                	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
                	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

                  ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
                  ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

                  ,COUNT(*) AS `numcel`


                  ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
                  ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
                  ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
                  ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

                  ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
                  ,sum(a.tch_radio_fail) as tch_radio_fail
                  ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
                  ,sum(a.tch_tr_fail) as tch_tr_fail
                  ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
                  ,sum(a.tch_netw_act) as tch_netw_act
                  ,sum(a.tch_lapd_fail) as tch_lapd_fail
                  ,sum(a.tch_bts_fail) as tch_bts_fail
                  ,sum(a.tch_act_fail_call)as tch_act_fail_call
                  ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
                  ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
                  ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
                  ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

                  ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
                  ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
                  ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
                  ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
                  ,sum(a.sdcch_netw_act) as sdcch_netw_act
                  ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
                  ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
                  ,sum(a.t3101_expired) as t3101_expired
                  ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
                  ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
                  ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


                FROM isat_report.x_dashboard_2g a
                JOIN isat_report.local_profile_2g b
                ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
                where b.CatapultPO1 = 1
                GROUP BY
                	a.xDate,b.AREA
                )


                UNION

                /* ### Aggregation (Program) ### */

                (
                SELECT
                	a.xDate
                	,'CatapultPO1B' AS `Aggregate`
                	,b.AREA AS `Level`
                	,'All' AS `Band`

                	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

                	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

                	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

                	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

                	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

                	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
                	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
                	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

                	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
                + (dl_rlc_blocks_ack_mcs2)*28
                + (dl_rlc_blocks_ack_mcs3)*37
                + (dl_rlc_blocks_ack_mcs4)*44
                + (dl_rlc_blocks_ack_mcs5)*56
                + (dl_rlc_blocks_ack_mcs6)*74
                + (dl_rlc_blocks_ack_mcs7)*56
                + (dl_rlc_blocks_ack_mcs8)*68
                + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
                + (rlc_data_blocks_dl_cs2) *30
                + dl_rlc_blocks_ack_mcs11 *36
                + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
                sum((dl_rlc_blocks_ack_mcs1
                + dl_rlc_blocks_ack_mcs2
                + dl_rlc_blocks_ack_mcs3
                + dl_rlc_blocks_ack_mcs4
                + dl_rlc_blocks_ack_mcs5
                + dl_rlc_blocks_ack_mcs6)/50
                +(dl_rlc_blocks_ack_mcs7
                + dl_rlc_blocks_ack_mcs8
                + dl_rlc_blocks_ack_mcs9)/2/50
                +(rlc_data_blocks_dl_cs1
                - rlc_data_blocks_dl_unack
                + rlc_data_blocks_dl_cs2
                + retra_rlc_data_blocks_dl_cs1
                + retra_rlc_data_blocks_dl_cs2
                + dl_rlc_blocks_ack_mcs11
                + dl_rlc_blocks_ack_mcs12)/50
                ),2) as  `RLC_THP_DL`

                	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
                + (ul_rlc_blocks_ack_mcs2)*28
                + (ul_rlc_blocks_ack_mcs3)*37
                + (ul_rlc_blocks_ack_mcs4)*44
                + (ul_rlc_blocks_ack_mcs5)*56
                + (ul_rlc_blocks_ack_mcs6)*74
                + (ul_rlc_blocks_ack_mcs7)*56
                + (ul_rlc_blocks_ack_mcs8)*68
                + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
                +(rlc_data_blocks_ul_cs2) *30
                + ul_rlc_blocks_ack_mcs11 *36
                + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
                /
                sum((ul_rlc_blocks_ack_mcs1
                + ul_rlc_blocks_ack_mcs2
                + ul_rlc_blocks_ack_mcs3
                + ul_rlc_blocks_ack_mcs4
                + ul_rlc_blocks_ack_mcs5
                + ul_rlc_blocks_ack_mcs6)/50
                + (ul_rlc_blocks_ack_mcs7
                + ul_rlc_blocks_ack_mcs8
                + ul_rlc_blocks_ack_mcs9 )/2/50
                +(rlc_data_blocks_ul_cs1
                - rlc_data_blocks_ul_unack
                + rlc_data_blocks_ul_cs2
                + retra_data_blocks_ul_cs1
                + retra_data_blocks_ul_cs2
                + ul_rlc_blocks_ack_mcs11
                + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

                	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
                	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

                  ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
                  ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

                  ,COUNT(*) AS `numcel`


                  ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
                  ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
                  ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
                  ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

                  ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
                  ,sum(a.tch_radio_fail) as tch_radio_fail
                  ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
                  ,sum(a.tch_tr_fail) as tch_tr_fail
                  ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
                  ,sum(a.tch_netw_act) as tch_netw_act
                  ,sum(a.tch_lapd_fail) as tch_lapd_fail
                  ,sum(a.tch_bts_fail) as tch_bts_fail
                  ,sum(a.tch_act_fail_call)as tch_act_fail_call
                  ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
                  ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
                  ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
                  ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

                  ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
                  ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
                  ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
                  ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
                  ,sum(a.sdcch_netw_act) as sdcch_netw_act
                  ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
                  ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
                  ,sum(a.t3101_expired) as t3101_expired
                  ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
                  ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
                  ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


                FROM isat_report.x_dashboard_2g a
                JOIN isat_report.local_profile_2g b
                ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
                where b.CatapultPO1B = 1
                GROUP BY
                	a.xDate,b.AREA
                )

                UNION

                /* ### Aggregation (Program) ### */

                (
                SELECT
                	a.xDate
                	,'4GOverlayPack3' AS `Aggregate`
                	,b.AREA AS `Level`
                	,'All' AS `Band`

                	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

                	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

                	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

                	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

                	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

                	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
                	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
                	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

                	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
                + (dl_rlc_blocks_ack_mcs2)*28
                + (dl_rlc_blocks_ack_mcs3)*37
                + (dl_rlc_blocks_ack_mcs4)*44
                + (dl_rlc_blocks_ack_mcs5)*56
                + (dl_rlc_blocks_ack_mcs6)*74
                + (dl_rlc_blocks_ack_mcs7)*56
                + (dl_rlc_blocks_ack_mcs8)*68
                + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
                + (rlc_data_blocks_dl_cs2) *30
                + dl_rlc_blocks_ack_mcs11 *36
                + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
                sum((dl_rlc_blocks_ack_mcs1
                + dl_rlc_blocks_ack_mcs2
                + dl_rlc_blocks_ack_mcs3
                + dl_rlc_blocks_ack_mcs4
                + dl_rlc_blocks_ack_mcs5
                + dl_rlc_blocks_ack_mcs6)/50
                +(dl_rlc_blocks_ack_mcs7
                + dl_rlc_blocks_ack_mcs8
                + dl_rlc_blocks_ack_mcs9)/2/50
                +(rlc_data_blocks_dl_cs1
                - rlc_data_blocks_dl_unack
                + rlc_data_blocks_dl_cs2
                + retra_rlc_data_blocks_dl_cs1
                + retra_rlc_data_blocks_dl_cs2
                + dl_rlc_blocks_ack_mcs11
                + dl_rlc_blocks_ack_mcs12)/50
                ),2) as  `RLC_THP_DL`

                	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
                + (ul_rlc_blocks_ack_mcs2)*28
                + (ul_rlc_blocks_ack_mcs3)*37
                + (ul_rlc_blocks_ack_mcs4)*44
                + (ul_rlc_blocks_ack_mcs5)*56
                + (ul_rlc_blocks_ack_mcs6)*74
                + (ul_rlc_blocks_ack_mcs7)*56
                + (ul_rlc_blocks_ack_mcs8)*68
                + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
                +(rlc_data_blocks_ul_cs2) *30
                + ul_rlc_blocks_ack_mcs11 *36
                + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
                /
                sum((ul_rlc_blocks_ack_mcs1
                + ul_rlc_blocks_ack_mcs2
                + ul_rlc_blocks_ack_mcs3
                + ul_rlc_blocks_ack_mcs4
                + ul_rlc_blocks_ack_mcs5
                + ul_rlc_blocks_ack_mcs6)/50
                + (ul_rlc_blocks_ack_mcs7
                + ul_rlc_blocks_ack_mcs8
                + ul_rlc_blocks_ack_mcs9 )/2/50
                +(rlc_data_blocks_ul_cs1
                - rlc_data_blocks_ul_unack
                + rlc_data_blocks_ul_cs2
                + retra_data_blocks_ul_cs1
                + retra_data_blocks_ul_cs2
                + ul_rlc_blocks_ack_mcs11
                + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

                	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
                	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

                  ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
                  ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

                  ,COUNT(*) AS `numcel`


                  ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
                  ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
                  ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
                  ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

                  ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
                  ,sum(a.tch_radio_fail) as tch_radio_fail
                  ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
                  ,sum(a.tch_tr_fail) as tch_tr_fail
                  ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
                  ,sum(a.tch_netw_act) as tch_netw_act
                  ,sum(a.tch_lapd_fail) as tch_lapd_fail
                  ,sum(a.tch_bts_fail) as tch_bts_fail
                  ,sum(a.tch_act_fail_call)as tch_act_fail_call
                  ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
                  ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
                  ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
                  ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

                  ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
                  ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
                  ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
                  ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
                  ,sum(a.sdcch_netw_act) as sdcch_netw_act
                  ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
                  ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
                  ,sum(a.t3101_expired) as t3101_expired
                  ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
                  ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
                  ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


                FROM isat_report.x_dashboard_2g a
                JOIN isat_report.local_profile_2g b
                ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
                where b.4GOverlayPack3 = 1
                GROUP BY
                	a.xDate,b.AREA
                )

                UNION

                /* ### Aggregation (Program) ### */

                (
                SELECT
                	a.xDate
                	,'4GOverlayPack4' AS `Aggregate`
                	,b.AREA AS `Level`
                	,'All' AS `Band`

                	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

                	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

                	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

                	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

                	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

                	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
                	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
                	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

                	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
                + (dl_rlc_blocks_ack_mcs2)*28
                + (dl_rlc_blocks_ack_mcs3)*37
                + (dl_rlc_blocks_ack_mcs4)*44
                + (dl_rlc_blocks_ack_mcs5)*56
                + (dl_rlc_blocks_ack_mcs6)*74
                + (dl_rlc_blocks_ack_mcs7)*56
                + (dl_rlc_blocks_ack_mcs8)*68
                + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
                + (rlc_data_blocks_dl_cs2) *30
                + dl_rlc_blocks_ack_mcs11 *36
                + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
                sum((dl_rlc_blocks_ack_mcs1
                + dl_rlc_blocks_ack_mcs2
                + dl_rlc_blocks_ack_mcs3
                + dl_rlc_blocks_ack_mcs4
                + dl_rlc_blocks_ack_mcs5
                + dl_rlc_blocks_ack_mcs6)/50
                +(dl_rlc_blocks_ack_mcs7
                + dl_rlc_blocks_ack_mcs8
                + dl_rlc_blocks_ack_mcs9)/2/50
                +(rlc_data_blocks_dl_cs1
                - rlc_data_blocks_dl_unack
                + rlc_data_blocks_dl_cs2
                + retra_rlc_data_blocks_dl_cs1
                + retra_rlc_data_blocks_dl_cs2
                + dl_rlc_blocks_ack_mcs11
                + dl_rlc_blocks_ack_mcs12)/50
                ),2) as  `RLC_THP_DL`

                	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
                + (ul_rlc_blocks_ack_mcs2)*28
                + (ul_rlc_blocks_ack_mcs3)*37
                + (ul_rlc_blocks_ack_mcs4)*44
                + (ul_rlc_blocks_ack_mcs5)*56
                + (ul_rlc_blocks_ack_mcs6)*74
                + (ul_rlc_blocks_ack_mcs7)*56
                + (ul_rlc_blocks_ack_mcs8)*68
                + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
                +(rlc_data_blocks_ul_cs2) *30
                + ul_rlc_blocks_ack_mcs11 *36
                + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
                /
                sum((ul_rlc_blocks_ack_mcs1
                + ul_rlc_blocks_ack_mcs2
                + ul_rlc_blocks_ack_mcs3
                + ul_rlc_blocks_ack_mcs4
                + ul_rlc_blocks_ack_mcs5
                + ul_rlc_blocks_ack_mcs6)/50
                + (ul_rlc_blocks_ack_mcs7
                + ul_rlc_blocks_ack_mcs8
                + ul_rlc_blocks_ack_mcs9 )/2/50
                +(rlc_data_blocks_ul_cs1
                - rlc_data_blocks_ul_unack
                + rlc_data_blocks_ul_cs2
                + retra_data_blocks_ul_cs1
                + retra_data_blocks_ul_cs2
                + ul_rlc_blocks_ack_mcs11
                + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

                	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
                	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

                  ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
                  ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

                  ,COUNT(*) AS `numcel`


                  ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
                  ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
                  ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
                  ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

                  ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
                  ,sum(a.tch_radio_fail) as tch_radio_fail
                  ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
                  ,sum(a.tch_tr_fail) as tch_tr_fail
                  ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
                  ,sum(a.tch_netw_act) as tch_netw_act
                  ,sum(a.tch_lapd_fail) as tch_lapd_fail
                  ,sum(a.tch_bts_fail) as tch_bts_fail
                  ,sum(a.tch_act_fail_call)as tch_act_fail_call
                  ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
                  ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
                  ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
                  ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

                  ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
                  ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
                  ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
                  ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
                  ,sum(a.sdcch_netw_act) as sdcch_netw_act
                  ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
                  ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
                  ,sum(a.t3101_expired) as t3101_expired
                  ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
                  ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
                  ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


                FROM isat_report.x_dashboard_2g a
                JOIN isat_report.local_profile_2g b
                ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
                where b.4GOverlayPack4 = 1
                GROUP BY
                	a.xDate,b.AREA
                )

                UNION

                /* ### Aggregation (Program) ### */

                (
                SELECT
                	a.xDate
                	,'SnapshotDecember2018' AS `Aggregate`
                	,b.AREA AS `Level`
                	,'All' AS `Band`

                	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

                	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

                	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

                	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

                	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

                	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
                	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
                	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
                	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

                	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
                + (dl_rlc_blocks_ack_mcs2)*28
                + (dl_rlc_blocks_ack_mcs3)*37
                + (dl_rlc_blocks_ack_mcs4)*44
                + (dl_rlc_blocks_ack_mcs5)*56
                + (dl_rlc_blocks_ack_mcs6)*74
                + (dl_rlc_blocks_ack_mcs7)*56
                + (dl_rlc_blocks_ack_mcs8)*68
                + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
                + (rlc_data_blocks_dl_cs2) *30
                + dl_rlc_blocks_ack_mcs11 *36
                + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
                sum((dl_rlc_blocks_ack_mcs1
                + dl_rlc_blocks_ack_mcs2
                + dl_rlc_blocks_ack_mcs3
                + dl_rlc_blocks_ack_mcs4
                + dl_rlc_blocks_ack_mcs5
                + dl_rlc_blocks_ack_mcs6)/50
                +(dl_rlc_blocks_ack_mcs7
                + dl_rlc_blocks_ack_mcs8
                + dl_rlc_blocks_ack_mcs9)/2/50
                +(rlc_data_blocks_dl_cs1
                - rlc_data_blocks_dl_unack
                + rlc_data_blocks_dl_cs2
                + retra_rlc_data_blocks_dl_cs1
                + retra_rlc_data_blocks_dl_cs2
                + dl_rlc_blocks_ack_mcs11
                + dl_rlc_blocks_ack_mcs12)/50
                ),2) as  `RLC_THP_DL`

                	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
                + (ul_rlc_blocks_ack_mcs2)*28
                + (ul_rlc_blocks_ack_mcs3)*37
                + (ul_rlc_blocks_ack_mcs4)*44
                + (ul_rlc_blocks_ack_mcs5)*56
                + (ul_rlc_blocks_ack_mcs6)*74
                + (ul_rlc_blocks_ack_mcs7)*56
                + (ul_rlc_blocks_ack_mcs8)*68
                + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
                + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
                +(rlc_data_blocks_ul_cs2) *30
                + ul_rlc_blocks_ack_mcs11 *36
                + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
                /
                sum((ul_rlc_blocks_ack_mcs1
                + ul_rlc_blocks_ack_mcs2
                + ul_rlc_blocks_ack_mcs3
                + ul_rlc_blocks_ack_mcs4
                + ul_rlc_blocks_ack_mcs5
                + ul_rlc_blocks_ack_mcs6)/50
                + (ul_rlc_blocks_ack_mcs7
                + ul_rlc_blocks_ack_mcs8
                + ul_rlc_blocks_ack_mcs9 )/2/50
                +(rlc_data_blocks_ul_cs1
                - rlc_data_blocks_ul_unack
                + rlc_data_blocks_ul_cs2
                + retra_data_blocks_ul_cs1
                + retra_data_blocks_ul_cs2
                + ul_rlc_blocks_ack_mcs11
                + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

                	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
                	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

                  ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
                  ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

                  ,COUNT(*) AS `numcel`


                  ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
                  ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
                  ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
                  ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

                  ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
                  ,sum(a.tch_radio_fail) as tch_radio_fail
                  ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
                  ,sum(a.tch_tr_fail) as tch_tr_fail
                  ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
                  ,sum(a.tch_netw_act) as tch_netw_act
                  ,sum(a.tch_lapd_fail) as tch_lapd_fail
                  ,sum(a.tch_bts_fail) as tch_bts_fail
                  ,sum(a.tch_act_fail_call)as tch_act_fail_call
                  ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
                  ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
                  ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
                  ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

                  ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
                  ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
                  ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
                  ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
                  ,sum(a.sdcch_netw_act) as sdcch_netw_act
                  ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
                  ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
                  ,sum(a.t3101_expired) as t3101_expired
                  ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
                  ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
                  ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


                FROM isat_report.x_dashboard_2g a
                 JOIN isat_report.local_profile_2g b
                ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
                where b.SnapshotDecember2018 = 1
                GROUP BY
                	a.xDate,b.AREA
                )"""
    elif Request == "3Gdashboard_daily" :
        sqlscript_query = """
                    (
            SELECT
              	a.xDate
            	,'All' AS `Aggregate`
            	,'Network' AS `Level`
            	,'All' AS `Band`

              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            GROUP BY
            	a.xDate
            )

            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'CatapultPO1' AS `Aggregate`
            	,'Network' AS `Level`
            	,'All' AS `Band`

              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            where b.CatapultPO1 = 1
            GROUP BY
            	a.xDate
            )


            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'CatapultPO1B' AS `Aggregate`
            	,'Network' AS `Level`
            	,'All' AS `Band`

              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            where b.CatapultPO1B = 1
            GROUP BY
            	a.xDate
            )

            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'4GOverlayPack3' AS `Aggregate`
            	,'Network' AS `Level`
            	,'All' AS `Band`

              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            where b.4GOverlayPack3 = 1
            GROUP BY
            	a.xDate
            )

            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'4GOverlayPack4' AS `Aggregate`
            	,'Network' AS `Level`
            	,'All' AS `Band`

              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            where b.4GOverlayPack4 = 1
            GROUP BY
            	a.xDate
            )

            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'SnapshotDecember2018' AS `Aggregate`
            	,'Network' AS `Level`
            	,'All' AS `Band`

              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            where b.SnapshotDecember2018 = 1
            GROUP BY
            	a.xDate
            )


            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'All' AS `Aggregate`
            	,b.REGION AS `Level`
            	,'All' AS `Band`

              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            GROUP BY
            	a.xDate, b.REGION
            )

            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'All' AS `Aggregate`
            	,b.REGION AS `Level`
            	,b.BAND AS `Band`

              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            GROUP BY
            	a.xDate, b.REGION,b.BAND
            )

            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'All' AS `Aggregate`
            	,'Network' AS `Level`
            	,b.Band AS `Band`

              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            GROUP BY
            	a.xDate,b.Band
            )


            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'CatapultPO1' AS `Aggregate`
            	,b.REGION AS `Level`
            	,b.Band AS `Band`

              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            where b.CatapultPO1 = 1
            GROUP BY
            	a.xDate,b.REGION,b.Band
            )


            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'CatapultPO1B' AS `Aggregate`
            	,b.REGION As`Level`
            	,b.Band AS `Band`

              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            where b.CatapultPO1B = 1
            GROUP BY
            	a.xDate,b.REGION,b.Band
            )

            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'4GOverlayPack3' AS `Aggregate`
            	,b.REGION As`Level`
            	,b.Band AS `Band`

              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            where b.4GOverlayPack3 = 1
            GROUP BY
            	a.xDate,b.REGION,b.Band
            )

            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'4GOverlayPack4' AS `Aggregate`
            	,b.REGION As`Level`
            	,b.Band AS `Band`


              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            where b.4GOverlayPack4 = 1
            GROUP BY
            	a.xDate,b.REGION,b.Band
            )

            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'SnapshotDecember2018' AS `Aggregate`
            	,b.REGION As`Level`
            	,b.Band AS `Band`


              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            where b.SnapshotDecember2018 = 1
            GROUP BY
            	a.xDate,b.REGION,b.Band
            )


            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'CatapultPO1' AS `Aggregate`
            	,b.REGION AS `Level`
            	,'All' AS `Band`

              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            where b.CatapultPO1 = 1
            GROUP BY
            	a.xDate,b.REGION
            )


            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'CatapultPO1B' AS `Aggregate`
            	,b.REGION As`Level`
            	,'All' AS `Band`

              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            where b.CatapultPO1B = 1
            GROUP BY
            	a.xDate,b.REGION
            )

            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'4GOverlayPack3' AS `Aggregate`
            	,b.REGION As`Level`
            	,'All' AS `Band`

              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            where b.4GOverlayPack3 = 1
            GROUP BY
            	a.xDate,b.REGION
            )

            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'4GOverlayPack4' AS `Aggregate`
            	,b.REGION As`Level`
            	,'All' AS `Band`


              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            where b.4GOverlayPack4 = 1
            GROUP BY
            	a.xDate,b.REGION
            )

            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'SnapshotDecember2018' AS `Aggregate`
            	,b.REGION As`Level`
            	,'All' AS `Band`


              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            where b.SnapshotDecember2018 = 1
            GROUP BY
            	a.xDate,b.REGION
            )"""
    elif Request == "4Gdashboard_daily" :
        sqlscript_query = """
                    (
            SELECT
            	a.xDate
            	,'All' AS `Aggregate`
            	,'Network' AS `Level`
            	,'All' AS `Band`
              ,COUNT(*) AS `NumCel`

              ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
              -- CSSR --
              ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

              -- ERAB Drop Rate --
              ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

              -- HOSR --
              ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
              ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                -- Payload --
              ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
              ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
              ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

              -- LTE END USER THROUGHPUT DL --
              ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

              -- LTE END USER THROUGHPUT UL --
              ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

              -- LTE USER --
              ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
              ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

            FROM isat_report.x_dashboard_4g a
            JOIN isat_report.local_profile_4g b
            ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
            GROUP BY
            	a.xDate
            )

            UNION

            (
            SELECT
            	a.xDate
            	,'CatapultPO1' AS `Aggregate`
            	,'Network' AS `Level`
            	,'All' AS `Band`
              ,COUNT(*) AS `NumCel`

              ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
              -- CSSR --
              ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

              -- ERAB Drop Rate --
              ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

              -- HOSR --
              ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
              ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                -- Payload --
              ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
              ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
              ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

              -- LTE END USER THROUGHPUT DL --
              ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

              -- LTE END USER THROUGHPUT UL --
              ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

              -- LTE USER --
              ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
              ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

            FROM isat_report.x_dashboard_4g a
            JOIN isat_report.local_profile_4g b
            ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
            where b.CatapultPO1 = 1
            GROUP BY
            	a.xDate
            )

            UNION

            (
            SELECT
            	a.xDate
            	,'CatapultPO1B' AS `Aggregate`
            	,'Network' AS `Level`
            	,'All' AS `Band`
              ,COUNT(*) AS `NumCel`

              ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
              -- CSSR --
              ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

              -- ERAB Drop Rate --
              ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

              -- HOSR --
              ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
              ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                -- Payload --
              ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
              ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
              ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

              -- LTE END USER THROUGHPUT DL --
              ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

              -- LTE END USER THROUGHPUT UL --
              ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

              -- LTE USER --
              ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
              ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

            FROM isat_report.x_dashboard_4g a
            JOIN isat_report.local_profile_4g b
            ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
            where b.CatapultPO1B = 1
            GROUP BY
            	a.xDate
            )

            UNION

            (
            SELECT
            	a.xDate
            	,'4GOverlayPack3' AS `Aggregate`
            	,'Network' AS `Level`
            	,'All' AS `Band`
              ,COUNT(*) AS `NumCel`

              ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
              -- CSSR --
              ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

              -- ERAB Drop Rate --
              ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

              -- HOSR --
              ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
              ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                -- Payload --
              ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
              ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
              ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

              -- LTE END USER THROUGHPUT DL --
              ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

              -- LTE END USER THROUGHPUT UL --
              ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

              -- LTE USER --
              ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
              ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

            FROM isat_report.x_dashboard_4g a
            JOIN isat_report.local_profile_4g b
            ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
            where b.4GOverlayPack3 = 1
            GROUP BY
            	a.xDate
            )

            UNION

            (
            SELECT
            	a.xDate
            	,'4GOverlayPack4' AS `Aggregate`
            	,'Network' AS `Level`
            	,'All' AS `Band`
              ,COUNT(*) AS `NumCel`

              ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
              -- CSSR --
              ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

              -- ERAB Drop Rate --
              ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

              -- HOSR --
              ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
              ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                -- Payload --
              ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
              ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
              ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

              -- LTE END USER THROUGHPUT DL --
              ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

              -- LTE END USER THROUGHPUT UL --
              ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

              -- LTE USER --
              ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
              ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

            FROM isat_report.x_dashboard_4g a
            JOIN isat_report.local_profile_4g b
            ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
            where b.4GOverlayPack4 = 1
            GROUP BY
            	a.xDate
            )

            UNION

            (
            SELECT
            	a.xDate
            	,'SnapshotDecember2018' AS `Aggregate`
            	,'Network' AS `Level`
            	,'All' AS `Band`
              ,COUNT(*) AS `NumCel`

              ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
              -- CSSR --
              ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

              -- ERAB Drop Rate --
              ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

              -- HOSR --
              ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
              ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                -- Payload --
              ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
              ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
              ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

              -- LTE END USER THROUGHPUT DL --
              ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

              -- LTE END USER THROUGHPUT UL --
              ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

              -- LTE USER --
              ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
              ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

            FROM isat_report.x_dashboard_4g a
            JOIN isat_report.local_profile_4g b
            ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
            where b.SnapshotDecember2018 = 1
            GROUP BY
            	a.xDate
            )

            UNION

            (
            SELECT
            	a.xDate
            	,'CatapultPO1' AS `Aggregate`
            	,b.REGION AS `Level`
            	,b.BAND AS `Band`
              ,COUNT(*) AS `NumCel`

              ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
              -- CSSR --
              ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

              -- ERAB Drop Rate --
              ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

              -- HOSR --
              ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
              ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                -- Payload --
              ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
              ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
              ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

              -- LTE END USER THROUGHPUT DL --
              ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

              -- LTE END USER THROUGHPUT UL --
              ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

              -- LTE USER --
              ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
              ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

            FROM isat_report.x_dashboard_4g a
            JOIN isat_report.local_profile_4g b
            ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
            where b.CatapultPO1 = 1
            GROUP BY
            	a.xDate,b.REGION,b.BAND
            )

            UNION

            (
            SELECT
            	a.xDate
            	,'CatapultPO1B' AS `Aggregate`
            	,b.REGION AS `Level`
            	,b.BAND AS `Band`
              ,COUNT(*) AS `NumCel`

              ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
              -- CSSR --
              ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

              -- ERAB Drop Rate --
              ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

              -- HOSR --
              ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
              ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                -- Payload --
              ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
              ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
              ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

              -- LTE END USER THROUGHPUT DL --
              ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

              -- LTE END USER THROUGHPUT UL --
              ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

              -- LTE USER --
              ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
              ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

            FROM isat_report.x_dashboard_4g a
            JOIN isat_report.local_profile_4g b
            ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
            where b.CatapultPO1B = 1
            GROUP BY
            	a.xDate,b.REGION,b.BAND
            )

            UNION

            (
            SELECT
            	a.xDate
            	,'4GOverlayPack3' AS `Aggregate`
            	,b.REGION AS `Level`
            	,b.BAND AS `Band`
              ,COUNT(*) AS `NumCel`

              ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
              -- CSSR --
              ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

              -- ERAB Drop Rate --
              ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

              -- HOSR --
              ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
              ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                -- Payload --
              ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
              ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
              ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

              -- LTE END USER THROUGHPUT DL --
              ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

              -- LTE END USER THROUGHPUT UL --
              ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

              -- LTE USER --
              ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
              ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

            FROM isat_report.x_dashboard_4g a
            JOIN isat_report.local_profile_4g b
            ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
            where b.4GOverlayPack3 = 1
            GROUP BY
            	a.xDate,b.REGION,b.BAND
            )

            UNION

            (
            SELECT
            	a.xDate
            	,'4GOverlayPack4' AS `Aggregate`
            	,b.REGION AS `Level`
            	,b.BAND AS `Band`
              ,COUNT(*) AS `NumCel`

              ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
              -- CSSR --
              ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

              -- ERAB Drop Rate --
              ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

              -- HOSR --
              ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
              ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                -- Payload --
              ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
              ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
              ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

              -- LTE END USER THROUGHPUT DL --
              ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

              -- LTE END USER THROUGHPUT UL --
              ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

              -- LTE USER --
              ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
              ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

            FROM isat_report.x_dashboard_4g a
            JOIN isat_report.local_profile_4g b
            ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
            where b.4GOverlayPack4 = 1
            GROUP BY
            	a.xDate,b.REGION,b.BAND
            )

            UNION

            (
            SELECT
            	a.xDate
            	,'SnapshotDecember2018' AS `Aggregate`
            	,b.REGION AS `Level`
            	,b.BAND AS `Band`
              ,COUNT(*) AS `NumCel`

              ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
              -- CSSR --
              ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

              -- ERAB Drop Rate --
              ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

              -- HOSR --
              ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
              ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                -- Payload --
              ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
              ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
              ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

              -- LTE END USER THROUGHPUT DL --
              ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

              -- LTE END USER THROUGHPUT UL --
              ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

              -- LTE USER --
              ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
              ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

            FROM isat_report.x_dashboard_4g a
            JOIN isat_report.local_profile_4g b
            ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
            where b.SnapshotDecember2018 = 1
            GROUP BY
            	a.xDate,b.REGION,b.BAND
            )


            UNION

            (
            SELECT
            	a.xDate
            	,'CatapultPO1' AS `Aggregate`
            	,b.REGION AS `Level`
            	,'All' AS `Band`
              ,COUNT(*) AS `NumCel`

              ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
              -- CSSR --
              ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

              -- ERAB Drop Rate --
              ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

              -- HOSR --
              ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
              ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                -- Payload --
              ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
              ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
              ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

              -- LTE END USER THROUGHPUT DL --
              ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

              -- LTE END USER THROUGHPUT UL --
              ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

              -- LTE USER --
              ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
              ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

            FROM isat_report.x_dashboard_4g a
            JOIN isat_report.local_profile_4g b
            ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
            where b.CatapultPO1 = 1
            GROUP BY
            	a.xDate,b.REGION
            )

            UNION

            (
            SELECT
            	a.xDate
            	,'CatapultPO1B' AS `Aggregate`
            	,b.REGION AS `Level`
            	,'All' AS `Band`
              ,COUNT(*) AS `NumCel`

              ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
              -- CSSR --
              ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

              -- ERAB Drop Rate --
              ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

              -- HOSR --
              ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
              ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                -- Payload --
              ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
              ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
              ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

              -- LTE END USER THROUGHPUT DL --
              ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

              -- LTE END USER THROUGHPUT UL --
              ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

              -- LTE USER --
              ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
              ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

            FROM isat_report.x_dashboard_4g a
            JOIN isat_report.local_profile_4g b
            ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
            where b.CatapultPO1B = 1
            GROUP BY
            	a.xDate,b.REGION
            )

            UNION

            (
            SELECT
            	a.xDate
            	,'4GOverlayPack3' AS `Aggregate`
            	,b.REGION AS `Level`
            	,'All' AS `Band`
              ,COUNT(*) AS `NumCel`

              ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
              -- CSSR --
              ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

              -- ERAB Drop Rate --
              ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

              -- HOSR --
              ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
              ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                -- Payload --
              ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
              ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
              ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

              -- LTE END USER THROUGHPUT DL --
              ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

              -- LTE END USER THROUGHPUT UL --
              ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

              -- LTE USER --
              ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
              ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

            FROM isat_report.x_dashboard_4g a
            JOIN isat_report.local_profile_4g b
            ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
            where b.4GOverlayPack3 = 1
            GROUP BY
            	a.xDate,b.REGION
            )

            UNION

            (
            SELECT
            	a.xDate
            	,'4GOverlayPack4' AS `Aggregate`
            	,b.REGION AS `Level`
            	,'All' AS `Band`
              ,COUNT(*) AS `NumCel`

              ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
              -- CSSR --
              ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

              -- ERAB Drop Rate --
              ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

              -- HOSR --
              ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
              ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                -- Payload --
              ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
              ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
              ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

              -- LTE END USER THROUGHPUT DL --
              ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

              -- LTE END USER THROUGHPUT UL --
              ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

              -- LTE USER --
              ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
              ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

            FROM isat_report.x_dashboard_4g a
            JOIN isat_report.local_profile_4g b
            ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
            where b.4GOverlayPack4 = 1
            GROUP BY
            	a.xDate,b.REGION
            )

            UNION

            (
            SELECT
            	a.xDate
            	,'SnapshotDecember2018' AS `Aggregate`
            	,b.REGION AS `Level`
            	,'All' AS `Band`
              ,COUNT(*) AS `NumCel`

              ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
              -- CSSR --
              ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

              -- ERAB Drop Rate --
              ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

              -- HOSR --
              ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
              ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                -- Payload --
              ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
              ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
              ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

              -- LTE END USER THROUGHPUT DL --
              ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

              -- LTE END USER THROUGHPUT UL --
              ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

              -- LTE USER --
              ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
              ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

            FROM isat_report.x_dashboard_4g a
            JOIN isat_report.local_profile_4g b
            ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
            where b.SnapshotDecember2018 = 1
            GROUP BY
            	a.xDate,b.REGION
            )



            UNION

            (
            SELECT
            	a.xDate
            	,'All' AS `Aggregate`
            	,b.REGION AS `Level`
            	,'All' AS `Band`
              ,COUNT(*) AS `NumCel`

              ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
              -- CSSR --
              ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

              -- ERAB Drop Rate --
              ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

              -- HOSR --
              ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
              ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                -- Payload --
              ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
              ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
              ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

              -- LTE END USER THROUGHPUT DL --
              ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

              -- LTE END USER THROUGHPUT UL --
              ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

              -- LTE USER --
              ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
              ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

            FROM isat_report.x_dashboard_4g a
            JOIN isat_report.local_profile_4g b
            ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
            GROUP BY
            	a.xDate,b.REGION
            )

            UNION

            (
            SELECT
            	a.xDate
            	,'All' AS `Aggregate`
            	,b.REGION AS `Level`
            	,b.BAND AS `Band`
              ,COUNT(*) AS `NumCel`

              ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
              -- CSSR --
              ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

              -- ERAB Drop Rate --
              ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

              -- HOSR --
              ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
              ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                -- Payload --
              ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
              ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
              ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

              -- LTE END USER THROUGHPUT DL --
              ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

              -- LTE END USER THROUGHPUT UL --
              ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

              -- LTE USER --
              ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
              ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

            FROM isat_report.x_dashboard_4g a
            JOIN isat_report.local_profile_4g b
            ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
            GROUP BY
            	a.xDate,b.REGION,b.BAND
            )

            UNION

            (
            SELECT
            	a.xDate
            	,'All' AS `Aggregate`
            	,'Network' AS `Level`
            	,b.BAND AS `Band`
              ,COUNT(*) AS `NumCel`

              ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
              -- CSSR --
              ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

              -- ERAB Drop Rate --
              ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

              -- HOSR --
              ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
              ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                -- Payload --
              ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
              ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
              ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

              -- LTE END USER THROUGHPUT DL --
              ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

              -- LTE END USER THROUGHPUT UL --
              ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

              -- LTE USER --
              ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
              ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

            FROM isat_report.x_dashboard_4g a
            JOIN isat_report.local_profile_4g b
            ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
            GROUP BY
            	a.xDate,b.BAND
            )"""
    elif Request == "2Gdashboard_bh" :
        sqlscript_query = """(
            SELECT
            	a.xDate
            	,'All' AS `Aggregate`
            	,'Network' AS `Level`
            	,'All' AS `Band`

            	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

            	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

            	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

            	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

            	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

            	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
            	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
            	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

            	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
            + (dl_rlc_blocks_ack_mcs2)*28
            + (dl_rlc_blocks_ack_mcs3)*37
            + (dl_rlc_blocks_ack_mcs4)*44
            + (dl_rlc_blocks_ack_mcs5)*56
            + (dl_rlc_blocks_ack_mcs6)*74
            + (dl_rlc_blocks_ack_mcs7)*56
            + (dl_rlc_blocks_ack_mcs8)*68
            + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
            + (rlc_data_blocks_dl_cs2) *30
            + dl_rlc_blocks_ack_mcs11 *36
            + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
            sum((dl_rlc_blocks_ack_mcs1
            + dl_rlc_blocks_ack_mcs2
            + dl_rlc_blocks_ack_mcs3
            + dl_rlc_blocks_ack_mcs4
            + dl_rlc_blocks_ack_mcs5
            + dl_rlc_blocks_ack_mcs6)/50
            +(dl_rlc_blocks_ack_mcs7
            + dl_rlc_blocks_ack_mcs8
            + dl_rlc_blocks_ack_mcs9)/2/50
            +(rlc_data_blocks_dl_cs1
            - rlc_data_blocks_dl_unack
            + rlc_data_blocks_dl_cs2
            + retra_rlc_data_blocks_dl_cs1
            + retra_rlc_data_blocks_dl_cs2
            + dl_rlc_blocks_ack_mcs11
            + dl_rlc_blocks_ack_mcs12)/50
            ),2) as  `RLC_THP_DL`

            	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
            + (ul_rlc_blocks_ack_mcs2)*28
            + (ul_rlc_blocks_ack_mcs3)*37
            + (ul_rlc_blocks_ack_mcs4)*44
            + (ul_rlc_blocks_ack_mcs5)*56
            + (ul_rlc_blocks_ack_mcs6)*74
            + (ul_rlc_blocks_ack_mcs7)*56
            + (ul_rlc_blocks_ack_mcs8)*68
            + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
            +(rlc_data_blocks_ul_cs2) *30
            + ul_rlc_blocks_ack_mcs11 *36
            + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
            /
            sum((ul_rlc_blocks_ack_mcs1
            + ul_rlc_blocks_ack_mcs2
            + ul_rlc_blocks_ack_mcs3
            + ul_rlc_blocks_ack_mcs4
            + ul_rlc_blocks_ack_mcs5
            + ul_rlc_blocks_ack_mcs6)/50
            + (ul_rlc_blocks_ack_mcs7
            + ul_rlc_blocks_ack_mcs8
            + ul_rlc_blocks_ack_mcs9 )/2/50
            +(rlc_data_blocks_ul_cs1
            - rlc_data_blocks_ul_unack
            + rlc_data_blocks_ul_cs2
            + retra_data_blocks_ul_cs1
            + retra_data_blocks_ul_cs2
            + ul_rlc_blocks_ack_mcs11
            + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

            	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
            	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

              ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
              ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

              ,COUNT(*) AS `numcel`


              ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
              ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
              ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
              ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

              ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
              ,sum(a.tch_radio_fail) as tch_radio_fail
              ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
              ,sum(a.tch_tr_fail) as tch_tr_fail
              ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
              ,sum(a.tch_netw_act) as tch_netw_act
              ,sum(a.tch_lapd_fail) as tch_lapd_fail
              ,sum(a.tch_bts_fail) as tch_bts_fail
              ,sum(a.tch_act_fail_call)as tch_act_fail_call
              ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
              ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
              ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
              ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

              ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
              ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
              ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
              ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
              ,sum(a.sdcch_netw_act) as sdcch_netw_act
              ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
              ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
              ,sum(a.t3101_expired) as t3101_expired
              ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
              ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
              ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


            FROM isat_report.x_dashboard_2g_bh a
            LEFT JOIN isat_report.local_profile_2g b
            ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
            GROUP BY
            	a.xDate
            )

            UNION

            /* ### Aggregation (Program) ### */

            (
            SELECT
            	a.xDate
            	,'CatapultPO1' AS `Aggregate`
            	,'Network' AS `Level`
            	,'All' AS `Band`

            	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

            	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

            	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

            	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

            	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

            	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
            	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
            	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

            	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
            + (dl_rlc_blocks_ack_mcs2)*28
            + (dl_rlc_blocks_ack_mcs3)*37
            + (dl_rlc_blocks_ack_mcs4)*44
            + (dl_rlc_blocks_ack_mcs5)*56
            + (dl_rlc_blocks_ack_mcs6)*74
            + (dl_rlc_blocks_ack_mcs7)*56
            + (dl_rlc_blocks_ack_mcs8)*68
            + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
            + (rlc_data_blocks_dl_cs2) *30
            + dl_rlc_blocks_ack_mcs11 *36
            + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
            sum((dl_rlc_blocks_ack_mcs1
            + dl_rlc_blocks_ack_mcs2
            + dl_rlc_blocks_ack_mcs3
            + dl_rlc_blocks_ack_mcs4
            + dl_rlc_blocks_ack_mcs5
            + dl_rlc_blocks_ack_mcs6)/50
            +(dl_rlc_blocks_ack_mcs7
            + dl_rlc_blocks_ack_mcs8
            + dl_rlc_blocks_ack_mcs9)/2/50
            +(rlc_data_blocks_dl_cs1
            - rlc_data_blocks_dl_unack
            + rlc_data_blocks_dl_cs2
            + retra_rlc_data_blocks_dl_cs1
            + retra_rlc_data_blocks_dl_cs2
            + dl_rlc_blocks_ack_mcs11
            + dl_rlc_blocks_ack_mcs12)/50
            ),2) as  `RLC_THP_DL`

            	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
            + (ul_rlc_blocks_ack_mcs2)*28
            + (ul_rlc_blocks_ack_mcs3)*37
            + (ul_rlc_blocks_ack_mcs4)*44
            + (ul_rlc_blocks_ack_mcs5)*56
            + (ul_rlc_blocks_ack_mcs6)*74
            + (ul_rlc_blocks_ack_mcs7)*56
            + (ul_rlc_blocks_ack_mcs8)*68
            + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
            +(rlc_data_blocks_ul_cs2) *30
            + ul_rlc_blocks_ack_mcs11 *36
            + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
            /
            sum((ul_rlc_blocks_ack_mcs1
            + ul_rlc_blocks_ack_mcs2
            + ul_rlc_blocks_ack_mcs3
            + ul_rlc_blocks_ack_mcs4
            + ul_rlc_blocks_ack_mcs5
            + ul_rlc_blocks_ack_mcs6)/50
            + (ul_rlc_blocks_ack_mcs7
            + ul_rlc_blocks_ack_mcs8
            + ul_rlc_blocks_ack_mcs9 )/2/50
            +(rlc_data_blocks_ul_cs1
            - rlc_data_blocks_ul_unack
            + rlc_data_blocks_ul_cs2
            + retra_data_blocks_ul_cs1
            + retra_data_blocks_ul_cs2
            + ul_rlc_blocks_ack_mcs11
            + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

            	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
            	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

              ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
              ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

              ,COUNT(*) AS `numcel`


              ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
              ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
              ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
              ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

              ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
              ,sum(a.tch_radio_fail) as tch_radio_fail
              ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
              ,sum(a.tch_tr_fail) as tch_tr_fail
              ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
              ,sum(a.tch_netw_act) as tch_netw_act
              ,sum(a.tch_lapd_fail) as tch_lapd_fail
              ,sum(a.tch_bts_fail) as tch_bts_fail
              ,sum(a.tch_act_fail_call)as tch_act_fail_call
              ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
              ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
              ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
              ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

              ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
              ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
              ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
              ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
              ,sum(a.sdcch_netw_act) as sdcch_netw_act
              ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
              ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
              ,sum(a.t3101_expired) as t3101_expired
              ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
              ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
              ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


            FROM isat_report.x_dashboard_2g_bh a
            JOIN isat_report.local_profile_2g b
            ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
            where b.CatapultPO1 = 1
            GROUP BY
            	a.xDate
            )


            UNION

            /* ### Aggregation (Program) ### */

            (
            SELECT
            	a.xDate
            	,'CatapultPO1B' AS `Aggregate`
            	,'Network' AS `Level`
            	,'All' AS `Band`

            	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

            	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

            	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

            	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

            	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

            	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
            	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
            	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

            	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
            + (dl_rlc_blocks_ack_mcs2)*28
            + (dl_rlc_blocks_ack_mcs3)*37
            + (dl_rlc_blocks_ack_mcs4)*44
            + (dl_rlc_blocks_ack_mcs5)*56
            + (dl_rlc_blocks_ack_mcs6)*74
            + (dl_rlc_blocks_ack_mcs7)*56
            + (dl_rlc_blocks_ack_mcs8)*68
            + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
            + (rlc_data_blocks_dl_cs2) *30
            + dl_rlc_blocks_ack_mcs11 *36
            + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
            sum((dl_rlc_blocks_ack_mcs1
            + dl_rlc_blocks_ack_mcs2
            + dl_rlc_blocks_ack_mcs3
            + dl_rlc_blocks_ack_mcs4
            + dl_rlc_blocks_ack_mcs5
            + dl_rlc_blocks_ack_mcs6)/50
            +(dl_rlc_blocks_ack_mcs7
            + dl_rlc_blocks_ack_mcs8
            + dl_rlc_blocks_ack_mcs9)/2/50
            +(rlc_data_blocks_dl_cs1
            - rlc_data_blocks_dl_unack
            + rlc_data_blocks_dl_cs2
            + retra_rlc_data_blocks_dl_cs1
            + retra_rlc_data_blocks_dl_cs2
            + dl_rlc_blocks_ack_mcs11
            + dl_rlc_blocks_ack_mcs12)/50
            ),2) as  `RLC_THP_DL`

            	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
            + (ul_rlc_blocks_ack_mcs2)*28
            + (ul_rlc_blocks_ack_mcs3)*37
            + (ul_rlc_blocks_ack_mcs4)*44
            + (ul_rlc_blocks_ack_mcs5)*56
            + (ul_rlc_blocks_ack_mcs6)*74
            + (ul_rlc_blocks_ack_mcs7)*56
            + (ul_rlc_blocks_ack_mcs8)*68
            + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
            +(rlc_data_blocks_ul_cs2) *30
            + ul_rlc_blocks_ack_mcs11 *36
            + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
            /
            sum((ul_rlc_blocks_ack_mcs1
            + ul_rlc_blocks_ack_mcs2
            + ul_rlc_blocks_ack_mcs3
            + ul_rlc_blocks_ack_mcs4
            + ul_rlc_blocks_ack_mcs5
            + ul_rlc_blocks_ack_mcs6)/50
            + (ul_rlc_blocks_ack_mcs7
            + ul_rlc_blocks_ack_mcs8
            + ul_rlc_blocks_ack_mcs9 )/2/50
            +(rlc_data_blocks_ul_cs1
            - rlc_data_blocks_ul_unack
            + rlc_data_blocks_ul_cs2
            + retra_data_blocks_ul_cs1
            + retra_data_blocks_ul_cs2
            + ul_rlc_blocks_ack_mcs11
            + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

            	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
            	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

              ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
              ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

              ,COUNT(*) AS `numcel`


              ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
              ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
              ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
              ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

              ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
              ,sum(a.tch_radio_fail) as tch_radio_fail
              ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
              ,sum(a.tch_tr_fail) as tch_tr_fail
              ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
              ,sum(a.tch_netw_act) as tch_netw_act
              ,sum(a.tch_lapd_fail) as tch_lapd_fail
              ,sum(a.tch_bts_fail) as tch_bts_fail
              ,sum(a.tch_act_fail_call)as tch_act_fail_call
              ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
              ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
              ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
              ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

              ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
              ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
              ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
              ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
              ,sum(a.sdcch_netw_act) as sdcch_netw_act
              ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
              ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
              ,sum(a.t3101_expired) as t3101_expired
              ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
              ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
              ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


            FROM isat_report.x_dashboard_2g_bh a
            JOIN isat_report.local_profile_2g b
            ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
            where b.CatapultPO1B = 1
            GROUP BY
            	a.xDate
            )

            UNION

            /* ### Aggregation (Program) ### */

            (
            SELECT
            	a.xDate
            	,'4GOverlayPack3' AS `Aggregate`
            	,'Network' AS `Level`
            	,'All' AS `Band`

            	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

            	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

            	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

            	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

            	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

            	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
            	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
            	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

            	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
            + (dl_rlc_blocks_ack_mcs2)*28
            + (dl_rlc_blocks_ack_mcs3)*37
            + (dl_rlc_blocks_ack_mcs4)*44
            + (dl_rlc_blocks_ack_mcs5)*56
            + (dl_rlc_blocks_ack_mcs6)*74
            + (dl_rlc_blocks_ack_mcs7)*56
            + (dl_rlc_blocks_ack_mcs8)*68
            + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
            + (rlc_data_blocks_dl_cs2) *30
            + dl_rlc_blocks_ack_mcs11 *36
            + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
            sum((dl_rlc_blocks_ack_mcs1
            + dl_rlc_blocks_ack_mcs2
            + dl_rlc_blocks_ack_mcs3
            + dl_rlc_blocks_ack_mcs4
            + dl_rlc_blocks_ack_mcs5
            + dl_rlc_blocks_ack_mcs6)/50
            +(dl_rlc_blocks_ack_mcs7
            + dl_rlc_blocks_ack_mcs8
            + dl_rlc_blocks_ack_mcs9)/2/50
            +(rlc_data_blocks_dl_cs1
            - rlc_data_blocks_dl_unack
            + rlc_data_blocks_dl_cs2
            + retra_rlc_data_blocks_dl_cs1
            + retra_rlc_data_blocks_dl_cs2
            + dl_rlc_blocks_ack_mcs11
            + dl_rlc_blocks_ack_mcs12)/50
            ),2) as  `RLC_THP_DL`

            	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
            + (ul_rlc_blocks_ack_mcs2)*28
            + (ul_rlc_blocks_ack_mcs3)*37
            + (ul_rlc_blocks_ack_mcs4)*44
            + (ul_rlc_blocks_ack_mcs5)*56
            + (ul_rlc_blocks_ack_mcs6)*74
            + (ul_rlc_blocks_ack_mcs7)*56
            + (ul_rlc_blocks_ack_mcs8)*68
            + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
            +(rlc_data_blocks_ul_cs2) *30
            + ul_rlc_blocks_ack_mcs11 *36
            + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
            /
            sum((ul_rlc_blocks_ack_mcs1
            + ul_rlc_blocks_ack_mcs2
            + ul_rlc_blocks_ack_mcs3
            + ul_rlc_blocks_ack_mcs4
            + ul_rlc_blocks_ack_mcs5
            + ul_rlc_blocks_ack_mcs6)/50
            + (ul_rlc_blocks_ack_mcs7
            + ul_rlc_blocks_ack_mcs8
            + ul_rlc_blocks_ack_mcs9 )/2/50
            +(rlc_data_blocks_ul_cs1
            - rlc_data_blocks_ul_unack
            + rlc_data_blocks_ul_cs2
            + retra_data_blocks_ul_cs1
            + retra_data_blocks_ul_cs2
            + ul_rlc_blocks_ack_mcs11
            + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

            	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
            	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

              ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
              ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

              ,COUNT(*) AS `numcel`


              ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
              ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
              ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
              ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

              ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
              ,sum(a.tch_radio_fail) as tch_radio_fail
              ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
              ,sum(a.tch_tr_fail) as tch_tr_fail
              ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
              ,sum(a.tch_netw_act) as tch_netw_act
              ,sum(a.tch_lapd_fail) as tch_lapd_fail
              ,sum(a.tch_bts_fail) as tch_bts_fail
              ,sum(a.tch_act_fail_call)as tch_act_fail_call
              ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
              ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
              ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
              ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

              ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
              ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
              ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
              ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
              ,sum(a.sdcch_netw_act) as sdcch_netw_act
              ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
              ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
              ,sum(a.t3101_expired) as t3101_expired
              ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
              ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
              ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


            FROM isat_report.x_dashboard_2g_bh a
            JOIN isat_report.local_profile_2g b
            ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
            where b.4GOverlayPack3 = 1
            GROUP BY
            	a.xDate
            )

            UNION

            /* ### Aggregation (Program) ### */

            (
            SELECT
            	a.xDate
            	,'4GOverlayPack4' AS `Aggregate`
            	,'Network' AS `Level`
            	,'All' AS `Band`

            	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

            	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

            	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

            	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

            	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

            	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
            	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
            	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

            	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
            + (dl_rlc_blocks_ack_mcs2)*28
            + (dl_rlc_blocks_ack_mcs3)*37
            + (dl_rlc_blocks_ack_mcs4)*44
            + (dl_rlc_blocks_ack_mcs5)*56
            + (dl_rlc_blocks_ack_mcs6)*74
            + (dl_rlc_blocks_ack_mcs7)*56
            + (dl_rlc_blocks_ack_mcs8)*68
            + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
            + (rlc_data_blocks_dl_cs2) *30
            + dl_rlc_blocks_ack_mcs11 *36
            + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
            sum((dl_rlc_blocks_ack_mcs1
            + dl_rlc_blocks_ack_mcs2
            + dl_rlc_blocks_ack_mcs3
            + dl_rlc_blocks_ack_mcs4
            + dl_rlc_blocks_ack_mcs5
            + dl_rlc_blocks_ack_mcs6)/50
            +(dl_rlc_blocks_ack_mcs7
            + dl_rlc_blocks_ack_mcs8
            + dl_rlc_blocks_ack_mcs9)/2/50
            +(rlc_data_blocks_dl_cs1
            - rlc_data_blocks_dl_unack
            + rlc_data_blocks_dl_cs2
            + retra_rlc_data_blocks_dl_cs1
            + retra_rlc_data_blocks_dl_cs2
            + dl_rlc_blocks_ack_mcs11
            + dl_rlc_blocks_ack_mcs12)/50
            ),2) as  `RLC_THP_DL`

            	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
            + (ul_rlc_blocks_ack_mcs2)*28
            + (ul_rlc_blocks_ack_mcs3)*37
            + (ul_rlc_blocks_ack_mcs4)*44
            + (ul_rlc_blocks_ack_mcs5)*56
            + (ul_rlc_blocks_ack_mcs6)*74
            + (ul_rlc_blocks_ack_mcs7)*56
            + (ul_rlc_blocks_ack_mcs8)*68
            + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
            +(rlc_data_blocks_ul_cs2) *30
            + ul_rlc_blocks_ack_mcs11 *36
            + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
            /
            sum((ul_rlc_blocks_ack_mcs1
            + ul_rlc_blocks_ack_mcs2
            + ul_rlc_blocks_ack_mcs3
            + ul_rlc_blocks_ack_mcs4
            + ul_rlc_blocks_ack_mcs5
            + ul_rlc_blocks_ack_mcs6)/50
            + (ul_rlc_blocks_ack_mcs7
            + ul_rlc_blocks_ack_mcs8
            + ul_rlc_blocks_ack_mcs9 )/2/50
            +(rlc_data_blocks_ul_cs1
            - rlc_data_blocks_ul_unack
            + rlc_data_blocks_ul_cs2
            + retra_data_blocks_ul_cs1
            + retra_data_blocks_ul_cs2
            + ul_rlc_blocks_ack_mcs11
            + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

            	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
            	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

              ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
              ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

              ,COUNT(*) AS `numcel`


              ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
              ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
              ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
              ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

              ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
              ,sum(a.tch_radio_fail) as tch_radio_fail
              ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
              ,sum(a.tch_tr_fail) as tch_tr_fail
              ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
              ,sum(a.tch_netw_act) as tch_netw_act
              ,sum(a.tch_lapd_fail) as tch_lapd_fail
              ,sum(a.tch_bts_fail) as tch_bts_fail
              ,sum(a.tch_act_fail_call)as tch_act_fail_call
              ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
              ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
              ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
              ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

              ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
              ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
              ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
              ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
              ,sum(a.sdcch_netw_act) as sdcch_netw_act
              ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
              ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
              ,sum(a.t3101_expired) as t3101_expired
              ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
              ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
              ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


            FROM isat_report.x_dashboard_2g_bh a
            JOIN isat_report.local_profile_2g b
            ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
            where b.4GOverlayPack4 = 1
            GROUP BY
            	a.xDate
            )

            UNION

            /* ### Aggregation (Program) ### */

            (
            SELECT
            	a.xDate
            	,'SnapshotDecember2018' AS `Aggregate`
            	,'Network' AS `Level`
            	,'All' AS `Band`

            	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

            	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

            	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

            	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

            	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

            	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
            	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
            	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

            	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
            + (dl_rlc_blocks_ack_mcs2)*28
            + (dl_rlc_blocks_ack_mcs3)*37
            + (dl_rlc_blocks_ack_mcs4)*44
            + (dl_rlc_blocks_ack_mcs5)*56
            + (dl_rlc_blocks_ack_mcs6)*74
            + (dl_rlc_blocks_ack_mcs7)*56
            + (dl_rlc_blocks_ack_mcs8)*68
            + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
            + (rlc_data_blocks_dl_cs2) *30
            + dl_rlc_blocks_ack_mcs11 *36
            + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
            sum((dl_rlc_blocks_ack_mcs1
            + dl_rlc_blocks_ack_mcs2
            + dl_rlc_blocks_ack_mcs3
            + dl_rlc_blocks_ack_mcs4
            + dl_rlc_blocks_ack_mcs5
            + dl_rlc_blocks_ack_mcs6)/50
            +(dl_rlc_blocks_ack_mcs7
            + dl_rlc_blocks_ack_mcs8
            + dl_rlc_blocks_ack_mcs9)/2/50
            +(rlc_data_blocks_dl_cs1
            - rlc_data_blocks_dl_unack
            + rlc_data_blocks_dl_cs2
            + retra_rlc_data_blocks_dl_cs1
            + retra_rlc_data_blocks_dl_cs2
            + dl_rlc_blocks_ack_mcs11
            + dl_rlc_blocks_ack_mcs12)/50
            ),2) as  `RLC_THP_DL`

            	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
            + (ul_rlc_blocks_ack_mcs2)*28
            + (ul_rlc_blocks_ack_mcs3)*37
            + (ul_rlc_blocks_ack_mcs4)*44
            + (ul_rlc_blocks_ack_mcs5)*56
            + (ul_rlc_blocks_ack_mcs6)*74
            + (ul_rlc_blocks_ack_mcs7)*56
            + (ul_rlc_blocks_ack_mcs8)*68
            + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
            +(rlc_data_blocks_ul_cs2) *30
            + ul_rlc_blocks_ack_mcs11 *36
            + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
            /
            sum((ul_rlc_blocks_ack_mcs1
            + ul_rlc_blocks_ack_mcs2
            + ul_rlc_blocks_ack_mcs3
            + ul_rlc_blocks_ack_mcs4
            + ul_rlc_blocks_ack_mcs5
            + ul_rlc_blocks_ack_mcs6)/50
            + (ul_rlc_blocks_ack_mcs7
            + ul_rlc_blocks_ack_mcs8
            + ul_rlc_blocks_ack_mcs9 )/2/50
            +(rlc_data_blocks_ul_cs1
            - rlc_data_blocks_ul_unack
            + rlc_data_blocks_ul_cs2
            + retra_data_blocks_ul_cs1
            + retra_data_blocks_ul_cs2
            + ul_rlc_blocks_ack_mcs11
            + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

            	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
            	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

              ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
              ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

              ,COUNT(*) AS `numcel`


              ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
              ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
              ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
              ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

              ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
              ,sum(a.tch_radio_fail) as tch_radio_fail
              ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
              ,sum(a.tch_tr_fail) as tch_tr_fail
              ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
              ,sum(a.tch_netw_act) as tch_netw_act
              ,sum(a.tch_lapd_fail) as tch_lapd_fail
              ,sum(a.tch_bts_fail) as tch_bts_fail
              ,sum(a.tch_act_fail_call)as tch_act_fail_call
              ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
              ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
              ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
              ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

              ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
              ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
              ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
              ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
              ,sum(a.sdcch_netw_act) as sdcch_netw_act
              ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
              ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
              ,sum(a.t3101_expired) as t3101_expired
              ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
              ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
              ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


            FROM isat_report.x_dashboard_2g_bh a
             JOIN isat_report.local_profile_2g b
            ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
            where b.SnapshotDecember2018 = 1
            GROUP BY
            	a.xDate
            )


            UNION

            /* ### Aggregation (Program), Level, Band ### */

            (
            SELECT
            	a.xDate
            	,'All' AS `Aggregate`
            	,b.AREA AS `Level`
            	,'All' AS `Band`

            	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

            	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

            	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

            	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

            	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

            	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
            	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
            	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

            	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
            + (dl_rlc_blocks_ack_mcs2)*28
            + (dl_rlc_blocks_ack_mcs3)*37
            + (dl_rlc_blocks_ack_mcs4)*44
            + (dl_rlc_blocks_ack_mcs5)*56
            + (dl_rlc_blocks_ack_mcs6)*74
            + (dl_rlc_blocks_ack_mcs7)*56
            + (dl_rlc_blocks_ack_mcs8)*68
            + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
            + (rlc_data_blocks_dl_cs2) *30
            + dl_rlc_blocks_ack_mcs11 *36
            + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
            sum((dl_rlc_blocks_ack_mcs1
            + dl_rlc_blocks_ack_mcs2
            + dl_rlc_blocks_ack_mcs3
            + dl_rlc_blocks_ack_mcs4
            + dl_rlc_blocks_ack_mcs5
            + dl_rlc_blocks_ack_mcs6)/50
            +(dl_rlc_blocks_ack_mcs7
            + dl_rlc_blocks_ack_mcs8
            + dl_rlc_blocks_ack_mcs9)/2/50
            +(rlc_data_blocks_dl_cs1
            - rlc_data_blocks_dl_unack
            + rlc_data_blocks_dl_cs2
            + retra_rlc_data_blocks_dl_cs1
            + retra_rlc_data_blocks_dl_cs2
            + dl_rlc_blocks_ack_mcs11
            + dl_rlc_blocks_ack_mcs12)/50
            ),2) as  `RLC_THP_DL`

            	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
            + (ul_rlc_blocks_ack_mcs2)*28
            + (ul_rlc_blocks_ack_mcs3)*37
            + (ul_rlc_blocks_ack_mcs4)*44
            + (ul_rlc_blocks_ack_mcs5)*56
            + (ul_rlc_blocks_ack_mcs6)*74
            + (ul_rlc_blocks_ack_mcs7)*56
            + (ul_rlc_blocks_ack_mcs8)*68
            + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
            +(rlc_data_blocks_ul_cs2) *30
            + ul_rlc_blocks_ack_mcs11 *36
            + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
            /
            sum((ul_rlc_blocks_ack_mcs1
            + ul_rlc_blocks_ack_mcs2
            + ul_rlc_blocks_ack_mcs3
            + ul_rlc_blocks_ack_mcs4
            + ul_rlc_blocks_ack_mcs5
            + ul_rlc_blocks_ack_mcs6)/50
            + (ul_rlc_blocks_ack_mcs7
            + ul_rlc_blocks_ack_mcs8
            + ul_rlc_blocks_ack_mcs9 )/2/50
            +(rlc_data_blocks_ul_cs1
            - rlc_data_blocks_ul_unack
            + rlc_data_blocks_ul_cs2
            + retra_data_blocks_ul_cs1
            + retra_data_blocks_ul_cs2
            + ul_rlc_blocks_ack_mcs11
            + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

            	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
            	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

              ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
              ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

              ,COUNT(*) AS `numcel`


              ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
              ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
              ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
              ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

              ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
              ,sum(a.tch_radio_fail) as tch_radio_fail
              ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
              ,sum(a.tch_tr_fail) as tch_tr_fail
              ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
              ,sum(a.tch_netw_act) as tch_netw_act
              ,sum(a.tch_lapd_fail) as tch_lapd_fail
              ,sum(a.tch_bts_fail) as tch_bts_fail
              ,sum(a.tch_act_fail_call)as tch_act_fail_call
              ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
              ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
              ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
              ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

              ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
              ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
              ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
              ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
              ,sum(a.sdcch_netw_act) as sdcch_netw_act
              ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
              ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
              ,sum(a.t3101_expired) as t3101_expired
              ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
              ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
              ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


            FROM isat_report.x_dashboard_2g_bh a
            JOIN isat_report.local_profile_2g b
            ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
            GROUP BY
            	a.xDate,b.AREA
            )

            UNION

            /* ### Aggregation (Program), Level, Band ### */

            (
            SELECT
            	a.xDate
            	,'All' AS `Aggregate`
            	,b.AREA AS `Level`
            	,b.BAND AS `Band`

            	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

            	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

            	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

            	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

            	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

            	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
            	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
            	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

            	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
            + (dl_rlc_blocks_ack_mcs2)*28
            + (dl_rlc_blocks_ack_mcs3)*37
            + (dl_rlc_blocks_ack_mcs4)*44
            + (dl_rlc_blocks_ack_mcs5)*56
            + (dl_rlc_blocks_ack_mcs6)*74
            + (dl_rlc_blocks_ack_mcs7)*56
            + (dl_rlc_blocks_ack_mcs8)*68
            + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
            + (rlc_data_blocks_dl_cs2) *30
            + dl_rlc_blocks_ack_mcs11 *36
            + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
            sum((dl_rlc_blocks_ack_mcs1
            + dl_rlc_blocks_ack_mcs2
            + dl_rlc_blocks_ack_mcs3
            + dl_rlc_blocks_ack_mcs4
            + dl_rlc_blocks_ack_mcs5
            + dl_rlc_blocks_ack_mcs6)/50
            +(dl_rlc_blocks_ack_mcs7
            + dl_rlc_blocks_ack_mcs8
            + dl_rlc_blocks_ack_mcs9)/2/50
            +(rlc_data_blocks_dl_cs1
            - rlc_data_blocks_dl_unack
            + rlc_data_blocks_dl_cs2
            + retra_rlc_data_blocks_dl_cs1
            + retra_rlc_data_blocks_dl_cs2
            + dl_rlc_blocks_ack_mcs11
            + dl_rlc_blocks_ack_mcs12)/50
            ),2) as  `RLC_THP_DL`

            	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
            + (ul_rlc_blocks_ack_mcs2)*28
            + (ul_rlc_blocks_ack_mcs3)*37
            + (ul_rlc_blocks_ack_mcs4)*44
            + (ul_rlc_blocks_ack_mcs5)*56
            + (ul_rlc_blocks_ack_mcs6)*74
            + (ul_rlc_blocks_ack_mcs7)*56
            + (ul_rlc_blocks_ack_mcs8)*68
            + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
            +(rlc_data_blocks_ul_cs2) *30
            + ul_rlc_blocks_ack_mcs11 *36
            + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
            /
            sum((ul_rlc_blocks_ack_mcs1
            + ul_rlc_blocks_ack_mcs2
            + ul_rlc_blocks_ack_mcs3
            + ul_rlc_blocks_ack_mcs4
            + ul_rlc_blocks_ack_mcs5
            + ul_rlc_blocks_ack_mcs6)/50
            + (ul_rlc_blocks_ack_mcs7
            + ul_rlc_blocks_ack_mcs8
            + ul_rlc_blocks_ack_mcs9 )/2/50
            +(rlc_data_blocks_ul_cs1
            - rlc_data_blocks_ul_unack
            + rlc_data_blocks_ul_cs2
            + retra_data_blocks_ul_cs1
            + retra_data_blocks_ul_cs2
            + ul_rlc_blocks_ack_mcs11
            + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

            	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
            	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

              ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
              ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

              ,COUNT(*) AS `numcel`


              ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
              ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
              ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
              ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

              ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
              ,sum(a.tch_radio_fail) as tch_radio_fail
              ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
              ,sum(a.tch_tr_fail) as tch_tr_fail
              ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
              ,sum(a.tch_netw_act) as tch_netw_act
              ,sum(a.tch_lapd_fail) as tch_lapd_fail
              ,sum(a.tch_bts_fail) as tch_bts_fail
              ,sum(a.tch_act_fail_call)as tch_act_fail_call
              ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
              ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
              ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
              ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

              ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
              ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
              ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
              ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
              ,sum(a.sdcch_netw_act) as sdcch_netw_act
              ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
              ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
              ,sum(a.t3101_expired) as t3101_expired
              ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
              ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
              ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


            FROM isat_report.x_dashboard_2g_bh a
            JOIN isat_report.local_profile_2g b
            ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
            GROUP BY
            	a.xDate,b.AREA,b.BAND
            )


            UNION
            /* ### Aggregation (Program), Level, Band ### */

            (
            SELECT
            	a.xDate
            	,'All' AS `Aggregate`
            	,'Network' AS `Level`
            	,b.Band AS `Band`

            	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

            	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

            	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

            	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

            	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

            	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
            	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
            	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

            	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
            + (dl_rlc_blocks_ack_mcs2)*28
            + (dl_rlc_blocks_ack_mcs3)*37
            + (dl_rlc_blocks_ack_mcs4)*44
            + (dl_rlc_blocks_ack_mcs5)*56
            + (dl_rlc_blocks_ack_mcs6)*74
            + (dl_rlc_blocks_ack_mcs7)*56
            + (dl_rlc_blocks_ack_mcs8)*68
            + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
            + (rlc_data_blocks_dl_cs2) *30
            + dl_rlc_blocks_ack_mcs11 *36
            + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
            sum((dl_rlc_blocks_ack_mcs1
            + dl_rlc_blocks_ack_mcs2
            + dl_rlc_blocks_ack_mcs3
            + dl_rlc_blocks_ack_mcs4
            + dl_rlc_blocks_ack_mcs5
            + dl_rlc_blocks_ack_mcs6)/50
            +(dl_rlc_blocks_ack_mcs7
            + dl_rlc_blocks_ack_mcs8
            + dl_rlc_blocks_ack_mcs9)/2/50
            +(rlc_data_blocks_dl_cs1
            - rlc_data_blocks_dl_unack
            + rlc_data_blocks_dl_cs2
            + retra_rlc_data_blocks_dl_cs1
            + retra_rlc_data_blocks_dl_cs2
            + dl_rlc_blocks_ack_mcs11
            + dl_rlc_blocks_ack_mcs12)/50
            ),2) as  `RLC_THP_DL`

            	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
            + (ul_rlc_blocks_ack_mcs2)*28
            + (ul_rlc_blocks_ack_mcs3)*37
            + (ul_rlc_blocks_ack_mcs4)*44
            + (ul_rlc_blocks_ack_mcs5)*56
            + (ul_rlc_blocks_ack_mcs6)*74
            + (ul_rlc_blocks_ack_mcs7)*56
            + (ul_rlc_blocks_ack_mcs8)*68
            + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
            +(rlc_data_blocks_ul_cs2) *30
            + ul_rlc_blocks_ack_mcs11 *36
            + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
            /
            sum((ul_rlc_blocks_ack_mcs1
            + ul_rlc_blocks_ack_mcs2
            + ul_rlc_blocks_ack_mcs3
            + ul_rlc_blocks_ack_mcs4
            + ul_rlc_blocks_ack_mcs5
            + ul_rlc_blocks_ack_mcs6)/50
            + (ul_rlc_blocks_ack_mcs7
            + ul_rlc_blocks_ack_mcs8
            + ul_rlc_blocks_ack_mcs9 )/2/50
            +(rlc_data_blocks_ul_cs1
            - rlc_data_blocks_ul_unack
            + rlc_data_blocks_ul_cs2
            + retra_data_blocks_ul_cs1
            + retra_data_blocks_ul_cs2
            + ul_rlc_blocks_ack_mcs11
            + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

            	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
            	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

              ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
              ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

              ,COUNT(*) AS `numcel`


              ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
              ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
              ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
              ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

              ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
              ,sum(a.tch_radio_fail) as tch_radio_fail
              ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
              ,sum(a.tch_tr_fail) as tch_tr_fail
              ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
              ,sum(a.tch_netw_act) as tch_netw_act
              ,sum(a.tch_lapd_fail) as tch_lapd_fail
              ,sum(a.tch_bts_fail) as tch_bts_fail
              ,sum(a.tch_act_fail_call)as tch_act_fail_call
              ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
              ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
              ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
              ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

              ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
              ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
              ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
              ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
              ,sum(a.sdcch_netw_act) as sdcch_netw_act
              ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
              ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
              ,sum(a.t3101_expired) as t3101_expired
              ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
              ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
              ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


            FROM isat_report.x_dashboard_2g_bh a
            JOIN isat_report.local_profile_2g b
            ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
            GROUP BY
            	a.xDate,b.BAND
            )


            UNION

            /* ### Aggregation (Program) ### */

            (
            SELECT
            	a.xDate
            	,'CatapultPO1' AS `Aggregate`
            	,b.AREA AS `Level`
            	,b.BAND AS `Band`

            	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

            	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

            	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

            	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

            	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

            	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
            	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
            	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

            	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
            + (dl_rlc_blocks_ack_mcs2)*28
            + (dl_rlc_blocks_ack_mcs3)*37
            + (dl_rlc_blocks_ack_mcs4)*44
            + (dl_rlc_blocks_ack_mcs5)*56
            + (dl_rlc_blocks_ack_mcs6)*74
            + (dl_rlc_blocks_ack_mcs7)*56
            + (dl_rlc_blocks_ack_mcs8)*68
            + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
            + (rlc_data_blocks_dl_cs2) *30
            + dl_rlc_blocks_ack_mcs11 *36
            + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
            sum((dl_rlc_blocks_ack_mcs1
            + dl_rlc_blocks_ack_mcs2
            + dl_rlc_blocks_ack_mcs3
            + dl_rlc_blocks_ack_mcs4
            + dl_rlc_blocks_ack_mcs5
            + dl_rlc_blocks_ack_mcs6)/50
            +(dl_rlc_blocks_ack_mcs7
            + dl_rlc_blocks_ack_mcs8
            + dl_rlc_blocks_ack_mcs9)/2/50
            +(rlc_data_blocks_dl_cs1
            - rlc_data_blocks_dl_unack
            + rlc_data_blocks_dl_cs2
            + retra_rlc_data_blocks_dl_cs1
            + retra_rlc_data_blocks_dl_cs2
            + dl_rlc_blocks_ack_mcs11
            + dl_rlc_blocks_ack_mcs12)/50
            ),2) as  `RLC_THP_DL`

            	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
            + (ul_rlc_blocks_ack_mcs2)*28
            + (ul_rlc_blocks_ack_mcs3)*37
            + (ul_rlc_blocks_ack_mcs4)*44
            + (ul_rlc_blocks_ack_mcs5)*56
            + (ul_rlc_blocks_ack_mcs6)*74
            + (ul_rlc_blocks_ack_mcs7)*56
            + (ul_rlc_blocks_ack_mcs8)*68
            + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
            +(rlc_data_blocks_ul_cs2) *30
            + ul_rlc_blocks_ack_mcs11 *36
            + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
            /
            sum((ul_rlc_blocks_ack_mcs1
            + ul_rlc_blocks_ack_mcs2
            + ul_rlc_blocks_ack_mcs3
            + ul_rlc_blocks_ack_mcs4
            + ul_rlc_blocks_ack_mcs5
            + ul_rlc_blocks_ack_mcs6)/50
            + (ul_rlc_blocks_ack_mcs7
            + ul_rlc_blocks_ack_mcs8
            + ul_rlc_blocks_ack_mcs9 )/2/50
            +(rlc_data_blocks_ul_cs1
            - rlc_data_blocks_ul_unack
            + rlc_data_blocks_ul_cs2
            + retra_data_blocks_ul_cs1
            + retra_data_blocks_ul_cs2
            + ul_rlc_blocks_ack_mcs11
            + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

            	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
            	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

              ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
              ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

              ,COUNT(*) AS `numcel`


              ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
              ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
              ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
              ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

              ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
              ,sum(a.tch_radio_fail) as tch_radio_fail
              ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
              ,sum(a.tch_tr_fail) as tch_tr_fail
              ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
              ,sum(a.tch_netw_act) as tch_netw_act
              ,sum(a.tch_lapd_fail) as tch_lapd_fail
              ,sum(a.tch_bts_fail) as tch_bts_fail
              ,sum(a.tch_act_fail_call)as tch_act_fail_call
              ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
              ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
              ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
              ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

              ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
              ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
              ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
              ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
              ,sum(a.sdcch_netw_act) as sdcch_netw_act
              ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
              ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
              ,sum(a.t3101_expired) as t3101_expired
              ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
              ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
              ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


            FROM isat_report.x_dashboard_2g_bh a
            JOIN isat_report.local_profile_2g b
            ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
            where b.CatapultPO1 = 1
            GROUP BY
            	a.xDate,b.AREA,b.BAND
            )


            UNION

            /* ### Aggregation (Program) ### */

            (
            SELECT
            	a.xDate
            	,'CatapultPO1B' AS `Aggregate`
            	,b.AREA AS `Level`
            	,b.BAND AS `Band`

            	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

            	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

            	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

            	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

            	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

            	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
            	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
            	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

            	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
            + (dl_rlc_blocks_ack_mcs2)*28
            + (dl_rlc_blocks_ack_mcs3)*37
            + (dl_rlc_blocks_ack_mcs4)*44
            + (dl_rlc_blocks_ack_mcs5)*56
            + (dl_rlc_blocks_ack_mcs6)*74
            + (dl_rlc_blocks_ack_mcs7)*56
            + (dl_rlc_blocks_ack_mcs8)*68
            + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
            + (rlc_data_blocks_dl_cs2) *30
            + dl_rlc_blocks_ack_mcs11 *36
            + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
            sum((dl_rlc_blocks_ack_mcs1
            + dl_rlc_blocks_ack_mcs2
            + dl_rlc_blocks_ack_mcs3
            + dl_rlc_blocks_ack_mcs4
            + dl_rlc_blocks_ack_mcs5
            + dl_rlc_blocks_ack_mcs6)/50
            +(dl_rlc_blocks_ack_mcs7
            + dl_rlc_blocks_ack_mcs8
            + dl_rlc_blocks_ack_mcs9)/2/50
            +(rlc_data_blocks_dl_cs1
            - rlc_data_blocks_dl_unack
            + rlc_data_blocks_dl_cs2
            + retra_rlc_data_blocks_dl_cs1
            + retra_rlc_data_blocks_dl_cs2
            + dl_rlc_blocks_ack_mcs11
            + dl_rlc_blocks_ack_mcs12)/50
            ),2) as  `RLC_THP_DL`

            	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
            + (ul_rlc_blocks_ack_mcs2)*28
            + (ul_rlc_blocks_ack_mcs3)*37
            + (ul_rlc_blocks_ack_mcs4)*44
            + (ul_rlc_blocks_ack_mcs5)*56
            + (ul_rlc_blocks_ack_mcs6)*74
            + (ul_rlc_blocks_ack_mcs7)*56
            + (ul_rlc_blocks_ack_mcs8)*68
            + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
            +(rlc_data_blocks_ul_cs2) *30
            + ul_rlc_blocks_ack_mcs11 *36
            + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
            /
            sum((ul_rlc_blocks_ack_mcs1
            + ul_rlc_blocks_ack_mcs2
            + ul_rlc_blocks_ack_mcs3
            + ul_rlc_blocks_ack_mcs4
            + ul_rlc_blocks_ack_mcs5
            + ul_rlc_blocks_ack_mcs6)/50
            + (ul_rlc_blocks_ack_mcs7
            + ul_rlc_blocks_ack_mcs8
            + ul_rlc_blocks_ack_mcs9 )/2/50
            +(rlc_data_blocks_ul_cs1
            - rlc_data_blocks_ul_unack
            + rlc_data_blocks_ul_cs2
            + retra_data_blocks_ul_cs1
            + retra_data_blocks_ul_cs2
            + ul_rlc_blocks_ack_mcs11
            + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

            	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
            	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

              ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
              ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

              ,COUNT(*) AS `numcel`


              ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
              ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
              ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
              ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

              ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
              ,sum(a.tch_radio_fail) as tch_radio_fail
              ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
              ,sum(a.tch_tr_fail) as tch_tr_fail
              ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
              ,sum(a.tch_netw_act) as tch_netw_act
              ,sum(a.tch_lapd_fail) as tch_lapd_fail
              ,sum(a.tch_bts_fail) as tch_bts_fail
              ,sum(a.tch_act_fail_call)as tch_act_fail_call
              ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
              ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
              ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
              ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

              ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
              ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
              ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
              ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
              ,sum(a.sdcch_netw_act) as sdcch_netw_act
              ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
              ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
              ,sum(a.t3101_expired) as t3101_expired
              ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
              ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
              ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


            FROM isat_report.x_dashboard_2g_bh a
            JOIN isat_report.local_profile_2g b
            ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
            where b.CatapultPO1B = 1
            GROUP BY
            	a.xDate,b.AREA,b.BAND
            )

            UNION

            /* ### Aggregation (Program) ### */

            (
            SELECT
            	a.xDate
            	,'4GOverlayPack3' AS `Aggregate`
            	,b.AREA AS `Level`
            	,b.BAND AS `Band`

            	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

            	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

            	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

            	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

            	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

            	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
            	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
            	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

            	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
            + (dl_rlc_blocks_ack_mcs2)*28
            + (dl_rlc_blocks_ack_mcs3)*37
            + (dl_rlc_blocks_ack_mcs4)*44
            + (dl_rlc_blocks_ack_mcs5)*56
            + (dl_rlc_blocks_ack_mcs6)*74
            + (dl_rlc_blocks_ack_mcs7)*56
            + (dl_rlc_blocks_ack_mcs8)*68
            + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
            + (rlc_data_blocks_dl_cs2) *30
            + dl_rlc_blocks_ack_mcs11 *36
            + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
            sum((dl_rlc_blocks_ack_mcs1
            + dl_rlc_blocks_ack_mcs2
            + dl_rlc_blocks_ack_mcs3
            + dl_rlc_blocks_ack_mcs4
            + dl_rlc_blocks_ack_mcs5
            + dl_rlc_blocks_ack_mcs6)/50
            +(dl_rlc_blocks_ack_mcs7
            + dl_rlc_blocks_ack_mcs8
            + dl_rlc_blocks_ack_mcs9)/2/50
            +(rlc_data_blocks_dl_cs1
            - rlc_data_blocks_dl_unack
            + rlc_data_blocks_dl_cs2
            + retra_rlc_data_blocks_dl_cs1
            + retra_rlc_data_blocks_dl_cs2
            + dl_rlc_blocks_ack_mcs11
            + dl_rlc_blocks_ack_mcs12)/50
            ),2) as  `RLC_THP_DL`

            	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
            + (ul_rlc_blocks_ack_mcs2)*28
            + (ul_rlc_blocks_ack_mcs3)*37
            + (ul_rlc_blocks_ack_mcs4)*44
            + (ul_rlc_blocks_ack_mcs5)*56
            + (ul_rlc_blocks_ack_mcs6)*74
            + (ul_rlc_blocks_ack_mcs7)*56
            + (ul_rlc_blocks_ack_mcs8)*68
            + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
            +(rlc_data_blocks_ul_cs2) *30
            + ul_rlc_blocks_ack_mcs11 *36
            + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
            /
            sum((ul_rlc_blocks_ack_mcs1
            + ul_rlc_blocks_ack_mcs2
            + ul_rlc_blocks_ack_mcs3
            + ul_rlc_blocks_ack_mcs4
            + ul_rlc_blocks_ack_mcs5
            + ul_rlc_blocks_ack_mcs6)/50
            + (ul_rlc_blocks_ack_mcs7
            + ul_rlc_blocks_ack_mcs8
            + ul_rlc_blocks_ack_mcs9 )/2/50
            +(rlc_data_blocks_ul_cs1
            - rlc_data_blocks_ul_unack
            + rlc_data_blocks_ul_cs2
            + retra_data_blocks_ul_cs1
            + retra_data_blocks_ul_cs2
            + ul_rlc_blocks_ack_mcs11
            + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

            	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
            	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

              ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
              ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

              ,COUNT(*) AS `numcel`


              ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
              ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
              ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
              ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

              ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
              ,sum(a.tch_radio_fail) as tch_radio_fail
              ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
              ,sum(a.tch_tr_fail) as tch_tr_fail
              ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
              ,sum(a.tch_netw_act) as tch_netw_act
              ,sum(a.tch_lapd_fail) as tch_lapd_fail
              ,sum(a.tch_bts_fail) as tch_bts_fail
              ,sum(a.tch_act_fail_call)as tch_act_fail_call
              ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
              ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
              ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
              ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

              ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
              ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
              ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
              ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
              ,sum(a.sdcch_netw_act) as sdcch_netw_act
              ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
              ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
              ,sum(a.t3101_expired) as t3101_expired
              ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
              ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
              ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


            FROM isat_report.x_dashboard_2g_bh a
            JOIN isat_report.local_profile_2g b
            ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
            where b.4GOverlayPack3 = 1
            GROUP BY
            	a.xDate,b.AREA,b.BAND
            )

            UNION

            /* ### Aggregation (Program) ### */

            (
            SELECT
            	a.xDate
            	,'4GOverlayPack4' AS `Aggregate`
            	,b.AREA AS `Level`
            	,b.BAND AS `Band`

            	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

            	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

            	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

            	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

            	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

            	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
            	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
            	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

            	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
            + (dl_rlc_blocks_ack_mcs2)*28
            + (dl_rlc_blocks_ack_mcs3)*37
            + (dl_rlc_blocks_ack_mcs4)*44
            + (dl_rlc_blocks_ack_mcs5)*56
            + (dl_rlc_blocks_ack_mcs6)*74
            + (dl_rlc_blocks_ack_mcs7)*56
            + (dl_rlc_blocks_ack_mcs8)*68
            + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
            + (rlc_data_blocks_dl_cs2) *30
            + dl_rlc_blocks_ack_mcs11 *36
            + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
            sum((dl_rlc_blocks_ack_mcs1
            + dl_rlc_blocks_ack_mcs2
            + dl_rlc_blocks_ack_mcs3
            + dl_rlc_blocks_ack_mcs4
            + dl_rlc_blocks_ack_mcs5
            + dl_rlc_blocks_ack_mcs6)/50
            +(dl_rlc_blocks_ack_mcs7
            + dl_rlc_blocks_ack_mcs8
            + dl_rlc_blocks_ack_mcs9)/2/50
            +(rlc_data_blocks_dl_cs1
            - rlc_data_blocks_dl_unack
            + rlc_data_blocks_dl_cs2
            + retra_rlc_data_blocks_dl_cs1
            + retra_rlc_data_blocks_dl_cs2
            + dl_rlc_blocks_ack_mcs11
            + dl_rlc_blocks_ack_mcs12)/50
            ),2) as  `RLC_THP_DL`

            	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
            + (ul_rlc_blocks_ack_mcs2)*28
            + (ul_rlc_blocks_ack_mcs3)*37
            + (ul_rlc_blocks_ack_mcs4)*44
            + (ul_rlc_blocks_ack_mcs5)*56
            + (ul_rlc_blocks_ack_mcs6)*74
            + (ul_rlc_blocks_ack_mcs7)*56
            + (ul_rlc_blocks_ack_mcs8)*68
            + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
            +(rlc_data_blocks_ul_cs2) *30
            + ul_rlc_blocks_ack_mcs11 *36
            + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
            /
            sum((ul_rlc_blocks_ack_mcs1
            + ul_rlc_blocks_ack_mcs2
            + ul_rlc_blocks_ack_mcs3
            + ul_rlc_blocks_ack_mcs4
            + ul_rlc_blocks_ack_mcs5
            + ul_rlc_blocks_ack_mcs6)/50
            + (ul_rlc_blocks_ack_mcs7
            + ul_rlc_blocks_ack_mcs8
            + ul_rlc_blocks_ack_mcs9 )/2/50
            +(rlc_data_blocks_ul_cs1
            - rlc_data_blocks_ul_unack
            + rlc_data_blocks_ul_cs2
            + retra_data_blocks_ul_cs1
            + retra_data_blocks_ul_cs2
            + ul_rlc_blocks_ack_mcs11
            + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

            	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
            	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

              ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
              ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

              ,COUNT(*) AS `numcel`


              ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
              ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
              ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
              ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

              ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
              ,sum(a.tch_radio_fail) as tch_radio_fail
              ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
              ,sum(a.tch_tr_fail) as tch_tr_fail
              ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
              ,sum(a.tch_netw_act) as tch_netw_act
              ,sum(a.tch_lapd_fail) as tch_lapd_fail
              ,sum(a.tch_bts_fail) as tch_bts_fail
              ,sum(a.tch_act_fail_call)as tch_act_fail_call
              ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
              ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
              ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
              ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

              ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
              ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
              ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
              ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
              ,sum(a.sdcch_netw_act) as sdcch_netw_act
              ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
              ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
              ,sum(a.t3101_expired) as t3101_expired
              ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
              ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
              ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


            FROM isat_report.x_dashboard_2g_bh a
            JOIN isat_report.local_profile_2g b
            ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
            where b.4GOverlayPack4 = 1
            GROUP BY
            	a.xDate,b.AREA,b.BAND
            )

            UNION

            /* ### Aggregation (Program) ### */

            (
            SELECT
            	a.xDate
            	,'SnapshotDecember2018' AS `Aggregate`
            	,b.AREA AS `Level`
            	,b.BAND AS `Band`

            	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

            	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

            	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

            	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

            	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

            	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
            	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
            	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

            	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
            + (dl_rlc_blocks_ack_mcs2)*28
            + (dl_rlc_blocks_ack_mcs3)*37
            + (dl_rlc_blocks_ack_mcs4)*44
            + (dl_rlc_blocks_ack_mcs5)*56
            + (dl_rlc_blocks_ack_mcs6)*74
            + (dl_rlc_blocks_ack_mcs7)*56
            + (dl_rlc_blocks_ack_mcs8)*68
            + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
            + (rlc_data_blocks_dl_cs2) *30
            + dl_rlc_blocks_ack_mcs11 *36
            + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
            sum((dl_rlc_blocks_ack_mcs1
            + dl_rlc_blocks_ack_mcs2
            + dl_rlc_blocks_ack_mcs3
            + dl_rlc_blocks_ack_mcs4
            + dl_rlc_blocks_ack_mcs5
            + dl_rlc_blocks_ack_mcs6)/50
            +(dl_rlc_blocks_ack_mcs7
            + dl_rlc_blocks_ack_mcs8
            + dl_rlc_blocks_ack_mcs9)/2/50
            +(rlc_data_blocks_dl_cs1
            - rlc_data_blocks_dl_unack
            + rlc_data_blocks_dl_cs2
            + retra_rlc_data_blocks_dl_cs1
            + retra_rlc_data_blocks_dl_cs2
            + dl_rlc_blocks_ack_mcs11
            + dl_rlc_blocks_ack_mcs12)/50
            ),2) as  `RLC_THP_DL`

            	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
            + (ul_rlc_blocks_ack_mcs2)*28
            + (ul_rlc_blocks_ack_mcs3)*37
            + (ul_rlc_blocks_ack_mcs4)*44
            + (ul_rlc_blocks_ack_mcs5)*56
            + (ul_rlc_blocks_ack_mcs6)*74
            + (ul_rlc_blocks_ack_mcs7)*56
            + (ul_rlc_blocks_ack_mcs8)*68
            + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
            +(rlc_data_blocks_ul_cs2) *30
            + ul_rlc_blocks_ack_mcs11 *36
            + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
            /
            sum((ul_rlc_blocks_ack_mcs1
            + ul_rlc_blocks_ack_mcs2
            + ul_rlc_blocks_ack_mcs3
            + ul_rlc_blocks_ack_mcs4
            + ul_rlc_blocks_ack_mcs5
            + ul_rlc_blocks_ack_mcs6)/50
            + (ul_rlc_blocks_ack_mcs7
            + ul_rlc_blocks_ack_mcs8
            + ul_rlc_blocks_ack_mcs9 )/2/50
            +(rlc_data_blocks_ul_cs1
            - rlc_data_blocks_ul_unack
            + rlc_data_blocks_ul_cs2
            + retra_data_blocks_ul_cs1
            + retra_data_blocks_ul_cs2
            + ul_rlc_blocks_ack_mcs11
            + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

            	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
            	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

              ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
              ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

              ,COUNT(*) AS `numcel`


              ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
              ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
              ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
              ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

              ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
              ,sum(a.tch_radio_fail) as tch_radio_fail
              ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
              ,sum(a.tch_tr_fail) as tch_tr_fail
              ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
              ,sum(a.tch_netw_act) as tch_netw_act
              ,sum(a.tch_lapd_fail) as tch_lapd_fail
              ,sum(a.tch_bts_fail) as tch_bts_fail
              ,sum(a.tch_act_fail_call)as tch_act_fail_call
              ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
              ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
              ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
              ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

              ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
              ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
              ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
              ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
              ,sum(a.sdcch_netw_act) as sdcch_netw_act
              ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
              ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
              ,sum(a.t3101_expired) as t3101_expired
              ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
              ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
              ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


            FROM isat_report.x_dashboard_2g_bh a
             JOIN isat_report.local_profile_2g b
            ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
            where b.SnapshotDecember2018 = 1
            GROUP BY
            	a.xDate,b.AREA,b.BAND
            )

            UNION

            (
            SELECT
            	a.xDate
            	,'CatapultPO1' AS `Aggregate`
            	,b.AREA AS `Level`
            	,'All' AS `Band`

            	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

            	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

            	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

            	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

            	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

            	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
            	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
            	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

            	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
            + (dl_rlc_blocks_ack_mcs2)*28
            + (dl_rlc_blocks_ack_mcs3)*37
            + (dl_rlc_blocks_ack_mcs4)*44
            + (dl_rlc_blocks_ack_mcs5)*56
            + (dl_rlc_blocks_ack_mcs6)*74
            + (dl_rlc_blocks_ack_mcs7)*56
            + (dl_rlc_blocks_ack_mcs8)*68
            + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
            + (rlc_data_blocks_dl_cs2) *30
            + dl_rlc_blocks_ack_mcs11 *36
            + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
            sum((dl_rlc_blocks_ack_mcs1
            + dl_rlc_blocks_ack_mcs2
            + dl_rlc_blocks_ack_mcs3
            + dl_rlc_blocks_ack_mcs4
            + dl_rlc_blocks_ack_mcs5
            + dl_rlc_blocks_ack_mcs6)/50
            +(dl_rlc_blocks_ack_mcs7
            + dl_rlc_blocks_ack_mcs8
            + dl_rlc_blocks_ack_mcs9)/2/50
            +(rlc_data_blocks_dl_cs1
            - rlc_data_blocks_dl_unack
            + rlc_data_blocks_dl_cs2
            + retra_rlc_data_blocks_dl_cs1
            + retra_rlc_data_blocks_dl_cs2
            + dl_rlc_blocks_ack_mcs11
            + dl_rlc_blocks_ack_mcs12)/50
            ),2) as  `RLC_THP_DL`

            	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
            + (ul_rlc_blocks_ack_mcs2)*28
            + (ul_rlc_blocks_ack_mcs3)*37
            + (ul_rlc_blocks_ack_mcs4)*44
            + (ul_rlc_blocks_ack_mcs5)*56
            + (ul_rlc_blocks_ack_mcs6)*74
            + (ul_rlc_blocks_ack_mcs7)*56
            + (ul_rlc_blocks_ack_mcs8)*68
            + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
            +(rlc_data_blocks_ul_cs2) *30
            + ul_rlc_blocks_ack_mcs11 *36
            + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
            /
            sum((ul_rlc_blocks_ack_mcs1
            + ul_rlc_blocks_ack_mcs2
            + ul_rlc_blocks_ack_mcs3
            + ul_rlc_blocks_ack_mcs4
            + ul_rlc_blocks_ack_mcs5
            + ul_rlc_blocks_ack_mcs6)/50
            + (ul_rlc_blocks_ack_mcs7
            + ul_rlc_blocks_ack_mcs8
            + ul_rlc_blocks_ack_mcs9 )/2/50
            +(rlc_data_blocks_ul_cs1
            - rlc_data_blocks_ul_unack
            + rlc_data_blocks_ul_cs2
            + retra_data_blocks_ul_cs1
            + retra_data_blocks_ul_cs2
            + ul_rlc_blocks_ack_mcs11
            + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

            	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
            	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

              ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
              ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

              ,COUNT(*) AS `numcel`


              ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
              ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
              ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
              ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

              ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
              ,sum(a.tch_radio_fail) as tch_radio_fail
              ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
              ,sum(a.tch_tr_fail) as tch_tr_fail
              ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
              ,sum(a.tch_netw_act) as tch_netw_act
              ,sum(a.tch_lapd_fail) as tch_lapd_fail
              ,sum(a.tch_bts_fail) as tch_bts_fail
              ,sum(a.tch_act_fail_call)as tch_act_fail_call
              ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
              ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
              ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
              ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

              ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
              ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
              ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
              ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
              ,sum(a.sdcch_netw_act) as sdcch_netw_act
              ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
              ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
              ,sum(a.t3101_expired) as t3101_expired
              ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
              ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
              ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


            FROM isat_report.x_dashboard_2g_bh a
            JOIN isat_report.local_profile_2g b
            ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
            where b.CatapultPO1 = 1
            GROUP BY
            	a.xDate,b.AREA
            )


            UNION

            /* ### Aggregation (Program) ### */

            (
            SELECT
            	a.xDate
            	,'CatapultPO1B' AS `Aggregate`
            	,b.AREA AS `Level`
            	,'All' AS `Band`

            	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

            	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

            	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

            	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

            	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

            	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
            	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
            	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

            	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
            + (dl_rlc_blocks_ack_mcs2)*28
            + (dl_rlc_blocks_ack_mcs3)*37
            + (dl_rlc_blocks_ack_mcs4)*44
            + (dl_rlc_blocks_ack_mcs5)*56
            + (dl_rlc_blocks_ack_mcs6)*74
            + (dl_rlc_blocks_ack_mcs7)*56
            + (dl_rlc_blocks_ack_mcs8)*68
            + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
            + (rlc_data_blocks_dl_cs2) *30
            + dl_rlc_blocks_ack_mcs11 *36
            + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
            sum((dl_rlc_blocks_ack_mcs1
            + dl_rlc_blocks_ack_mcs2
            + dl_rlc_blocks_ack_mcs3
            + dl_rlc_blocks_ack_mcs4
            + dl_rlc_blocks_ack_mcs5
            + dl_rlc_blocks_ack_mcs6)/50
            +(dl_rlc_blocks_ack_mcs7
            + dl_rlc_blocks_ack_mcs8
            + dl_rlc_blocks_ack_mcs9)/2/50
            +(rlc_data_blocks_dl_cs1
            - rlc_data_blocks_dl_unack
            + rlc_data_blocks_dl_cs2
            + retra_rlc_data_blocks_dl_cs1
            + retra_rlc_data_blocks_dl_cs2
            + dl_rlc_blocks_ack_mcs11
            + dl_rlc_blocks_ack_mcs12)/50
            ),2) as  `RLC_THP_DL`

            	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
            + (ul_rlc_blocks_ack_mcs2)*28
            + (ul_rlc_blocks_ack_mcs3)*37
            + (ul_rlc_blocks_ack_mcs4)*44
            + (ul_rlc_blocks_ack_mcs5)*56
            + (ul_rlc_blocks_ack_mcs6)*74
            + (ul_rlc_blocks_ack_mcs7)*56
            + (ul_rlc_blocks_ack_mcs8)*68
            + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
            +(rlc_data_blocks_ul_cs2) *30
            + ul_rlc_blocks_ack_mcs11 *36
            + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
            /
            sum((ul_rlc_blocks_ack_mcs1
            + ul_rlc_blocks_ack_mcs2
            + ul_rlc_blocks_ack_mcs3
            + ul_rlc_blocks_ack_mcs4
            + ul_rlc_blocks_ack_mcs5
            + ul_rlc_blocks_ack_mcs6)/50
            + (ul_rlc_blocks_ack_mcs7
            + ul_rlc_blocks_ack_mcs8
            + ul_rlc_blocks_ack_mcs9 )/2/50
            +(rlc_data_blocks_ul_cs1
            - rlc_data_blocks_ul_unack
            + rlc_data_blocks_ul_cs2
            + retra_data_blocks_ul_cs1
            + retra_data_blocks_ul_cs2
            + ul_rlc_blocks_ack_mcs11
            + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

            	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
            	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

              ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
              ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

              ,COUNT(*) AS `numcel`


              ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
              ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
              ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
              ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

              ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
              ,sum(a.tch_radio_fail) as tch_radio_fail
              ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
              ,sum(a.tch_tr_fail) as tch_tr_fail
              ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
              ,sum(a.tch_netw_act) as tch_netw_act
              ,sum(a.tch_lapd_fail) as tch_lapd_fail
              ,sum(a.tch_bts_fail) as tch_bts_fail
              ,sum(a.tch_act_fail_call)as tch_act_fail_call
              ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
              ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
              ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
              ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

              ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
              ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
              ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
              ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
              ,sum(a.sdcch_netw_act) as sdcch_netw_act
              ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
              ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
              ,sum(a.t3101_expired) as t3101_expired
              ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
              ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
              ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


            FROM isat_report.x_dashboard_2g_bh a
            JOIN isat_report.local_profile_2g b
            ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
            where b.CatapultPO1B = 1
            GROUP BY
            	a.xDate,b.AREA
            )

            UNION

            /* ### Aggregation (Program) ### */

            (
            SELECT
            	a.xDate
            	,'4GOverlayPack3' AS `Aggregate`
            	,b.AREA AS `Level`
            	,'All' AS `Band`

            	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

            	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

            	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

            	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

            	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

            	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
            	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
            	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

            	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
            + (dl_rlc_blocks_ack_mcs2)*28
            + (dl_rlc_blocks_ack_mcs3)*37
            + (dl_rlc_blocks_ack_mcs4)*44
            + (dl_rlc_blocks_ack_mcs5)*56
            + (dl_rlc_blocks_ack_mcs6)*74
            + (dl_rlc_blocks_ack_mcs7)*56
            + (dl_rlc_blocks_ack_mcs8)*68
            + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
            + (rlc_data_blocks_dl_cs2) *30
            + dl_rlc_blocks_ack_mcs11 *36
            + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
            sum((dl_rlc_blocks_ack_mcs1
            + dl_rlc_blocks_ack_mcs2
            + dl_rlc_blocks_ack_mcs3
            + dl_rlc_blocks_ack_mcs4
            + dl_rlc_blocks_ack_mcs5
            + dl_rlc_blocks_ack_mcs6)/50
            +(dl_rlc_blocks_ack_mcs7
            + dl_rlc_blocks_ack_mcs8
            + dl_rlc_blocks_ack_mcs9)/2/50
            +(rlc_data_blocks_dl_cs1
            - rlc_data_blocks_dl_unack
            + rlc_data_blocks_dl_cs2
            + retra_rlc_data_blocks_dl_cs1
            + retra_rlc_data_blocks_dl_cs2
            + dl_rlc_blocks_ack_mcs11
            + dl_rlc_blocks_ack_mcs12)/50
            ),2) as  `RLC_THP_DL`

            	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
            + (ul_rlc_blocks_ack_mcs2)*28
            + (ul_rlc_blocks_ack_mcs3)*37
            + (ul_rlc_blocks_ack_mcs4)*44
            + (ul_rlc_blocks_ack_mcs5)*56
            + (ul_rlc_blocks_ack_mcs6)*74
            + (ul_rlc_blocks_ack_mcs7)*56
            + (ul_rlc_blocks_ack_mcs8)*68
            + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
            +(rlc_data_blocks_ul_cs2) *30
            + ul_rlc_blocks_ack_mcs11 *36
            + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
            /
            sum((ul_rlc_blocks_ack_mcs1
            + ul_rlc_blocks_ack_mcs2
            + ul_rlc_blocks_ack_mcs3
            + ul_rlc_blocks_ack_mcs4
            + ul_rlc_blocks_ack_mcs5
            + ul_rlc_blocks_ack_mcs6)/50
            + (ul_rlc_blocks_ack_mcs7
            + ul_rlc_blocks_ack_mcs8
            + ul_rlc_blocks_ack_mcs9 )/2/50
            +(rlc_data_blocks_ul_cs1
            - rlc_data_blocks_ul_unack
            + rlc_data_blocks_ul_cs2
            + retra_data_blocks_ul_cs1
            + retra_data_blocks_ul_cs2
            + ul_rlc_blocks_ack_mcs11
            + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

            	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
            	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

              ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
              ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

              ,COUNT(*) AS `numcel`


              ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
              ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
              ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
              ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

              ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
              ,sum(a.tch_radio_fail) as tch_radio_fail
              ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
              ,sum(a.tch_tr_fail) as tch_tr_fail
              ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
              ,sum(a.tch_netw_act) as tch_netw_act
              ,sum(a.tch_lapd_fail) as tch_lapd_fail
              ,sum(a.tch_bts_fail) as tch_bts_fail
              ,sum(a.tch_act_fail_call)as tch_act_fail_call
              ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
              ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
              ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
              ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

              ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
              ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
              ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
              ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
              ,sum(a.sdcch_netw_act) as sdcch_netw_act
              ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
              ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
              ,sum(a.t3101_expired) as t3101_expired
              ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
              ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
              ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


            FROM isat_report.x_dashboard_2g_bh a
            JOIN isat_report.local_profile_2g b
            ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
            where b.4GOverlayPack3 = 1
            GROUP BY
            	a.xDate,b.AREA
            )

            UNION

            /* ### Aggregation (Program) ### */

            (
            SELECT
            	a.xDate
            	,'4GOverlayPack4' AS `Aggregate`
            	,b.AREA AS `Level`
            	,'All' AS `Band`

            	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

            	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

            	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

            	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

            	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

            	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
            	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
            	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

            	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
            + (dl_rlc_blocks_ack_mcs2)*28
            + (dl_rlc_blocks_ack_mcs3)*37
            + (dl_rlc_blocks_ack_mcs4)*44
            + (dl_rlc_blocks_ack_mcs5)*56
            + (dl_rlc_blocks_ack_mcs6)*74
            + (dl_rlc_blocks_ack_mcs7)*56
            + (dl_rlc_blocks_ack_mcs8)*68
            + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
            + (rlc_data_blocks_dl_cs2) *30
            + dl_rlc_blocks_ack_mcs11 *36
            + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
            sum((dl_rlc_blocks_ack_mcs1
            + dl_rlc_blocks_ack_mcs2
            + dl_rlc_blocks_ack_mcs3
            + dl_rlc_blocks_ack_mcs4
            + dl_rlc_blocks_ack_mcs5
            + dl_rlc_blocks_ack_mcs6)/50
            +(dl_rlc_blocks_ack_mcs7
            + dl_rlc_blocks_ack_mcs8
            + dl_rlc_blocks_ack_mcs9)/2/50
            +(rlc_data_blocks_dl_cs1
            - rlc_data_blocks_dl_unack
            + rlc_data_blocks_dl_cs2
            + retra_rlc_data_blocks_dl_cs1
            + retra_rlc_data_blocks_dl_cs2
            + dl_rlc_blocks_ack_mcs11
            + dl_rlc_blocks_ack_mcs12)/50
            ),2) as  `RLC_THP_DL`

            	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
            + (ul_rlc_blocks_ack_mcs2)*28
            + (ul_rlc_blocks_ack_mcs3)*37
            + (ul_rlc_blocks_ack_mcs4)*44
            + (ul_rlc_blocks_ack_mcs5)*56
            + (ul_rlc_blocks_ack_mcs6)*74
            + (ul_rlc_blocks_ack_mcs7)*56
            + (ul_rlc_blocks_ack_mcs8)*68
            + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
            +(rlc_data_blocks_ul_cs2) *30
            + ul_rlc_blocks_ack_mcs11 *36
            + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
            /
            sum((ul_rlc_blocks_ack_mcs1
            + ul_rlc_blocks_ack_mcs2
            + ul_rlc_blocks_ack_mcs3
            + ul_rlc_blocks_ack_mcs4
            + ul_rlc_blocks_ack_mcs5
            + ul_rlc_blocks_ack_mcs6)/50
            + (ul_rlc_blocks_ack_mcs7
            + ul_rlc_blocks_ack_mcs8
            + ul_rlc_blocks_ack_mcs9 )/2/50
            +(rlc_data_blocks_ul_cs1
            - rlc_data_blocks_ul_unack
            + rlc_data_blocks_ul_cs2
            + retra_data_blocks_ul_cs1
            + retra_data_blocks_ul_cs2
            + ul_rlc_blocks_ack_mcs11
            + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

            	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
            	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

              ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
              ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

              ,COUNT(*) AS `numcel`


              ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
              ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
              ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
              ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

              ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
              ,sum(a.tch_radio_fail) as tch_radio_fail
              ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
              ,sum(a.tch_tr_fail) as tch_tr_fail
              ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
              ,sum(a.tch_netw_act) as tch_netw_act
              ,sum(a.tch_lapd_fail) as tch_lapd_fail
              ,sum(a.tch_bts_fail) as tch_bts_fail
              ,sum(a.tch_act_fail_call)as tch_act_fail_call
              ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
              ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
              ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
              ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

              ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
              ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
              ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
              ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
              ,sum(a.sdcch_netw_act) as sdcch_netw_act
              ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
              ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
              ,sum(a.t3101_expired) as t3101_expired
              ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
              ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
              ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


            FROM isat_report.x_dashboard_2g_bh a
            JOIN isat_report.local_profile_2g b
            ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
            where b.4GOverlayPack4 = 1
            GROUP BY
            	a.xDate,b.AREA
            )

            UNION

            /* ### Aggregation (Program) ### */

            (
            SELECT
            	a.xDate
            	,'SnapshotDecember2018' AS `Aggregate`
            	,b.AREA AS `Level`
            	,'All' AS `Band`

            	,ROUND(sum(period_duration*ave_busy_tch/res_av_denom14/60),2) AS `Traffic_CS`

            	,ROUND((sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024  + (sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 + (sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024  + (sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024,2) AS `Traffic_PS`

            	,ROUND(100*(sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5)/sum(freq_dl_qual0 + freq_dl_qual1 + freq_dl_qual2 + freq_dl_qual3 + freq_dl_qual4 + freq_dl_qual5 + freq_dl_qual6 + freq_dl_qual7)),2) as DLQual

            	,ROUND(100*(sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5)/sum(freq_ul_qual0 + freq_ul_qual1 + freq_ul_qual2 + freq_ul_qual3 + freq_ul_qual4 + freq_ul_qual5 + freq_ul_qual6 + freq_ul_qual7)),2) as UL_Qual

            	,ROUND(100*(sum(((sdcch_assign))*((tch_new_call_assign))*(((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))-((sdcch_radio_fail+sdcch_rf_old_ho+sdcch_user_act+sdcch_bcsu_reset+sdcch_netw_act+sdcch_abis_fail_call+sdcch_abis_fail_old+sdcch_bts_fail+sdcch_lapd_fail+sdcch_a_if_fail_call+sdcch_a_if_fail_old-T3101_EXPIRED))))/sum(((sdcch_req))*((sdcch_assign+msc_i_sdcch+cell_sdcch+bsc_i_sdcch))*((tch_requests_call_attempt)))),2)  as `CSSR CS`

            	,ROUND(100*(sum(msc_o_succ_ho+bsc_o_succ_ho+cell_succ_ho)/sum(msc_o_ho_cmd+bsc_o_ho_cmd_assgn+bts_ho_assgn)),2) as HOSR
            	,ROUND(100*(sum(drop_tch_asscompl_to_rfch_rel+msc_call_drop_ho_wcdma_ran) / sum(tch_new_call_assign+bsc_i_tch_tch+msc_i_tch_tch+msc_ho_wcdma_ran_succ-bsc_o_tch_tch-msc_o_tch_tch-ifnull(ho_succ_wcdma_ran_cell,0))),2) as Drop_Call_Rate
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_ESTABLISHMENT_FAILED-DL_TBF_ESTABLISHMENT_FAILED-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)/ sum(ul_tbf_establ_started+dl_tbf_establ_started)),2) as TBF_SR
            	,ROUND(100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)),2) as TBF_DROP
            	,ROUND(100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)),2) As Cell_availibility_Ratio

            	,ROUND(sum(((dl_rlc_blocks_ack_mcs1)*22
            + (dl_rlc_blocks_ack_mcs2)*28
            + (dl_rlc_blocks_ack_mcs3)*37
            + (dl_rlc_blocks_ack_mcs4)*44
            + (dl_rlc_blocks_ack_mcs5)*56
            + (dl_rlc_blocks_ack_mcs6)*74
            + (dl_rlc_blocks_ack_mcs7)*56
            + (dl_rlc_blocks_ack_mcs8)*68
            + (dl_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_dl_cs1 - rlc_data_blocks_dl_unack) *20
            + (rlc_data_blocks_dl_cs2) *30
            + dl_rlc_blocks_ack_mcs11 *36
            + dl_rlc_blocks_ack_mcs12 * 50)*8/1000)  /
            sum((dl_rlc_blocks_ack_mcs1
            + dl_rlc_blocks_ack_mcs2
            + dl_rlc_blocks_ack_mcs3
            + dl_rlc_blocks_ack_mcs4
            + dl_rlc_blocks_ack_mcs5
            + dl_rlc_blocks_ack_mcs6)/50
            +(dl_rlc_blocks_ack_mcs7
            + dl_rlc_blocks_ack_mcs8
            + dl_rlc_blocks_ack_mcs9)/2/50
            +(rlc_data_blocks_dl_cs1
            - rlc_data_blocks_dl_unack
            + rlc_data_blocks_dl_cs2
            + retra_rlc_data_blocks_dl_cs1
            + retra_rlc_data_blocks_dl_cs2
            + dl_rlc_blocks_ack_mcs11
            + dl_rlc_blocks_ack_mcs12)/50
            ),2) as  `RLC_THP_DL`

            	,ROUND(sum(((ul_rlc_blocks_ack_mcs1)*22
            + (ul_rlc_blocks_ack_mcs2)*28
            + (ul_rlc_blocks_ack_mcs3)*37
            + (ul_rlc_blocks_ack_mcs4)*44
            + (ul_rlc_blocks_ack_mcs5)*56
            + (ul_rlc_blocks_ack_mcs6)*74
            + (ul_rlc_blocks_ack_mcs7)*56
            + (ul_rlc_blocks_ack_mcs8)*68
            + (ul_rlc_blocks_ack_mcs9)*74)*8/1000
            + ((rlc_data_blocks_ul_cs1 - rlc_data_blocks_ul_unack) *20
            +(rlc_data_blocks_ul_cs2) *30
            + ul_rlc_blocks_ack_mcs11 *36
            + ul_rlc_blocks_ack_mcs12 * 50)*8/1000)
            /
            sum((ul_rlc_blocks_ack_mcs1
            + ul_rlc_blocks_ack_mcs2
            + ul_rlc_blocks_ack_mcs3
            + ul_rlc_blocks_ack_mcs4
            + ul_rlc_blocks_ack_mcs5
            + ul_rlc_blocks_ack_mcs6)/50
            + (ul_rlc_blocks_ack_mcs7
            + ul_rlc_blocks_ack_mcs8
            + ul_rlc_blocks_ack_mcs9 )/2/50
            +(rlc_data_blocks_ul_cs1
            - rlc_data_blocks_ul_unack
            + rlc_data_blocks_ul_cs2
            + retra_data_blocks_ul_cs1
            + retra_data_blocks_ul_cs2
            + ul_rlc_blocks_ack_mcs11
            + ul_rlc_blocks_ack_mcs12)/50),2) as `RLC_THP_UL`

            	,ROUND(100*(sum(ifnull(sdcch_busy_att,0)-ifnull(tch_seiz_due_sdcch_con,0))/sum(sdcch_seiz_att)),2)  as `S_CONG`
            	,ROUND(100*(sum((ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))-(ifnull(succ_tch_seiz_call_attempt,0)-ifnull(tch_seiz_due_sdcch_con,0))) / sum(ifnull(tch_requests_call_attempt,0)-ifnull(tch_seiz_att_due_sdcch_con,0))),2) AS `T_CONG`

              ,ROUND(100*(sum(sdcch_assign)/sum(sdcch_req)),2) as `SD_SUC`
              ,ROUND(100*sum(MS_TCH_SUCC_SEIZ_ASSIGN_CMPLT)/sum(TCH_NORM_SEIZ),2) as `T_AS_SUC`

              ,COUNT(*) AS `numcel`


              ,(sum(ifnull(rlc_data_blocks_ul_cs1,0))*20+sum(ifnull(rlc_data_blocks_ul_cs2,0))*30+(sum(ifnull(ul_rlc_block_cs_3,0))*36+sum(ifnull(ul_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_UL_trf_212c
              ,(sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024 GPRS_TRAFFIC_DL_trf_213c
              ,(sum(ifnull(ul_rlc_block_mcs_1,0))*22+sum(ifnull(ul_rlc_block_mcs_2,0))*28+sum(ifnull(ul_rlc_block_mcs_3,0))*37+sum(ifnull(ul_rlc_block_mcs_4,0))*44+sum(ifnull(ul_rlc_block_mcs_5,0))*56+sum(ifnull(ul_rlc_block_mcs_6,0))*74+sum(ifnull(ul_rlc_block_mcs_7,0))*112+sum(ifnull(ul_rlc_block_mcs_8,0))*136+sum(ifnull(ul_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_UL_trf_214a
              ,(sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024 EDGE_TRAFFIC_DL_trf_215a

              ,sum(a.tch_abis_fail_call) as tch_abis_fail_call
              ,sum(a.tch_radio_fail) as tch_radio_fail
              ,sum(a.tch_a_if_fail_call) as tch_a_if_fail_call
              ,sum(a.tch_tr_fail) as tch_tr_fail
              ,sum(a.tch_bcsu_reset) as tch_bcsu_reset
              ,sum(a.tch_netw_act) as tch_netw_act
              ,sum(a.tch_lapd_fail) as tch_lapd_fail
              ,sum(a.tch_bts_fail) as tch_bts_fail
              ,sum(a.tch_act_fail_call)as tch_act_fail_call
              ,sum(a.tch_rf_old_ho) as tch_rf_old_ho
              ,sum(a.tch_abis_fail_old) as tch_abis_fail_old
              ,sum(a.tch_a_if_fail_old) as tch_a_if_fail_old
              ,sum(a.tch_tr_fail_old) as tch_tr_fail_old

              ,sum(a.sdcch_radio_fail) as sdcch_radio_fail
              ,sum(a.sdcch_a_if_fail_call) as sdcch_a_if_fail_call
              ,sum(a.sdcch_abis_fail_call) as sdcch_abis_fail_call
              ,sum(a.sdcch_bcsu_reset) as sdcch_bcsu_reset
              ,sum(a.sdcch_netw_act) as sdcch_netw_act
              ,sum(a.sdcch_bts_fail) as sdcch_bts_fail
              ,sum(a.sdcch_lu_attempt_fail) as sdcch_lu_attempt_fail
              ,sum(a.t3101_expired) as t3101_expired
              ,sum(a.sdcch_a_if_fail_old) as sdcch_a_if_fail_old
              ,sum(a.sdcch_abis_fail_old) as sdcch_abis_fail_old
              ,sum(a.sdcch_rf_old_ho) as sdcch_rf_old_ho


            FROM isat_report.x_dashboard_2g_bh a
             JOIN isat_report.local_profile_2g b
            ON a.BSC_ID = b.bscid and a.BCF_ID = b.bcfid and a.BTS_ID = b.btsid
            where b.SnapshotDecember2018 = 1
            GROUP BY
            	a.xDate,b.AREA
            )"""
    elif Request == "3Gdashboard_bh" :
        sqlscript_query = """(
            SELECT
              	a.xDate
            	,'All' AS `Aggregate`
            	,'Network' AS `Level`
            	,'All' AS `Band`

              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g_bh a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            GROUP BY
            	a.xDate
            )

            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'CatapultPO1' AS `Aggregate`
            	,'Network' AS `Level`
            	,'All' AS `Band`

              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g_bh a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            where b.CatapultPO1 = 1
            GROUP BY
            	a.xDate
            )


            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'CatapultPO1B' AS `Aggregate`
            	,'Network' AS `Level`
            	,'All' AS `Band`

              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g_bh a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            where b.CatapultPO1B = 1
            GROUP BY
            	a.xDate
            )

            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'4GOverlayPack3' AS `Aggregate`
            	,'Network' AS `Level`
            	,'All' AS `Band`

              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g_bh a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            where b.4GOverlayPack3 = 1
            GROUP BY
            	a.xDate
            )

            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'4GOverlayPack4' AS `Aggregate`
            	,'Network' AS `Level`
            	,'All' AS `Band`

              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g_bh a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            where b.4GOverlayPack4 = 1
            GROUP BY
            	a.xDate
            )

            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'SnapshotDecember2018' AS `Aggregate`
            	,'Network' AS `Level`
            	,'All' AS `Band`

              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g_bh a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            where b.SnapshotDecember2018 = 1
            GROUP BY
            	a.xDate
            )


            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'All' AS `Aggregate`
            	,b.REGION AS `Level`
            	,'All' AS `Band`

              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g_bh a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            GROUP BY
            	a.xDate, b.REGION
            )

            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'All' AS `Aggregate`
            	,b.REGION AS `Level`
            	,b.BAND AS `Band`

              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g_bh a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            GROUP BY
            	a.xDate, b.REGION,b.BAND
            )

            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'All' AS `Aggregate`
            	,'Network' AS `Level`
            	,b.Band AS `Band`

              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g_bh a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            GROUP BY
            	a.xDate,b.Band
            )


            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'CatapultPO1' AS `Aggregate`
            	,b.REGION AS `Level`
            	,b.Band AS `Band`

              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g_bh a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            where b.CatapultPO1 = 1
            GROUP BY
            	a.xDate,b.REGION,b.Band
            )


            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'CatapultPO1B' AS `Aggregate`
            	,b.REGION As`Level`
            	,b.Band AS `Band`

              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g_bh a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            where b.CatapultPO1B = 1
            GROUP BY
            	a.xDate,b.REGION,b.Band
            )

            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'4GOverlayPack3' AS `Aggregate`
            	,b.REGION As`Level`
            	,b.Band AS `Band`

              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g_bh a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            where b.4GOverlayPack3 = 1
            GROUP BY
            	a.xDate,b.REGION,b.Band
            )

            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'4GOverlayPack4' AS `Aggregate`
            	,b.REGION As`Level`
            	,b.Band AS `Band`


              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g_bh a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            where b.4GOverlayPack4 = 1
            GROUP BY
            	a.xDate,b.REGION,b.Band
            )

            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'SnapshotDecember2018' AS `Aggregate`
            	,b.REGION As`Level`
            	,b.Band AS `Band`


              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g_bh a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            where b.SnapshotDecember2018 = 1
            GROUP BY
            	a.xDate,b.REGION,b.Band
            )


            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'CatapultPO1' AS `Aggregate`
            	,b.REGION AS `Level`
            	,'All' AS `Band`

              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g_bh a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            where b.CatapultPO1 = 1
            GROUP BY
            	a.xDate,b.REGION
            )


            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'CatapultPO1B' AS `Aggregate`
            	,b.REGION As`Level`
            	,'All' AS `Band`

              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g_bh a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            where b.CatapultPO1B = 1
            GROUP BY
            	a.xDate,b.REGION
            )

            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'4GOverlayPack3' AS `Aggregate`
            	,b.REGION As`Level`
            	,'All' AS `Band`

              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g_bh a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            where b.4GOverlayPack3 = 1
            GROUP BY
            	a.xDate,b.REGION
            )

            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'4GOverlayPack4' AS `Aggregate`
            	,b.REGION As`Level`
            	,'All' AS `Band`


              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
              inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g_bh a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            where b.4GOverlayPack4 = 1
            GROUP BY
            	a.xDate,b.REGION
            )

            UNION

            /* Network All */
            (
            SELECT
              	a.xDate
            	,'SnapshotDecember2018' AS `Aggregate`
            	,b.REGION As`Level`
            	,'All' AS `Band`


              ,COUNT(*) AS `Numcel`
              ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'
              ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
              + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

              ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
              +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
              +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

              ,round(100*if(sum(moc_conv_call_atts+mtc_conv_call_atts+emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV
              -RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL)=0, 0,
              sum(moc_conv_call_atts-moc_conv_call_fails+mtc_conv_call_atts-mtc_conv_call_fails+emergency_call_atts-emergency_call_fails
              -RRC_ACC_REL_EMERGENCY-RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV)/sum(moc_conv_call_atts+mtc_conv_call_atts
              +emergency_call_atts-RRC_ATT_REP_MO_CONV-RRC_ATT_REP_MT_CONV-RRC_ATT_REP_EMERGENCY-RRC_ACC_REL_EMERGENCY
              -RRC_ACC_REL_MO_CONV-RRC_ACC_REL_MT_CONV-RRC_CONN_STP_REJ_EMERG_CALL))
              *if(sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)=0, NULL,sum(rab_acc_comp_cs_voice+rab_acc_comp_cs_conv)
              /sum(rab_stp_att_cs_voice+rab_stp_att_cs_conv)),2) as 'CSSR CS'

              ,round(if(sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign - rrc_acc_rel_interactive
              - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background
              - rrc_acc_rel_mt_high_pr_sign)=0,NULL, (100*sum(moc_inter_call_atts - moc_inter_call_fails + moc_backg_call_atts - moc_backg_call_fails
              + mtc_inter_call_atts - mtc_inter_call_fails + mtc_backg_call_atts - mtc_backg_call_fails
              + moc_high_prior_sign_atts - moc_high_prior_sign_fails + mtc_high_prior_sign_atts
              - mtc_high_prior_sign_fails - rrc_acc_rel_interactive - rrc_acc_rel_mo_background
              - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)
              / sum(moc_inter_call_atts + moc_backg_call_atts + moc_high_prior_sign_atts + mtc_inter_call_atts + mtc_backg_call_atts
              + mtc_high_prior_sign_atts - rrc_att_rep_interactive - rrc_att_rep_mo_interactive - rrc_att_rep_mo_high_pr_sign
              - rrc_att_rep_mo_background - rrc_att_rep_mt_background - rrc_att_rep_mt_high_pr_sign
              - rrc_acc_rel_interactive - rrc_acc_rel_mo_background - rrc_acc_rel_mo_high_pr_sign - rrc_acc_rel_mo_interactive
              - rrc_acc_rel_mt_background - rrc_acc_rel_mt_high_pr_sign)))* if(sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)=0,0,
              sum(rab_acc_comp_ps_inter + rab_acc_comp_ps_backg) / sum(rab_stp_att_ps_inter + rab_stp_att_ps_backg)),2) as 'CSSR PS'

              ,round(100*if(sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp
              +RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO
              +rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc
              +RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio
              +rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)=0, NULL,
              sum(rab_act_rel_cs_voice_p_emp+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio+rab_act_fail_cs_voice_bts
              +rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS
              +rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc+rab_act_fail_cs_conv_iur
              +RAB_ACT_FAIL_CS_CONV_UE+rab_act_rel_cs_conv_p_emp+RAB_ACT_FAIL_CS_CONV_TRANS)
              /sum(rab_act_comp_cs_voice+rab_act_rel_cs_voice_srnc+rab_act_rel_cs_voice_p_emp+RAB_ACT_REL_CS_VOICE_HHO
              +RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+rab_act_fail_cs_voice_iu+rab_act_fail_cs_voice_radio
              +rab_act_fail_cs_voice_bts+rab_act_fail_cs_voice_iur+rab_act_fail_cs_voice_rnc+RAB_ACT_FAIL_CS_VOICE_UE
              +RAB_ACT_FAIL_CS_VOICE_TRANS+rab_act_comp_cs_conv+rab_act_rel_cs_conv_srnc+RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO
              +rab_act_rel_cs_conv_p_emp+rab_act_fail_cs_conv_iu+rab_act_fail_cs_conv_radio+rab_act_fail_cs_conv_bts+rab_act_fail_cs_conv_rnc
              +rab_act_fail_cs_conv_iur+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS)),2) as 'CDR_CS'

              ,round(100*if(sum((PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
              +PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
              +PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
              +PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
              +PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE))=0,NULL,
              sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE
              +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE)
              /sum(PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR+PS_REL_RL_FAIL_HS_D_INT
              +PS_REL_RL_FAIL_HS_D_BGR+PS_REL_RL_FAIL_D_D_INT+PS_REL_RL_FAIL_D_D_BGR
              +PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR+PS_REL_OTH_FAIL_HS_D_INT
              +PS_REL_OTH_FAIL_HS_D_BGR+PS_REL_OTH_FAIL_D_D_INT+PS_REL_OTH_FAIL_D_D_BGR
              +PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_INT
              +PS_REL_NORM_HS_D_BGR+PS_REL_NORM_D_D_INT+PS_REL_NORM_D_D_BGR+PS_REL_RL_FAIL_HS_E_STRE
              +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_D_D_STRE+PS_REL_OTH_FAIL_HS_E_STRE
              +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_D_D_STRE
              +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_D_STRE+PS_REL_NORM_D_D_STRE)),2) as 'CDR PS'

              ,round(if( sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)=0,NULL,
              100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
              sum(cell_add_req_on_sho_for_rt + cell_repl_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
              + cell_add_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt)),2) as 'SHO'

              ,round(100*
              sum(succ_is_hho_ul_dch_q_rt+
              succ_is_hho_ue_trx_pwr_rt+
              succ_is_hho_dl_dpch_pwr_rt+
              succ_is_hho_cpich_rscp_rt+
              succ_is_hho_cpich_ecno_rt+
              succ_is_hho_im_ims_rt +
              succ_is_hho_emerg_call +
              succ_is_hho_lb_capa_dl_rt+
              succ_is_hho_lb_capa_ul_rt+
              succ_is_hho_lb_prx_tot_rt +
              succ_is_hho_lb_ptx_tot_rt +
              succ_is_hho_lb_res_lim_rt +
              succ_is_hho_lb_rsvr_sc_rt +
              succ_is_hho_sb_rt +
              succ_is_hho_wps_rt +
              succ_isho_cell_shutdown_rt +
              succ_isho_cell_block_rt)
              /
              sum(is_hho_att_ul_dch_q_rt+
              is_hho_att_ue_trx_pwr_rt+
              is_hho_att_dpch_pwr_rt+
              is_hho_att_cpich_rscp_rt+
              is_hho_att_cpich_ecno_rt+
              is_hho_att_im_ims_rt +
              is_hho_att_emerg_call +
              is_hho_att_lb_capa_dl_rt+
              is_hho_att_lb_capa_ul_rt+
              is_hho_att_lb_prx_tot_rt +
              is_hho_att_lb_ptx_tot_rt +
              is_hho_att_lb_res_lim_rt +
              is_hho_att_lb_rsvr_sc_rt +
              is_hho_att_sb_rt +
              is_hho_att_ul_dch_wps_rt+
              att_isho_cell_shutdown_rt +
              att_isho_cell_block_rt -
              is_hho_att_2nd_best_cell_rt -
              is_hho_att_3rd_best_cell_rt ),2)  as ISHO

              ,round(100 * SUM(succ_intra_intra_hho_att_rt +
              succ_intra_inter_hho_att_rt +
              succ_inter_hho_att_rt +
              succ_intra_intra_hho_att_nrt +
              succ_intra_inter_hho_att_nrt +
              succ_inter_hho_att_nrt)
              /
              SUM(intra_intra_hho_att_rt +
              intra_inter_hho_att_rt +
              inter_hho_att_rt +
              intra_intra_hho_att_nrt +
              intra_inter_hho_att_nrt +
                  inter_hho_att_nrt),2)  as IFHO

              ,round(100*if(sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)= 0, 0, sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR)/sum(ALLO_HS_DSCH_FLOW_INT+ALLO_HS_DSCH_FLOW_BGR+REJ_HS_DSCH_RET_INT+REJ_HS_DSCH_RET_BGR+SETUP_FAIL_RNC_HS_DSCH_INT+SETUP_FAIL_BTS_HS_DSCH_INT+SETUP_FAIL_IUB_HS_TOTAL_INT+SETUP_FAIL_RNC_HS_DSCH_BGR+SETUP_FAIL_BTS_HS_DSCH_BGR+SETUP_FAIL_IUB_HS_TOTAL_BGR+SETUP_FAIL_UE_HS_DSCH_INT+SETUP_FAIL_UE_HS_DSCH_BGR+DCH_SEL_MAX_HSDPA_USERS_INT+DCH_SEL_MAX_HSDPA_USERS_BGR)),2) as 'HSDPA_Accessibility'

              ,round(100*if(sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)= 0, 0, sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR)/sum(ALLO_SUCCESS_EDCH_INT+ALLO_SUCCESS_EDCH_BGR+EDCH_ALLO_CANC_NA_AS_BGR+EDCH_ALLO_CANC_NA_AS_INT+UL_DCH_SEL_MAX_HSUPA_USR_BGR+UL_DCH_SEL_MAX_HSUPA_USR_INT+UL_DCH_SEL_BTS_HW_INT+UL_DCH_SEL_BTS_HW_BGR+SETUP_FAIL_EDCH_BTS_BGR+SETUP_FAIL_EDCH_BTS_INT+SETUP_FAIL_EDCH_OTHER_BGR+SETUP_FAIL_EDCH_OTHER_INT+SETUP_FAIL_EDCH_TRANS_BGR+SETUP_FAIL_EDCH_TRANS_INT+SETUP_FAIL_EDCH_UE_BGR+SETUP_FAIL_EDCH_UE_INT)),2) as 'HSUPA_Access_3G'

              ,round(100*if(sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)= 0, 0, sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR)/sum(REL_ALLO_NORM_HS_DSCH_INT+REL_ALLO_NORM_HS_DSCH_BGR+REL_ALLO_OTH_FAIL_HSDSCH_INT+REL_ALLO_OTH_FAIL_HSDSCH_BGR+REL_ALLO_RL_FAIL_HS_DSCH_INT+REL_ALLO_RL_FAIL_HS_DSCH_BGR)),2) as 'HSDPA_Retainability'

              ,round(100*if(sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)= 0, 0, sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR)/sum(REL_EDCH_NORM_INT+REL_EDCH_NORM_BGR+REL_EDCH_HSDSCH_SCC_INT+REL_EDCH_HSDSCH_SCC_BGR+REL_EDCH_RL_FAIL_INT+REL_EDCH_RL_FAIL_BGR+REL_EDCH_OTHER_FAIL_INT+REL_EDCH_OTHER_FAIL_BGR)),2) as 'HSUPA_Retain_3G'

              ,round(SUM(SUM_HSDPA_USERS_IN_CELL)/SUM(DENOM_HSDPA_USERS_PER_CELL),2) AS HSDPA_USER_AVG
              ,round(SUM(SUM_HSUPA_USERS_IN_CELL)/SUM(DENOM_HSUPA_USERS_PER_CELL),2) AS HSUPA_USER_AVG
              ,round(SUM(((RECEIVED_HS_MACD_BITS- DISCARDED_HS_MACD_BITS+(MC_HSDPA_ORIG_DATA_PRI+MC_HSDPA_ORIG_DATA_SEC)*8 )* 500))/SUM((HSDPA_BUFF_WITH_DATA_PER_TTI)),2) as 'HSDPA users_throughput'
              ,round(SUM((MACE_PDU_DATA_2MS_TTI+ MACE_PDU_DATA_10MS_TTI)*8) / SUM(((MACE_PDUS_2MS_TTI/500)+ (MACE_PDUS_10MS_TTI/100))),2) AS `HSUPA users_throughput`

            FROM isat_report.x_dashboard_3g_bh a
            JOIN isat_report.local_profile_3g b
            ON a.RNC_ID = b.RNC_ID and a.WBTS_ID = b.WBTS_ID and a.WCEL_ID = b.CELL_ID
            where b.SnapshotDecember2018 = 1
            GROUP BY
            	a.xDate,b.REGION
            )"""
    elif Request == "4Gdashboard_bh" :
        sqlscript_query = """
                        (
                SELECT
                	a.xDate
                	,'All' AS `Aggregate`
                	,'Network' AS `Level`
                	,'All' AS `Band`
                  ,COUNT(*) AS `NumCel`

                  ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
                  -- CSSR --
                  ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

                  -- ERAB Drop Rate --
                  ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

                  -- HOSR --
                  ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
                  ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                    -- Payload --
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
                  ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

                  -- LTE END USER THROUGHPUT DL --
                  ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

                  -- LTE END USER THROUGHPUT UL --
                  ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

                  -- LTE USER --
                  ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
                  ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

                FROM isat_report.x_dashboard_4g_bh a
                JOIN isat_report.local_profile_4g b
                ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
                GROUP BY
                	a.xDate
                )

                UNION

                (
                SELECT
                	a.xDate
                	,'CatapultPO1' AS `Aggregate`
                	,'Network' AS `Level`
                	,'All' AS `Band`
                  ,COUNT(*) AS `NumCel`

                  ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
                  -- CSSR --
                  ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

                  -- ERAB Drop Rate --
                  ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

                  -- HOSR --
                  ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
                  ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                    -- Payload --
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
                  ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

                  -- LTE END USER THROUGHPUT DL --
                  ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

                  -- LTE END USER THROUGHPUT UL --
                  ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

                  -- LTE USER --
                  ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
                  ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

                FROM isat_report.x_dashboard_4g_bh a
                JOIN isat_report.local_profile_4g b
                ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
                where b.CatapultPO1 = 1
                GROUP BY
                	a.xDate
                )

                UNION

                (
                SELECT
                	a.xDate
                	,'CatapultPO1B' AS `Aggregate`
                	,'Network' AS `Level`
                	,'All' AS `Band`
                  ,COUNT(*) AS `NumCel`

                  ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
                  -- CSSR --
                  ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

                  -- ERAB Drop Rate --
                  ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

                  -- HOSR --
                  ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
                  ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                    -- Payload --
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
                  ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

                  -- LTE END USER THROUGHPUT DL --
                  ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

                  -- LTE END USER THROUGHPUT UL --
                  ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

                  -- LTE USER --
                  ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
                  ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

                FROM isat_report.x_dashboard_4g_bh a
                JOIN isat_report.local_profile_4g b
                ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
                where b.CatapultPO1B = 1
                GROUP BY
                	a.xDate
                )

                UNION

                (
                SELECT
                	a.xDate
                	,'4GOverlayPack3' AS `Aggregate`
                	,'Network' AS `Level`
                	,'All' AS `Band`
                  ,COUNT(*) AS `NumCel`

                  ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
                  -- CSSR --
                  ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

                  -- ERAB Drop Rate --
                  ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

                  -- HOSR --
                  ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
                  ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                    -- Payload --
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
                  ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

                  -- LTE END USER THROUGHPUT DL --
                  ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

                  -- LTE END USER THROUGHPUT UL --
                  ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

                  -- LTE USER --
                  ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
                  ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

                FROM isat_report.x_dashboard_4g_bh a
                JOIN isat_report.local_profile_4g b
                ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
                where b.4GOverlayPack3 = 1
                GROUP BY
                	a.xDate
                )

                UNION

                (
                SELECT
                	a.xDate
                	,'4GOverlayPack4' AS `Aggregate`
                	,'Network' AS `Level`
                	,'All' AS `Band`
                  ,COUNT(*) AS `NumCel`

                  ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
                  -- CSSR --
                  ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

                  -- ERAB Drop Rate --
                  ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

                  -- HOSR --
                  ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
                  ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                    -- Payload --
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
                  ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

                  -- LTE END USER THROUGHPUT DL --
                  ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

                  -- LTE END USER THROUGHPUT UL --
                  ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

                  -- LTE USER --
                  ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
                  ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

                FROM isat_report.x_dashboard_4g_bh a
                JOIN isat_report.local_profile_4g b
                ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
                where b.4GOverlayPack4 = 1
                GROUP BY
                	a.xDate
                )

                UNION

                (
                SELECT
                	a.xDate
                	,'SnapshotDecember2018' AS `Aggregate`
                	,'Network' AS `Level`
                	,'All' AS `Band`
                  ,COUNT(*) AS `NumCel`

                  ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
                  -- CSSR --
                  ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

                  -- ERAB Drop Rate --
                  ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

                  -- HOSR --
                  ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
                  ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                    -- Payload --
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
                  ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

                  -- LTE END USER THROUGHPUT DL --
                  ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

                  -- LTE END USER THROUGHPUT UL --
                  ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

                  -- LTE USER --
                  ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
                  ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

                FROM isat_report.x_dashboard_4g_bh a
                JOIN isat_report.local_profile_4g b
                ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
                where b.SnapshotDecember2018 = 1
                GROUP BY
                	a.xDate
                )

                UNION

                (
                SELECT
                	a.xDate
                	,'CatapultPO1' AS `Aggregate`
                	,b.REGION AS `Level`
                	,b.BAND AS `Band`
                  ,COUNT(*) AS `NumCel`

                  ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
                  -- CSSR --
                  ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

                  -- ERAB Drop Rate --
                  ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

                  -- HOSR --
                  ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
                  ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                    -- Payload --
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
                  ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

                  -- LTE END USER THROUGHPUT DL --
                  ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

                  -- LTE END USER THROUGHPUT UL --
                  ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

                  -- LTE USER --
                  ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
                  ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

                FROM isat_report.x_dashboard_4g_bh a
                JOIN isat_report.local_profile_4g b
                ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
                where b.CatapultPO1 = 1
                GROUP BY
                	a.xDate,b.REGION,b.BAND
                )

                UNION

                (
                SELECT
                	a.xDate
                	,'CatapultPO1B' AS `Aggregate`
                	,b.REGION AS `Level`
                	,b.BAND AS `Band`
                  ,COUNT(*) AS `NumCel`

                  ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
                  -- CSSR --
                  ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

                  -- ERAB Drop Rate --
                  ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

                  -- HOSR --
                  ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
                  ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                    -- Payload --
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
                  ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

                  -- LTE END USER THROUGHPUT DL --
                  ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

                  -- LTE END USER THROUGHPUT UL --
                  ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

                  -- LTE USER --
                  ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
                  ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

                FROM isat_report.x_dashboard_4g_bh a
                JOIN isat_report.local_profile_4g b
                ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
                where b.CatapultPO1B = 1
                GROUP BY
                	a.xDate,b.REGION,b.BAND
                )

                UNION

                (
                SELECT
                	a.xDate
                	,'4GOverlayPack3' AS `Aggregate`
                	,b.REGION AS `Level`
                	,b.BAND AS `Band`
                  ,COUNT(*) AS `NumCel`

                  ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
                  -- CSSR --
                  ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

                  -- ERAB Drop Rate --
                  ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

                  -- HOSR --
                  ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
                  ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                    -- Payload --
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
                  ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

                  -- LTE END USER THROUGHPUT DL --
                  ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

                  -- LTE END USER THROUGHPUT UL --
                  ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

                  -- LTE USER --
                  ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
                  ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

                FROM isat_report.x_dashboard_4g_bh a
                JOIN isat_report.local_profile_4g b
                ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
                where b.4GOverlayPack3 = 1
                GROUP BY
                	a.xDate,b.REGION,b.BAND
                )

                UNION

                (
                SELECT
                	a.xDate
                	,'4GOverlayPack4' AS `Aggregate`
                	,b.REGION AS `Level`
                	,b.BAND AS `Band`
                  ,COUNT(*) AS `NumCel`

                  ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
                  -- CSSR --
                  ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

                  -- ERAB Drop Rate --
                  ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

                  -- HOSR --
                  ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
                  ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                    -- Payload --
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
                  ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

                  -- LTE END USER THROUGHPUT DL --
                  ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

                  -- LTE END USER THROUGHPUT UL --
                  ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

                  -- LTE USER --
                  ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
                  ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

                FROM isat_report.x_dashboard_4g_bh a
                JOIN isat_report.local_profile_4g b
                ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
                where b.4GOverlayPack4 = 1
                GROUP BY
                	a.xDate,b.REGION,b.BAND
                )

                UNION

                (
                SELECT
                	a.xDate
                	,'SnapshotDecember2018' AS `Aggregate`
                	,b.REGION AS `Level`
                	,b.BAND AS `Band`
                  ,COUNT(*) AS `NumCel`

                  ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
                  -- CSSR --
                  ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

                  -- ERAB Drop Rate --
                  ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

                  -- HOSR --
                  ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
                  ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                    -- Payload --
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
                  ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

                  -- LTE END USER THROUGHPUT DL --
                  ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

                  -- LTE END USER THROUGHPUT UL --
                  ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

                  -- LTE USER --
                  ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
                  ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

                FROM isat_report.x_dashboard_4g_bh a
                JOIN isat_report.local_profile_4g b
                ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
                where b.SnapshotDecember2018 = 1
                GROUP BY
                	a.xDate,b.REGION,b.BAND
                )


                UNION

                (
                SELECT
                	a.xDate
                	,'CatapultPO1' AS `Aggregate`
                	,b.REGION AS `Level`
                	,'All' AS `Band`
                  ,COUNT(*) AS `NumCel`

                  ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
                  -- CSSR --
                  ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

                  -- ERAB Drop Rate --
                  ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

                  -- HOSR --
                  ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
                  ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                    -- Payload --
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
                  ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

                  -- LTE END USER THROUGHPUT DL --
                  ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

                  -- LTE END USER THROUGHPUT UL --
                  ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

                  -- LTE USER --
                  ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
                  ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

                FROM isat_report.x_dashboard_4g_bh a
                JOIN isat_report.local_profile_4g b
                ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
                where b.CatapultPO1 = 1
                GROUP BY
                	a.xDate,b.REGION
                )

                UNION

                (
                SELECT
                	a.xDate
                	,'CatapultPO1B' AS `Aggregate`
                	,b.REGION AS `Level`
                	,'All' AS `Band`
                  ,COUNT(*) AS `NumCel`

                  ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
                  -- CSSR --
                  ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

                  -- ERAB Drop Rate --
                  ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

                  -- HOSR --
                  ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
                  ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                    -- Payload --
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
                  ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

                  -- LTE END USER THROUGHPUT DL --
                  ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

                  -- LTE END USER THROUGHPUT UL --
                  ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

                  -- LTE USER --
                  ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
                  ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

                FROM isat_report.x_dashboard_4g_bh a
                JOIN isat_report.local_profile_4g b
                ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
                where b.CatapultPO1B = 1
                GROUP BY
                	a.xDate,b.REGION
                )

                UNION

                (
                SELECT
                	a.xDate
                	,'4GOverlayPack3' AS `Aggregate`
                	,b.REGION AS `Level`
                	,'All' AS `Band`
                  ,COUNT(*) AS `NumCel`

                  ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
                  -- CSSR --
                  ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

                  -- ERAB Drop Rate --
                  ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

                  -- HOSR --
                  ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
                  ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                    -- Payload --
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
                  ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

                  -- LTE END USER THROUGHPUT DL --
                  ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

                  -- LTE END USER THROUGHPUT UL --
                  ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

                  -- LTE USER --
                  ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
                  ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

                FROM isat_report.x_dashboard_4g_bh a
                JOIN isat_report.local_profile_4g b
                ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
                where b.4GOverlayPack3 = 1
                GROUP BY
                	a.xDate,b.REGION
                )

                UNION

                (
                SELECT
                	a.xDate
                	,'4GOverlayPack4' AS `Aggregate`
                	,b.REGION AS `Level`
                	,'All' AS `Band`
                  ,COUNT(*) AS `NumCel`

                  ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
                  -- CSSR --
                  ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

                  -- ERAB Drop Rate --
                  ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

                  -- HOSR --
                  ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
                  ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                    -- Payload --
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
                  ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

                  -- LTE END USER THROUGHPUT DL --
                  ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

                  -- LTE END USER THROUGHPUT UL --
                  ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

                  -- LTE USER --
                  ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
                  ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

                FROM isat_report.x_dashboard_4g_bh a
                JOIN isat_report.local_profile_4g b
                ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
                where b.4GOverlayPack4 = 1
                GROUP BY
                	a.xDate,b.REGION
                )

                UNION

                (
                SELECT
                	a.xDate
                	,'SnapshotDecember2018' AS `Aggregate`
                	,b.REGION AS `Level`
                	,'All' AS `Band`
                  ,COUNT(*) AS `NumCel`

                  ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
                  -- CSSR --
                  ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

                  -- ERAB Drop Rate --
                  ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

                  -- HOSR --
                  ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
                  ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                    -- Payload --
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
                  ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

                  -- LTE END USER THROUGHPUT DL --
                  ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

                  -- LTE END USER THROUGHPUT UL --
                  ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

                  -- LTE USER --
                  ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
                  ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

                FROM isat_report.x_dashboard_4g_bh a
                JOIN isat_report.local_profile_4g b
                ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
                where b.SnapshotDecember2018 = 1
                GROUP BY
                	a.xDate,b.REGION
                )



                UNION

                (
                SELECT
                	a.xDate
                	,'All' AS `Aggregate`
                	,b.REGION AS `Level`
                	,'All' AS `Band`
                  ,COUNT(*) AS `NumCel`

                  ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
                  -- CSSR --
                  ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

                  -- ERAB Drop Rate --
                  ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

                  -- HOSR --
                  ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
                  ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                    -- Payload --
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
                  ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

                  -- LTE END USER THROUGHPUT DL --
                  ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

                  -- LTE END USER THROUGHPUT UL --
                  ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

                  -- LTE USER --
                  ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
                  ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

                FROM isat_report.x_dashboard_4g_bh a
                JOIN isat_report.local_profile_4g b
                ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
                GROUP BY
                	a.xDate,b.REGION
                )

                UNION

                (
                SELECT
                	a.xDate
                	,'All' AS `Aggregate`
                	,b.REGION AS `Level`
                	,b.BAND AS `Band`
                  ,COUNT(*) AS `NumCel`

                  ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
                  -- CSSR --
                  ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

                  -- ERAB Drop Rate --
                  ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

                  -- HOSR --
                  ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
                  ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                    -- Payload --
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
                  ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

                  -- LTE END USER THROUGHPUT DL --
                  ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

                  -- LTE END USER THROUGHPUT UL --
                  ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

                  -- LTE USER --
                  ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
                  ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

                FROM isat_report.x_dashboard_4g_bh a
                JOIN isat_report.local_profile_4g b
                ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
                GROUP BY
                	a.xDate,b.REGION,b.BAND
                )

                UNION

                (
                SELECT
                	a.xDate
                	,'All' AS `Aggregate`
                	,'Network' AS `Level`
                	,b.BAND AS `Band`
                  ,COUNT(*) AS `NumCel`

                  ,round(100*sum(SAMPLES_CELL_AVAIL)/(sum(DENOM_CELL_AVAIL)-sum(SAMPLES_CELL_PLAN_UNAVAIL)),2) AS `availability`
                  -- CSSR --
                  ,round(100*sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg)*sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue)*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)),2) as `CSSR`

                  -- ERAB Drop Rate --
                  ,round(100*if(sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))=0,0,sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0))),2) as `E-RAB Drop`

                  -- HOSR --
                  ,round(100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)),2) AS `INTRAFREQ HOSR`
                  ,round(100*sum(isys_ho_succ)/sum(isys_ho_att),2) AS `ISHO HOSR`

                    -- Payload --
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000,2) as `DL_Payload_LTE_5212A`
                  ,round(sum(PDCP_SDU_VOL_UL)/1000000,2) as `UL_Payload_LTE_5213A`
                  ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,2) as `Total_Payload`

                  -- LTE END USER THROUGHPUT DL --
                  ,round(sum(IP_TPUT_VOL_DL_QCI_5+IP_TPUT_VOL_DL_QCI_6+IP_TPUT_VOL_DL_QCI_7+IP_TPUT_VOL_DL_QCI_8+IP_TPUT_VOL_DL_QCI_9)/sum(IP_TPUT_TIME_DL_QCI_5+IP_TPUT_TIME_DL_QCI_6+IP_TPUT_TIME_DL_QCI_7+IP_TPUT_TIME_DL_QCI_8+IP_TPUT_TIME_DL_QCI_9),2) AS `User_Throughput_DL`

                  -- LTE END USER THROUGHPUT UL --
                  ,round(sum(IP_TPUT_VOL_UL_QCI_5+IP_TPUT_VOL_UL_QCI_6+IP_TPUT_VOL_UL_QCI_7+IP_TPUT_VOL_UL_QCI_8+IP_TPUT_VOL_UL_QCI_9)/sum(IP_TPUT_TIME_UL_QCI_5+IP_TPUT_TIME_UL_QCI_6+IP_TPUT_TIME_UL_QCI_7+IP_TPUT_TIME_UL_QCI_8+IP_TPUT_TIME_UL_QCI_9),2) AS `User_Throughput_UL`

                  -- LTE USER --
                  ,sum(a.CELL_LOAD_ACTIVE_UE_AVG)  as `Average_Number_Connected_UE`
                  ,Sum(rrc_connected_ue_avg) as `avg_RRC_conn_users`

                FROM isat_report.x_dashboard_4g_bh a
                JOIN isat_report.local_profile_4g b
                ON a.MRBTS_ID = b.MRBTS_ID and a.LNBTS_ID = b.LNBTS_ID and a.LNCEL_ID = b.LNCEL_ID
                GROUP BY
                	a.xDate,b.BAND
                )"""
#================================
    elif Request == "2G_GPCheck" :
        sqlscript_query = """
                    select a.oss,a.xdate, a.name,a.BSC,a.BCF, a.BTS, b.trx, a.frequencyBandInUse
            , a.radioLinkTimeoutAmr
            , a.radioLinkTimeoutAmrHr
            , a.gsmPriority
            , c.SITE_ID
            from isat_cm.bts a
            Join isat_cm.trx b
            On a.oss = b.oss and  a.xdate = b.xdate and a.bsc = b.bsc and a.bcf = b.bcf and a.bts = b.bts
            join isat_adm.t_list_2g_profile c
            on a.bsc = c.bscid and a.bcf = c.bcfid and a.bts = c.btsid
            where a.xdate like '""" + nowdate.strftime("%Y-%m-%d") + """' and (a.name like '%XXX%' or a.name like '%XYX%')
            and (a.radioLinkTimeoutAmr < 11 or a. radioLinkTimeoutAmrHr < 11 or a.gsmPriority <> 0) """
    elif Request == "3G_GPCheck" :
        sqlscript_query = """select a.oss,a.xdate, a.name,a.RNC,a.WBTS,a.WCEL, b.IPNBId, a.PtxCellMax,a.MBLBStateTransEnabled
            , a.InitialBitRateDL
            , a.QqualMin
            , a.SmartLTELayeringEnabled
            , c.SITE_ID
            from isat_cm.wcel a Join isat_cm.wbts b On a.oss = b.oss and  a.xdate = b.xdate and a.rnc = b.rnc and a.wbts = b.wbts
            Join isat_adm.t_list_3g_profile c on a.rnc = c.rnc_id and a.wbts = c.wbts_id and a.WCEL = c.CELL_ID
            where a.xdate like '""" + nowdate.strftime("%Y-%m-%d") + """' and (a.name like '%XXX%' or a.name like '%XYX%')
            and (a.InitialBitRateDL <> 16 or  a.QqualMin <> -18 or a.SmartLTELayeringEnabled <> 8)"""
    elif Request == "4G_GPCheck" :
        sqlscript_query = """SELECT b.oss,b.xdate,b.name,b.mrbts,b.lnbts,b.lncel, b.pMax
                    , b.earfcnDL
                    , b.dlchbw
                    , b.cellreselprio
                    , b.SITE_ID

                    FROM (select a.oss,a.xdate, d.SITE_ID
                    from isat_cm.lncel a
                    Join isat_cm.lncel_fdd b
                    On a.oss = b.oss and a.xdate = b.xdate and a.mrbts = b.mrbts and a.lncel = b.lncel
                    Join isat_cm.sib c
                    On  a.oss = c.oss and a.xdate = c.xdate and a.mrbts = c.mrbts and a.lncel = c.lncel
                    Join isat_adm.t_list_4g_profile d
                    on a.mrbts = d.MRBTS_ID and a.lncel = d.LNCEL_ID
                    where a.xdate = '""" + nowdate.strftime("%Y-%m-%d") + """' and (a.name like '%XXX%' or a.name like '%XYX%')
                    and ((b.earfcnDL in ('474','476','500') and c.cellreselprio <> 5) or (b.earfcnDL = 1625  and c.cellreselprio <> 6) or (b.earfcnDL in ('3550','3676')   and c.cellreselprio <> 4))
                    GROUP BY a.oss,a.xdate,a.mrbts,a.lnbts,a.lncel ) a

                    JOIN
                    (select a.oss,a.xdate,a.name,a.mrbts,a.lnbts,a.lncel, a.pMax
                    , b.earfcnDL
                    , b.dlchbw
                    , c.cellreselprio
                    , d.SITE_ID
                    from isat_cm.lncel a
                    Join isat_cm.lncel_fdd b
                    On a.oss = b.oss and a.xdate = b.xdate and a.mrbts = b.mrbts and a.lncel = b.lncel
                    Join isat_cm.sib c
                    On  a.oss = c.oss and a.xdate = c.xdate and a.mrbts = c.mrbts and a.lncel = c.lncel
                    Join isat_adm.t_list_4g_profile d
                    on a.mrbts = d.MRBTS_ID and a.lncel = d.LNCEL_ID) b
                    ON a.oss=b.oss and a.xdate=b.xdate  AND  a.SITE_ID = b.SITE_ID"""

#================================
    elif Request == "4G_mycom" :
        sqlscript_query = """SELECT
                        a.xdate
                        ,b.SITE_ID
                        ,a.mrbts_id
                        ,a.LNCEL_ID
                        ,a.LNCELname
                        ,100*sum(SAMPLES_CELL_AVAIL)/sum(DENOM_CELL_AVAIL) as Cell_avail

                        ,round(100*(sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)+ ERAB_REL_ENB_INI_S1_GLOB_RESET + ERAB_REL_ENB_INI_S1_PART_RESET + ERAB_REL_S1_OUTAGE) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0)+ERAB_REL_SUCC_HO_UTRAN + ERAB_REL_SUCC_HO_GERAN + ERAB_REL_ENB_INI_S1_GLOB_RESET + ERAB_REL_MME_INI_S1_GLOB_RESET + ERAB_REL_ENB_INI_S1_PART_RESET + ERAB_REL_MME_INI_S1_PART_RESET + ERAB_REL_S1_OUTAGE)),2) as `E-RAB Drop`

                        ,100*((sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg+SIGN_CONN_ESTAB_ATT_OTHERS))*(sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue))*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9))) as `CSSR Success Rate`

                        ,100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT)) as Intrafreq_ho_sr

                        ,sum(f.PDCP_SDU_VOL_DL/1000000) + Sum(f.PDCP_SDU_VOL_UL/1000000) as Total_Payload


                        ,(((sum(-(120.0)*RSSI_PUCCH_LEVEL_01)-(RSSI_PUCCH_LEVEL_02*119.0)-(RSSI_PUCCH_LEVEL_03*117.0)-(RSSI_PUCCH_LEVEL_04*115.0)-(RSSI_PUCCH_LEVEL_05*113.0)-(RSSI_PUCCH_LEVEL_06*111.0)-(RSSI_PUCCH_LEVEL_07*109.0)-(RSSI_PUCCH_LEVEL_08*107.0)-(RSSI_PUCCH_LEVEL_09*105.0)-(RSSI_PUCCH_LEVEL_10*103.0)-(RSSI_PUCCH_LEVEL_11*101.0)-(RSSI_PUCCH_LEVEL_12*99.0)-(RSSI_PUCCH_LEVEL_13*97.0)-(RSSI_PUCCH_LEVEL_14*95.0)-(RSSI_PUCCH_LEVEL_15*93.0)-(RSSI_PUCCH_LEVEL_16*91.0)-(RSSI_PUCCH_LEVEL_17*89.0)-(RSSI_PUCCH_LEVEL_18*87.0)-(RSSI_PUCCH_LEVEL_19*85.0)-(RSSI_PUCCH_LEVEL_20*83.0)-(RSSI_PUCCH_LEVEL_21*81.0)-(RSSI_PUCCH_LEVEL_22*80.0))/
                        (sum(RSSI_PUCCH_LEVEL_01+RSSI_PUCCH_LEVEL_02+RSSI_PUCCH_LEVEL_03+RSSI_PUCCH_LEVEL_04+RSSI_PUCCH_LEVEL_05+RSSI_PUCCH_LEVEL_06+RSSI_PUCCH_LEVEL_07+RSSI_PUCCH_LEVEL_08+RSSI_PUCCH_LEVEL_09+RSSI_PUCCH_LEVEL_10+RSSI_PUCCH_LEVEL_11+RSSI_PUCCH_LEVEL_12+RSSI_PUCCH_LEVEL_13+RSSI_PUCCH_LEVEL_14+RSSI_PUCCH_LEVEL_15+RSSI_PUCCH_LEVEL_16+RSSI_PUCCH_LEVEL_17+RSSI_PUCCH_LEVEL_18+RSSI_PUCCH_LEVEL_19+RSSI_PUCCH_LEVEL_20+RSSI_PUCCH_LEVEL_21+RSSI_PUCCH_LEVEL_22)))+

                        ((sum(-(120.0)*RSSI_PUSCH_LEVEL_01)-(RSSI_PUSCH_LEVEL_02*119.0)-(RSSI_PUSCH_LEVEL_03*117.0)-(RSSI_PUSCH_LEVEL_04*115.0)-(RSSI_PUSCH_LEVEL_05*113.0)-(RSSI_PUSCH_LEVEL_06*111.0)-(RSSI_PUSCH_LEVEL_07*109.0)-(RSSI_PUSCH_LEVEL_08*107.0)-(RSSI_PUSCH_LEVEL_09*105.0)-(RSSI_PUSCH_LEVEL_10*103.0)-(RSSI_PUSCH_LEVEL_11*101.0)-(RSSI_PUSCH_LEVEL_12*99.0)-(RSSI_PUSCH_LEVEL_13*97.0)-(RSSI_PUSCH_LEVEL_14*95.0)-(RSSI_PUSCH_LEVEL_15*93.0)-(RSSI_PUSCH_LEVEL_16*91.0)-(RSSI_PUSCH_LEVEL_17*89.0)-(RSSI_PUSCH_LEVEL_18*87.0)-(RSSI_PUSCH_LEVEL_19*85.0)-(RSSI_PUSCH_LEVEL_20*83.0)-(RSSI_PUSCH_LEVEL_21*81.0)-(RSSI_PUSCH_LEVEL_22*80.0))/
                        (sum(RSSI_PUSCH_LEVEL_01+RSSI_PUSCH_LEVEL_02+RSSI_PUSCH_LEVEL_03+RSSI_PUSCH_LEVEL_04+RSSI_PUSCH_LEVEL_05+RSSI_PUSCH_LEVEL_06+RSSI_PUSCH_LEVEL_07+RSSI_PUSCH_LEVEL_08+RSSI_PUSCH_LEVEL_09+RSSI_PUSCH_LEVEL_10+RSSI_PUSCH_LEVEL_11+RSSI_PUSCH_LEVEL_12+RSSI_PUSCH_LEVEL_13+RSSI_PUSCH_LEVEL_14+RSSI_PUSCH_LEVEL_15+RSSI_PUSCH_LEVEL_16+RSSI_PUSCH_LEVEL_17+RSSI_PUSCH_LEVEL_18+RSSI_PUSCH_LEVEL_19+RSSI_PUSCH_LEVEL_20+RSSI_PUSCH_LEVEL_21+RSSI_PUSCH_LEVEL_22))))/2.0 as LTE_ULRSSI

                        ,if ((100*((sum(sign_conn_estab_comp) / sum(sign_conn_estab_att_mo_s + sign_conn_estab_att_mt + sign_conn_estab_att_mo_d + sign_conn_estab_att_del_tol + sign_conn_estab_att_hiprio +sign_conn_estab_att_emg+SIGN_CONN_ESTAB_ATT_OTHERS))*(sum(s1_sign_conn_estab_succ_ue) / sum(s1_sign_conn_estab_att_ue))*(sum(erab_ini_setup_succ_qci1 + erab_ini_setup_succ_qci2 + erab_ini_setup_succ_qci3 + erab_ini_setup_succ_qci4 + erab_ini_setup_succ_qci5 + erab_ini_setup_succ_qci6 + erab_ini_setup_succ_qci7 + erab_ini_setup_succ_qci8 + erab_ini_setup_succ_qci9) / sum(erab_ini_setup_att_qci1 + erab_ini_setup_att_qci2 + erab_ini_setup_att_qci3 + erab_ini_setup_att_qci4 + erab_ini_setup_att_qci5 + erab_ini_setup_att_qci6 + erab_ini_setup_att_qci7 + erab_ini_setup_att_qci8 + erab_ini_setup_att_qci9)))) >= 97
                        or (round(100*(sum(erab_rel_ho_part + erab_rel_enb - erab_rel_enb_rnl_ina - erab_rel_enb_rnl_red - erab_rel_enb_rnl_rrna - ifnull(erab_rel_temp_qci1,0)+ ERAB_REL_ENB_INI_S1_GLOB_RESET + ERAB_REL_ENB_INI_S1_PART_RESET + ERAB_REL_S1_OUTAGE) / sum(erab_rel_enb + erab_rel_ho_part + epc_eps_bearer_rel_req_norm + epc_eps_bearer_rel_req_detach + epc_eps_bearer_rel_req_rnl + epc_eps_bearer_rel_req_oth + ifnull(erab_rel_epc_path_switch,0) - ifnull(erab_rel_temp_qci1,0)+ERAB_REL_SUCC_HO_UTRAN + ERAB_REL_SUCC_HO_GERAN + ERAB_REL_ENB_INI_S1_GLOB_RESET + ERAB_REL_MME_INI_S1_GLOB_RESET + ERAB_REL_ENB_INI_S1_PART_RESET + ERAB_REL_MME_INI_S1_PART_RESET + ERAB_REL_S1_OUTAGE)),2)) <= 2
                        or (100*(sum(((SUCC_INTRA_ENB_HO+SUCC_INTER_ENB_HO)+INTER_ENB_S1_HO_SUCC)-HO_INTFREQ_SUCC)/sum(((ATT_INTRA_ENB_HO+ATT_INTER_ENB_HO)+INTER_ENB_S1_HO_ATT)-HO_INTFREQ_ATT))) >= 95,"ok","lock") as status

                        From isat_ws_4g.noklte_ps_lepsb_lncel_day  a JOIN isat_adm.t_list_4g_profile b ON a.mrbts_id = b.MRBTS_ID and a.lnbts_id = b.LNBTS_ID and a.lncel_id = b.LNCEL_ID
                        JOIN isat_ws_4g.noklte_ps_luest_lncel_day c On a.xDate = c.xDate and a.MRBTS_ID = c.MRBTS_ID and a.LNBTS_ID = c.LNBTS_ID and a.LNCEL_ID = c.LNCEL_ID
                        JOIN isat_ws_4g.noklte_ps_lho_lncel_day d On a.xDate = d.xDate and a.MRBTS_ID = d.MRBTS_ID and a.LNBTS_ID = d.LNBTS_ID and a.LNCEL_ID = d.LNCEL_ID
                        JOIN isat_ws_4g.noklte_ps_lianbho_lncel_day e On a.xDate = e.xDate and a.MRBTS_ID = e.MRBTS_ID and a.LNBTS_ID = e.LNBTS_ID and a.LNCEL_ID = e.LNCEL_ID
                        JOIN isat_ws_4g.noklte_ps_lienbho_lncel_day f On a.xDate = f.xDate and a.MRBTS_ID = f.MRBTS_ID and a.LNBTS_ID = f.LNBTS_ID and a.LNCEL_ID = f.LNCEL_ID
                        join isat_ws_4g.noklte_ps_lpqul_lncel_day g On a.xDate = g.xDate and a.MRBTS_ID = g.MRBTS_ID and a.LNBTS_ID = g.LNBTS_ID and a.LNCEL_ID = g.LNCEL_ID
                        join isat_ws_4g.noklte_ps_lcelav_lncel_day h On a.xDate = h.xDate and a.MRBTS_ID = h.MRBTS_ID and a.LNBTS_ID = h.LNBTS_ID and a.LNCEL_ID = h.LNCEL_ID

                        WHERE (A.XDATE  ='""" + currentDate.strftime("%Y-%m-%d") + """'  )
                        Group by
                        a.xdate
                        ,b.SITE_ID
                        ,a.mrbts_id
                        ,a.LNCEL_ID"""
    elif Request == "3G_mycom" :
        sqlscript_query = """select
                    a.xdate
                    ,a.RNC_ID
                    ,a.RNCname
                    ,i.SITE_ID
                    ,a.wbts_id
                    ,a.WBTSname
                    ,a.WCEL_ID
                    ,a.WBTSname

                     ,round(if(avail_wcell_exists_in_rnw_db=0,null, 100*sum(avail_wcell_in_wo_state) / sum(avail_wcell_exists_in_rnw_db)),2) as 'cell_avail'

                    ,round(100* (sum((RAB_ACT_REL_CS_VOICE_P_EMP+RAB_ACT_FAIL_CS_VOICE_IU+RAB_ACT_FAIL_CS_VOICE_RADIO+
                    RAB_ACT_FAIL_CS_VOICE_BTS+RAB_ACT_FAIL_CS_VOICE_IUR+RAB_ACT_FAIL_CS_VOICE_RNC+RAB_ACT_FAIL_CS_VOICE_UE+
                    RAB_ACT_FAIL_CS_VOICE_TRANS+RAB_ACT_FAIL_CS_CONV_IU+RAB_ACT_FAIL_CS_CONV_RADIO+RAB_ACT_FAIL_CS_CONV_BTS+
                    RAB_ACT_FAIL_CS_CONV_RNC+RAB_ACT_FAIL_CS_CONV_IUR+RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_REL_CS_CONV_P_EMP+
                    RAB_ACT_FAIL_CS_CONV_TRANS+RAB_ACT_FAIL_CS_STREA_IU+RAB_ACT_FAIL_CS_STREA_RADIO+RAB_ACT_FAIL_CS_STREA_BTS+
                    RAB_ACT_FAIL_CS_STREA_RNC+RAB_ACT_FAIL_CS_STREA_IUR+RAB_ACT_FAIL_CS_STREA_UE+RAB_ACT_REL_CS_STREA_P_EMP+
                    RAB_ACT_FAIL_CS_STREA_TRANS)))/
                    sum((RAB_ACT_COMP_CS_VOICE+RAB_ACT_REL_CS_VOICE_SRNC+RAB_ACT_REL_CS_VOICE_P_EMP+
                    RAB_ACT_REL_CS_VOICE_HHO+RAB_ACT_REL_CS_VOICE_ISHO+RAB_ACT_REL_CS_VOICE_GANHO+RAB_ACT_FAIL_CS_VOICE_IU+
                    RAB_ACT_FAIL_CS_VOICE_RADIO+RAB_ACT_FAIL_CS_VOICE_BTS+RAB_ACT_FAIL_CS_VOICE_IUR+RAB_ACT_FAIL_CS_VOICE_RNC+
                    RAB_ACT_FAIL_CS_VOICE_UE+RAB_ACT_FAIL_CS_VOICE_TRANS+RAB_ACT_COMP_CS_CONV+RAB_ACT_REL_CS_CONV_SRNC+
                    RAB_ACT_REL_CS_CONV_HHO+RAB_ACT_REL_CS_CONV_ISHO+RAB_ACT_REL_CS_CONV_P_EMP+RAB_ACT_FAIL_CS_CONV_IU+
                    RAB_ACT_FAIL_CS_CONV_RADIO+RAB_ACT_FAIL_CS_CONV_BTS+RAB_ACT_FAIL_CS_CONV_RNC+RAB_ACT_FAIL_CS_CONV_IUR+
                    RAB_ACT_FAIL_CS_CONV_UE+RAB_ACT_FAIL_CS_CONV_TRANS+RAB_ACT_COMP_CS_STREA+RAB_ACT_REL_CS_STREA_SRNC+
                    RAB_ACT_REL_CS_STREA_HHO+RAB_ACT_REL_CS_STREA_ISHO+RAB_ACT_REL_CS_STREA_P_EMP+RAB_ACT_FAIL_CS_STREA_IU+
                    RAB_ACT_FAIL_CS_STREA_RADIO+RAB_ACT_FAIL_CS_STREA_BTS+RAB_ACT_FAIL_CS_STREA_RNC+RAB_ACT_FAIL_CS_STREA_IUR+
                    RAB_ACT_FAIL_CS_STREA_UE+RAB_ACT_FAIL_CS_STREA_TRANS)),2) as 'CDR_CS'

                    ,round(100*if(sum((PS_REL_PRE_EMP_HS_E_INT+PS_REL_PRE_EMP_HS_D_INT+PS_REL_PRE_EMP_HS_E_BGR
                    +PS_REL_PRE_EMP_HS_D_BGR+PS_REL_PRE_EMP_HS_E_STRE+PS_REL_PRE_EMP_HS_D_STRE
                    +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
                    +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
                    +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
                    +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
                    +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_STRE
                    +PS_REL_NORM_HS_D_INT+PS_REL_NORM_HS_D_BGR+PS_SWI_HS_E_TO_D_D_STRE+PS_SWI_HS_E_TO_D_D_INT
                    +PS_SWI_HS_E_TO_D_D_BGR+PS_SWI_HS_D_TO_D_D_STRE+PS_SWI_HS_D_TO_D_D_INT+PS_SWI_HS_D_TO_D_D_BGR))=0,NULL,
                    sum(PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
                    +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
                    +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
                    +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
                    +PS_REL_PRE_EMP_HS_E_INT+PS_REL_PRE_EMP_HS_D_INT+PS_REL_PRE_EMP_HS_E_BGR
                    +PS_REL_PRE_EMP_HS_D_BGR+PS_REL_PRE_EMP_HS_E_STRE+PS_REL_PRE_EMP_HS_D_STRE)
                    /sum(PS_REL_PRE_EMP_HS_E_INT+PS_REL_PRE_EMP_HS_D_INT+PS_REL_PRE_EMP_HS_E_BGR
                    +PS_REL_PRE_EMP_HS_D_BGR+PS_REL_PRE_EMP_HS_E_STRE+PS_REL_PRE_EMP_HS_D_STRE
                    +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
                    +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
                    +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
                    +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
                    +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_STRE
                    +PS_REL_NORM_HS_D_INT+PS_REL_NORM_HS_D_BGR+PS_SWI_HS_E_TO_D_D_STRE+PS_SWI_HS_E_TO_D_D_INT
                    +PS_SWI_HS_E_TO_D_D_BGR+PS_SWI_HS_D_TO_D_D_STRE+PS_SWI_HS_D_TO_D_D_INT+PS_SWI_HS_D_TO_D_D_BGR)),2) as 'CDR PS'

                    ,round(100*if(sum(a.moc_conv_call_atts+a.mtc_conv_call_atts
                    +a.emergency_call_atts-a.RRC_ACC_REL_EMERGENCY-a.RRC_ACC_REL_MO_CONV-a.RRC_ACC_REL_MT_CONV-a.RRC_CONN_STP_REJ_EMERG_CALL+CELL_UPDATE_ATT_CS_CALL)=0, 0,
                    (sum(a.moc_conv_call_atts-a.moc_conv_call_fails+a.mtc_conv_call_atts-a.mtc_conv_call_fails+a.emergency_call_atts-
                    a.emergency_call_fails -a.RRC_ACC_REL_EMERGENCY-a.RRC_ACC_REL_MO_CONV-a.RRC_ACC_REL_MT_CONV + CELL_UPDATE_SUCC_CS_CALL)/sum(a.moc_conv_call_atts+a.mtc_conv_call_atts
                    +a.emergency_call_atts-a.RRC_ACC_REL_EMERGENCY-a.RRC_ACC_REL_MO_CONV-a.RRC_ACC_REL_MT_CONV-a.RRC_CONN_STP_REJ_EMERG_CALL+CELL_UPDATE_ATT_CS_CALL)))
                    *if(sum(a.rab_stp_att_cs_voice+a.rab_stp_att_cs_conv)=0, NULL,sum(a.rab_acc_comp_cs_voice+a.rab_acc_comp_cs_conv)
                    /sum(a.rab_stp_att_cs_voice+a.rab_stp_att_cs_conv)),2) as 'CSSR CS'

                    ,100*((((sum(MOC_INTER_CALL_ATTS + MOC_BACKG_CALL_ATTS + MOC_HIGH_PRIOR_SIGN_ATTS + MTC_INTER_CALL_ATTS + MTC_BACKG_CALL_ATTS + MTC_HIGH_PRIOR_SIGN_ATTS - RRC_ACC_REL_INTERACTIVE - RRC_ACC_REL_MO_BACKGROUND - RRC_ACC_REL_MO_HIGH_PR_SIGN - RRC_ACC_REL_MO_INTERACTIVE - RRC_ACC_REL_MT_BACKGROUND - RRC_ACC_REL_MT_HIGH_PR_SIGN - RRC_ATT_REP_INTERACTIVE - RRC_ATT_REP_MO_INTERACTIVE - RRC_ATT_REP_MO_HIGH_PR_SIGN - RRC_ATT_REP_MO_BACKGROUND - RRC_ATT_REP_MT_BACKGROUND - RRC_ATT_REP_MT_HIGH_PR_SIGN))/(sum(MOC_INTER_CALL_ATTS + MOC_BACKG_CALL_ATTS + MOC_HIGH_PRIOR_SIGN_ATTS + MTC_INTER_CALL_ATTS + MTC_BACKG_CALL_ATTS + MTC_HIGH_PRIOR_SIGN_ATTS - RRC_ACC_REL_INTERACTIVE - RRC_ACC_REL_MO_BACKGROUND - RRC_ACC_REL_MO_HIGH_PR_SIGN - RRC_ACC_REL_MO_INTERACTIVE - RRC_ACC_REL_MT_BACKGROUND - RRC_ACC_REL_MT_HIGH_PR_SIGN - RRC_ATT_REP_INTERACTIVE - RRC_ATT_REP_MO_INTERACTIVE - RRC_ATT_REP_MO_HIGH_PR_SIGN - RRC_ATT_REP_MO_BACKGROUND - RRC_ATT_REP_MT_BACKGROUND - RRC_ATT_REP_MT_HIGH_PR_SIGN + PS_ATT_HSDSCH_EDCH_INT + PS_ATT_HSDSCH_EDCH_BGR + PS_ATT_HSDSCH_DCH_INT + PS_ATT_HSDSCH_DCH_BGR + PS_ATT_DCH_DCH_INT + PS_ATT_DCH_DCH_BGR + PS_ATT_HSDSCH_EDCH_STRE + PS_ATT_HSDSCH_DCH_STRE + PS_ATT_DCH_DCH_STRE))) *
                    ((sum(MOC_INTER_CALL_ATTS - MOC_INTER_CALL_FAILS + MOC_BACKG_CALL_ATTS - MOC_BACKG_CALL_FAILS + MTC_INTER_CALL_ATTS - MTC_INTER_CALL_FAILS + MTC_BACKG_CALL_ATTS - MTC_BACKG_CALL_FAILS + MOC_HIGH_PRIOR_SIGN_ATTS - MOC_HIGH_PRIOR_SIGN_FAILS + MTC_HIGH_PRIOR_SIGN_ATTS - MTC_HIGH_PRIOR_SIGN_FAILS - RRC_ACC_REL_INTERACTIVE - RRC_ACC_REL_MO_BACKGROUND - RRC_ACC_REL_MO_HIGH_PR_SIGN - RRC_ACC_REL_MO_INTERACTIVE - RRC_ACC_REL_MT_BACKGROUND - RRC_ACC_REL_MT_HIGH_PR_SIGN))/(sum(MOC_INTER_CALL_ATTS + MOC_BACKG_CALL_ATTS + MOC_HIGH_PRIOR_SIGN_ATTS + MTC_INTER_CALL_ATTS + MTC_BACKG_CALL_ATTS + MTC_HIGH_PRIOR_SIGN_ATTS - RRC_ACC_REL_INTERACTIVE - RRC_ACC_REL_MO_BACKGROUND - RRC_ACC_REL_MO_HIGH_PR_SIGN - RRC_ACC_REL_MO_INTERACTIVE - RRC_ACC_REL_MT_BACKGROUND - RRC_ACC_REL_MT_HIGH_PR_SIGN - RRC_ATT_REP_INTERACTIVE - RRC_ATT_REP_MO_INTERACTIVE - RRC_ATT_REP_MO_HIGH_PR_SIGN - RRC_ATT_REP_MO_BACKGROUND - RRC_ATT_REP_MT_BACKGROUND - RRC_ATT_REP_MT_HIGH_PR_SIGN)))*
                    ((sum(RAB_ACC_COMP_PS_INTER - ALLO_SUCC_HSPA_DIREAL_INT + RAB_ACC_COMP_PS_BACKG - ALLO_SUCC_HSPA_DIREAL_BGR))/(sum(RAB_STP_ATT_PS_INTER - ALLO_SUCC_HSPA_DIREAL_INT + RAB_STP_ATT_PS_BACKG - ALLO_SUCC_HSPA_DIREAL_BGR))))+

                    (((sum(PS_ATT_HSDSCH_EDCH_INT + PS_ATT_HSDSCH_EDCH_BGR + PS_ATT_HSDSCH_DCH_INT + PS_ATT_HSDSCH_DCH_BGR + PS_ATT_DCH_DCH_INT + PS_ATT_DCH_DCH_BGR + PS_ATT_HSDSCH_EDCH_STRE + PS_ATT_HSDSCH_DCH_STRE + PS_ATT_DCH_DCH_STRE))/(SUM((MOC_INTER_CALL_ATTS + MOC_BACKG_CALL_ATTS + MOC_HIGH_PRIOR_SIGN_ATTS + MTC_INTER_CALL_ATTS + MTC_BACKG_CALL_ATTS + MTC_HIGH_PRIOR_SIGN_ATTS - RRC_ACC_REL_INTERACTIVE - RRC_ACC_REL_MO_BACKGROUND - RRC_ACC_REL_MO_HIGH_PR_SIGN - RRC_ACC_REL_MO_INTERACTIVE - RRC_ACC_REL_MT_BACKGROUND - RRC_ACC_REL_MT_HIGH_PR_SIGN - RRC_ATT_REP_INTERACTIVE - RRC_ATT_REP_MO_INTERACTIVE - RRC_ATT_REP_MO_HIGH_PR_SIGN - RRC_ATT_REP_MO_BACKGROUND - RRC_ATT_REP_MT_BACKGROUND - RRC_ATT_REP_MT_HIGH_PR_SIGN)+(PS_ATT_HSDSCH_EDCH_INT + PS_ATT_HSDSCH_EDCH_BGR + PS_ATT_HSDSCH_DCH_INT + PS_ATT_HSDSCH_DCH_BGR + PS_ATT_DCH_DCH_INT + PS_ATT_DCH_DCH_BGR + PS_ATT_HSDSCH_EDCH_STRE + PS_ATT_HSDSCH_DCH_STRE + PS_ATT_DCH_DCH_STRE))))*
                    ((sum(HS_E_REQ_HS_E_ALLO_INT + HS_E_REQ_HS_E_ALLO_BGR + HS_E_REQ_HS_D_ALLO_INT + HS_E_REQ_HS_D_ALLO_BGR + HS_D_REQ_HS_D_ALLO_INT + HS_D_REQ_HS_D_ALLO_BGR + HS_E_REQ_D_D_ALLO_INT + HS_E_REQ_D_D_ALLO_BGR + HS_D_REQ_D_D_ALLO_INT + HS_D_REQ_D_D_ALLO_BGR + D_D_REQ_D_D_ALLO_INT + D_D_REQ_D_D_ALLO_BGR + HS_E_REQ_HS_E_ALLO_STRE + HS_E_REQ_HS_D_ALLO_STRE + HS_D_REQ_HS_D_ALLO_STRE + HS_E_REQ_D_D_ALLO_STRE + HS_D_REQ_D_D_ALLO_STRE + D_D_REQ_D_D_ALLO_STRE))/(sum(PS_ATT_HSDSCH_EDCH_INT + PS_ATT_HSDSCH_EDCH_BGR + PS_ATT_HSDSCH_DCH_INT + PS_ATT_HSDSCH_DCH_BGR + PS_ATT_DCH_DCH_INT + PS_ATT_DCH_DCH_BGR + PS_ATT_HSDSCH_EDCH_STRE + PS_ATT_HSDSCH_DCH_STRE + PS_ATT_DCH_DCH_STRE))))) as 'CSSR PS'


                    ,round(if( sum(cell_add_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
                    + cell_repl_req_on_sho_for_rt +  cell_add_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt)=0,NULL,
                    100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) /
                    sum(cell_add_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
                    + cell_repl_req_on_sho_for_rt + cell_add_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt)),2) as 'SHO'

                    ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
                    + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'

                    ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL+NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL+RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

                    ,(10*log(10,((power(10,-11.0)*sum(rtwp_class_0) + power(10,-10.75)*sum(rtwp_class_1) + power(10,-10.65)*sum(rtwp_class_2) + power(10,-10.55)*sum(rtwp_class_3) + power(10,-10.45)*sum(rtwp_class_4) + power(10,-10.35)*sum(rtwp_class_5) + power(10,-10.25)*sum(rtwp_class_6) + power(10,-10.15)*sum(rtwp_class_7) + power(10,-10.05)*sum(rtwp_class_8) + power(10,-09.95)*sum(rtwp_class_9) + power(10,-09.85)*sum(rtwp_class_10) + power(10,-09.70)*sum(rtwp_class_11) + power(10,-09.50)*sum(rtwp_class_12) + power(10,-09.30)*sum(rtwp_class_13) + power(10,-09.05)*sum(rtwp_class_14) + power(10,-08.75)*sum(rtwp_class_15) + power(10,-08.45)*sum(rtwp_class_16) + power(10,-08.15)*sum(rtwp_class_17) + power(10,-07.75)*sum(rtwp_class_18) + power(10,-07.25)*sum(rtwp_class_19) + power(10,-06.75)*sum(rtwp_class_20) + power(10,-06.50)*sum(rtwp_class_21))) / ((sum(rtwp_class_0) + sum(rtwp_class_1) + sum(rtwp_class_2) + sum(rtwp_class_3) + sum(rtwp_class_4) + sum(rtwp_class_5) + sum(rtwp_class_6) + sum(rtwp_class_7) + sum(rtwp_class_8) + sum(rtwp_class_9) + sum(rtwp_class_10) + sum(rtwp_class_11) + sum(rtwp_class_12) + sum(rtwp_class_13) + sum(rtwp_class_14) + sum(rtwp_class_15) + sum(rtwp_class_16) + sum(rtwp_class_17) + sum(rtwp_class_18) + sum(rtwp_class_19) + sum(rtwp_class_20) + sum(rtwp_class_21))))) as RNC_19a

                    ,if ((100*((((sum(MOC_INTER_CALL_ATTS + MOC_BACKG_CALL_ATTS + MOC_HIGH_PRIOR_SIGN_ATTS + MTC_INTER_CALL_ATTS + MTC_BACKG_CALL_ATTS + MTC_HIGH_PRIOR_SIGN_ATTS - RRC_ACC_REL_INTERACTIVE - RRC_ACC_REL_MO_BACKGROUND - RRC_ACC_REL_MO_HIGH_PR_SIGN - RRC_ACC_REL_MO_INTERACTIVE - RRC_ACC_REL_MT_BACKGROUND - RRC_ACC_REL_MT_HIGH_PR_SIGN - RRC_ATT_REP_INTERACTIVE - RRC_ATT_REP_MO_INTERACTIVE - RRC_ATT_REP_MO_HIGH_PR_SIGN - RRC_ATT_REP_MO_BACKGROUND - RRC_ATT_REP_MT_BACKGROUND - RRC_ATT_REP_MT_HIGH_PR_SIGN))/(sum(MOC_INTER_CALL_ATTS + MOC_BACKG_CALL_ATTS + MOC_HIGH_PRIOR_SIGN_ATTS + MTC_INTER_CALL_ATTS + MTC_BACKG_CALL_ATTS + MTC_HIGH_PRIOR_SIGN_ATTS - RRC_ACC_REL_INTERACTIVE - RRC_ACC_REL_MO_BACKGROUND - RRC_ACC_REL_MO_HIGH_PR_SIGN - RRC_ACC_REL_MO_INTERACTIVE - RRC_ACC_REL_MT_BACKGROUND - RRC_ACC_REL_MT_HIGH_PR_SIGN - RRC_ATT_REP_INTERACTIVE - RRC_ATT_REP_MO_INTERACTIVE - RRC_ATT_REP_MO_HIGH_PR_SIGN - RRC_ATT_REP_MO_BACKGROUND - RRC_ATT_REP_MT_BACKGROUND - RRC_ATT_REP_MT_HIGH_PR_SIGN + PS_ATT_HSDSCH_EDCH_INT + PS_ATT_HSDSCH_EDCH_BGR + PS_ATT_HSDSCH_DCH_INT + PS_ATT_HSDSCH_DCH_BGR + PS_ATT_DCH_DCH_INT + PS_ATT_DCH_DCH_BGR + PS_ATT_HSDSCH_EDCH_STRE + PS_ATT_HSDSCH_DCH_STRE + PS_ATT_DCH_DCH_STRE))) *
                    ((sum(MOC_INTER_CALL_ATTS - MOC_INTER_CALL_FAILS + MOC_BACKG_CALL_ATTS - MOC_BACKG_CALL_FAILS + MTC_INTER_CALL_ATTS - MTC_INTER_CALL_FAILS + MTC_BACKG_CALL_ATTS - MTC_BACKG_CALL_FAILS + MOC_HIGH_PRIOR_SIGN_ATTS - MOC_HIGH_PRIOR_SIGN_FAILS + MTC_HIGH_PRIOR_SIGN_ATTS - MTC_HIGH_PRIOR_SIGN_FAILS - RRC_ACC_REL_INTERACTIVE - RRC_ACC_REL_MO_BACKGROUND - RRC_ACC_REL_MO_HIGH_PR_SIGN - RRC_ACC_REL_MO_INTERACTIVE - RRC_ACC_REL_MT_BACKGROUND - RRC_ACC_REL_MT_HIGH_PR_SIGN))/(sum(MOC_INTER_CALL_ATTS + MOC_BACKG_CALL_ATTS + MOC_HIGH_PRIOR_SIGN_ATTS + MTC_INTER_CALL_ATTS + MTC_BACKG_CALL_ATTS + MTC_HIGH_PRIOR_SIGN_ATTS - RRC_ACC_REL_INTERACTIVE - RRC_ACC_REL_MO_BACKGROUND - RRC_ACC_REL_MO_HIGH_PR_SIGN - RRC_ACC_REL_MO_INTERACTIVE - RRC_ACC_REL_MT_BACKGROUND - RRC_ACC_REL_MT_HIGH_PR_SIGN - RRC_ATT_REP_INTERACTIVE - RRC_ATT_REP_MO_INTERACTIVE - RRC_ATT_REP_MO_HIGH_PR_SIGN - RRC_ATT_REP_MO_BACKGROUND - RRC_ATT_REP_MT_BACKGROUND - RRC_ATT_REP_MT_HIGH_PR_SIGN)))*
                    ((sum(RAB_ACC_COMP_PS_INTER - ALLO_SUCC_HSPA_DIREAL_INT + RAB_ACC_COMP_PS_BACKG - ALLO_SUCC_HSPA_DIREAL_BGR))/(sum(RAB_STP_ATT_PS_INTER - ALLO_SUCC_HSPA_DIREAL_INT + RAB_STP_ATT_PS_BACKG - ALLO_SUCC_HSPA_DIREAL_BGR))))+
                    (((sum(PS_ATT_HSDSCH_EDCH_INT + PS_ATT_HSDSCH_EDCH_BGR + PS_ATT_HSDSCH_DCH_INT + PS_ATT_HSDSCH_DCH_BGR + PS_ATT_DCH_DCH_INT + PS_ATT_DCH_DCH_BGR + PS_ATT_HSDSCH_EDCH_STRE + PS_ATT_HSDSCH_DCH_STRE + PS_ATT_DCH_DCH_STRE))/(SUM((MOC_INTER_CALL_ATTS + MOC_BACKG_CALL_ATTS + MOC_HIGH_PRIOR_SIGN_ATTS + MTC_INTER_CALL_ATTS + MTC_BACKG_CALL_ATTS + MTC_HIGH_PRIOR_SIGN_ATTS - RRC_ACC_REL_INTERACTIVE - RRC_ACC_REL_MO_BACKGROUND - RRC_ACC_REL_MO_HIGH_PR_SIGN - RRC_ACC_REL_MO_INTERACTIVE - RRC_ACC_REL_MT_BACKGROUND - RRC_ACC_REL_MT_HIGH_PR_SIGN - RRC_ATT_REP_INTERACTIVE - RRC_ATT_REP_MO_INTERACTIVE - RRC_ATT_REP_MO_HIGH_PR_SIGN - RRC_ATT_REP_MO_BACKGROUND - RRC_ATT_REP_MT_BACKGROUND - RRC_ATT_REP_MT_HIGH_PR_SIGN)+(PS_ATT_HSDSCH_EDCH_INT + PS_ATT_HSDSCH_EDCH_BGR + PS_ATT_HSDSCH_DCH_INT + PS_ATT_HSDSCH_DCH_BGR + PS_ATT_DCH_DCH_INT + PS_ATT_DCH_DCH_BGR + PS_ATT_HSDSCH_EDCH_STRE + PS_ATT_HSDSCH_DCH_STRE + PS_ATT_DCH_DCH_STRE))))*
                    ((sum(HS_E_REQ_HS_E_ALLO_INT + HS_E_REQ_HS_E_ALLO_BGR + HS_E_REQ_HS_D_ALLO_INT + HS_E_REQ_HS_D_ALLO_BGR + HS_D_REQ_HS_D_ALLO_INT + HS_D_REQ_HS_D_ALLO_BGR + HS_E_REQ_D_D_ALLO_INT + HS_E_REQ_D_D_ALLO_BGR + HS_D_REQ_D_D_ALLO_INT + HS_D_REQ_D_D_ALLO_BGR + D_D_REQ_D_D_ALLO_INT + D_D_REQ_D_D_ALLO_BGR + HS_E_REQ_HS_E_ALLO_STRE + HS_E_REQ_HS_D_ALLO_STRE + HS_D_REQ_HS_D_ALLO_STRE + HS_E_REQ_D_D_ALLO_STRE + HS_D_REQ_D_D_ALLO_STRE + D_D_REQ_D_D_ALLO_STRE))/(sum(PS_ATT_HSDSCH_EDCH_INT + PS_ATT_HSDSCH_EDCH_BGR + PS_ATT_HSDSCH_DCH_INT + PS_ATT_HSDSCH_DCH_BGR + PS_ATT_DCH_DCH_INT + PS_ATT_DCH_DCH_BGR + PS_ATT_HSDSCH_EDCH_STRE + PS_ATT_HSDSCH_DCH_STRE + PS_ATT_DCH_DCH_STRE)))))) >= 97

                    or (round(100*if(sum((PS_REL_PRE_EMP_HS_E_INT+PS_REL_PRE_EMP_HS_D_INT+PS_REL_PRE_EMP_HS_E_BGR
                    +PS_REL_PRE_EMP_HS_D_BGR+PS_REL_PRE_EMP_HS_E_STRE+PS_REL_PRE_EMP_HS_D_STRE
                    +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
                    +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
                    +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
                    +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
                    +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_STRE
                    +PS_REL_NORM_HS_D_INT+PS_REL_NORM_HS_D_BGR+PS_SWI_HS_E_TO_D_D_STRE+PS_SWI_HS_E_TO_D_D_INT
                    +PS_SWI_HS_E_TO_D_D_BGR+PS_SWI_HS_D_TO_D_D_STRE+PS_SWI_HS_D_TO_D_D_INT+PS_SWI_HS_D_TO_D_D_BGR))=0,NULL,
                    sum(PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
                    +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
                    +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
                    +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
                    +PS_REL_PRE_EMP_HS_E_INT+PS_REL_PRE_EMP_HS_D_INT+PS_REL_PRE_EMP_HS_E_BGR
                    +PS_REL_PRE_EMP_HS_D_BGR+PS_REL_PRE_EMP_HS_E_STRE+PS_REL_PRE_EMP_HS_D_STRE)
                    /sum(PS_REL_PRE_EMP_HS_E_INT+PS_REL_PRE_EMP_HS_D_INT+PS_REL_PRE_EMP_HS_E_BGR
                    +PS_REL_PRE_EMP_HS_D_BGR+PS_REL_PRE_EMP_HS_E_STRE+PS_REL_PRE_EMP_HS_D_STRE
                    +PS_REL_RL_FAIL_HS_E_STRE+PS_REL_RL_FAIL_HS_E_INT+PS_REL_RL_FAIL_HS_E_BGR
                    +PS_REL_RL_FAIL_HS_D_STRE+PS_REL_RL_FAIL_HS_D_INT+PS_REL_RL_FAIL_HS_D_BGR
                    +PS_REL_OTH_FAIL_HS_E_STRE+PS_REL_OTH_FAIL_HS_E_INT+PS_REL_OTH_FAIL_HS_E_BGR
                    +PS_REL_OTH_FAIL_HS_D_STRE+PS_REL_OTH_FAIL_HS_D_INT+PS_REL_OTH_FAIL_HS_D_BGR
                    +PS_REL_NORM_HS_E_STRE+PS_REL_NORM_HS_E_INT+PS_REL_NORM_HS_E_BGR+PS_REL_NORM_HS_D_STRE
                    +PS_REL_NORM_HS_D_INT+PS_REL_NORM_HS_D_BGR+PS_SWI_HS_E_TO_D_D_STRE+PS_SWI_HS_E_TO_D_D_INT
                    +PS_SWI_HS_E_TO_D_D_BGR+PS_SWI_HS_D_TO_D_D_STRE+PS_SWI_HS_D_TO_D_D_INT+PS_SWI_HS_D_TO_D_D_BGR)),2)) <= 2

                    or (round(if( sum(cell_add_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
                    + cell_repl_req_on_sho_for_rt +  cell_add_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt)=0,NULL, 100*sum(succ_updates_on_sho_for_rt + succ_updates_on_sho_for_nrt) / sum(cell_add_req_on_sho_for_rt + cell_del_req_on_sho_for_rt
                    + cell_repl_req_on_sho_for_rt + cell_add_req_on_sho_for_nrt + cell_del_req_on_sho_for_nrt + cell_repl_req_on_sho_for_nrt)),2)) >= 95,"ok","lock") as status

                    from isat_ws_3g.nokrww_ps_servlev_wcel_day a
                    Join isat_ws_3g.nokrww_ps_traffic_wcel_day b On a.xDate=b.xDate and a.RNC_ID = b.RNC_ID and a.WBTS_ID =b.WBTS_ID and a.WCEL_ID = b.WCEL_ID
                    Join isat_ws_3g.nokrww_ps_pktcall_wcel_day c On b.xDate = c.xDate and b.oss = c.oss and b.RNC_ID = c.RNC_ID and b.WBTS_ID = c.WBTS_ID and b.WCEL_ID = c.WCEL_ID
                    Join isat_ws_3g.nokrww_ps_softho_wcel_day d On b.xDate = d.xDate and b.oss = d.oss and b.RNC_ID = d.RNC_ID and b.WBTS_ID = d.WBTS_ID and b.WCEL_ID = d.WCEL_ID
                    Join isat_ws_3g.nokrww_ps_intsysho_wcel_day e On b.xDate = e.xDate and b.oss = e.oss and b.RNC_ID = e.RNC_ID and b.WBTS_ID = e.WBTS_ID and b.WCEL_ID = e.WCEL_ID
                    Join isat_ws_3g.nokrww_ps_rrc_wcel_day f On b.xDate = f.xDate and b.oss = f.oss and b.RNC_ID = f.RNC_ID and b.WBTS_ID = f.WBTS_ID and b.WCEL_ID = f.WCEL_ID
                    Join isat_ws_3g.nokrww_ps_cellres_wcel_day g On b.xDate = g.xDate and b.oss = g.oss and b.RNC_ID = g.RNC_ID and b.WBTS_ID = g.WBTS_ID and b.WCEL_ID = g.WCEL_ID
                    Join isat_ws_3g.nokrww_ps_celltp_wcel_day h On b.xDate = h.xDate and b.oss = h.oss and b.RNC_ID = h.RNC_ID and b.WBTS_ID = h.WBTS_ID and b.WCEL_ID = h.WCEL_ID
                    join isat_adm.t_list_3g_profile i on b.RNC_ID = i.RNC_ID and b.WBTS_ID = i.WBTS_ID and b.WCEL_ID = i.CELL_ID

                    where a.xDate = '""" + currentDate.strftime("%Y-%m-%d") + """'
                    group by
                    a.xdate
                    ,a.RNC_ID
                    ,a.RNCname
                    ,i.SITE_ID
                    ,a.wbts_id
                    ,a.WBTSname
                    ,a.WCEL_ID
                    ,a.WBTSname"""
    elif Request == "2G_mycom" :
        sqlscript_query ="""Select
                    a.xDate
                    ,a.REGION
                    ,a.MICRO_CLUSTER
                    ,a.site_id
                    ,a.BCF_ID
                    ,a.BTS_ID
                    ,a.CELL_ID
                    ,a.BTS_NAME
                    ,100*sum((ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) /sum((ave_non_avail_tch_timeslot/non_avail_tch_denom)+(ave_avail_tch_sum/ave_avail_tch_den)+(ave_gprs_channels_sum/ave_gprs_channels_den)) As Cell_availibility_Ratio

                    ,100*(sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP-ave_dur_ul_tbf_den-ave_dur_dl_tbf_den-UL_TBF_REL_DUE_TO_FLUSH-DL_TBF_REL_DUE_TO_FLUSH-UL_TBF_REL_DUE_TO_SUSPEND-DL_TBF_REL_DUE_TO_SUSPEND-UL_TBF_RELEASES_DUE_DTM-DL_TBF_RELEASES_DUE_DTM)/sum(NBR_OF_UL_TBF+NBR_OF_DL_TBF-UL_TBF_Establishment_Failed-DL_TBF_Establishment_Failed-UL_EGPRS_TBF_REL_DUE_NO_RESP-DL_EGPRS_TBF_REL_DUE_NO_RESP)) as TBF_DROP

                    ,100*(sum(((ifnull(sdcch_assign,0)))*((ifnull(tch_new_call_assign,0)))*(((ifnull(sdcch_assign,0)+ifnull(msc_i_sdcch,0)+ifnull(cell_sdcch,0)+ifnull(bsc_i_sdcch,0)))-((ifnull(sdcch_radio_fail,0)+ifnull(sdcch_rf_old_ho,0)+ifnull(sdcch_user_act,0)+ifnull(sdcch_bcsu_reset,0)+ifnull(sdcch_netw_act,0)+ifnull(sdcch_abis_fail_call,0)+ifnull(sdcch_abis_fail_old,0)+ifnull(sdcch_bts_fail,0)+ifnull(sdcch_lapd_fail,0)+ifnull(sdcch_a_if_fail_call,0)+ifnull(sdcch_a_if_fail_old,0)-ifnull(T3101_EXPIRED,0)))))/sum(((ifnull(sdcch_req,0)))*((ifnull(sdcch_assign,0)+ifnull(msc_i_sdcch,0)+ifnull(cell_sdcch,0)+ifnull(bsc_i_sdcch,0)))*((ifnull(tch_requests_call_attempt,0)))))  as CSSR

                    , ((sum(ifnull(rlc_data_blocks_dl_cs1,0))*20+sum(ifnull(rlc_data_blocks_dl_cs2,0))*30+(sum(ifnull(dl_rlc_block_cs_3,0))*36+sum(ifnull(dl_rlc_block_cs_4,0))*50))/1024) +
                    ((sum(ifnull(dl_rlc_block_mcs_1,0))*22+sum(ifnull(dl_rlc_block_mcs_2,0))*28+sum(ifnull(dl_rlc_block_mcs_3,0))*37+sum(ifnull(dl_rlc_block_mcs_4,0))*44+sum(ifnull(dl_rlc_block_mcs_5,0))*56+sum(ifnull(dl_rlc_block_mcs_6,0))*74+sum(ifnull(dl_rlc_block_mcs_7,0))*112+sum(ifnull(dl_rlc_block_mcs_8,0))*136+sum(ifnull(dl_rlc_block_mcs_9,0))*148)/1024) as gsm_data_total_traffic_DL

                    ,100*(sum(ifnull(drop_after_tch_assign,0))/ sum(ifnull(tch_new_call_assign,0)+ifnull(bsc_i_tch_tch,0)+ifnull(msc_i_tch_tch,0)-ifnull(msc_o_tch_tch,0)-ifnull(bsc_o_tch_tch,0))) as Drop_Call_Rate_2

                    ,sum(period_duration*ave_busy_tch/res_av_denom14/60) TCH_Traffic_trf_24c

                    ,100*(sum(ifnull(msc_o_succ_ho,0)+ifnull(bsc_o_succ_ho,0)+ifnull(cell_succ_ho,0))/sum(ifnull(msc_o_ho_cmd,0)+ifnull(bsc_o_ho_cmd_assgn,0)+ifnull(bts_ho_assgn,0))) as HOSR

                    , if ( ( 100*(sum(((ifnull(sdcch_assign,0)))*((ifnull(tch_new_call_assign,0)))*(((ifnull(sdcch_assign,0)+ifnull(msc_i_sdcch,0)+ifnull(cell_sdcch,0)+ifnull(bsc_i_sdcch,0)))-((ifnull(sdcch_radio_fail,0)+ifnull(sdcch_rf_old_ho,0)+ifnull(sdcch_user_act,0)+ifnull(sdcch_bcsu_reset,0)+ifnull(sdcch_netw_act,0)+ifnull(sdcch_abis_fail_call,0)+ifnull(sdcch_abis_fail_old,0)+ifnull(sdcch_bts_fail,0)+ifnull(sdcch_lapd_fail,0)+ifnull(sdcch_a_if_fail_call,0)+ifnull(sdcch_a_if_fail_old,0)-ifnull(T3101_EXPIRED,0)))))/sum(((ifnull(sdcch_req,0)))*((ifnull(sdcch_assign,0)+ifnull(msc_i_sdcch,0)+ifnull(cell_sdcch,0)+ifnull(bsc_i_sdcch,0)))*((ifnull(tch_requests_call_attempt,0)))))) >=94
                    or (100*(sum(ifnull(drop_after_tch_assign,0))/ sum(ifnull(tch_new_call_assign,0)+ifnull(bsc_i_tch_tch,0)+ifnull(msc_i_tch_tch,0)-ifnull(msc_o_tch_tch,0)-ifnull(bsc_o_tch_tch,0)))) <= 2.5
                    or (100*(sum(ifnull(msc_o_succ_ho,0)+ifnull(bsc_o_succ_ho,0)+ifnull(cell_succ_ho,0))/sum(ifnull(msc_o_ho_cmd,0)+ifnull(bsc_o_ho_cmd_assgn,0)+ifnull(bts_ho_assgn,0)))) >= 93,"ok","lock") as status

                    from isat_project.t_2g_counter_day a
                    Where a.xDate = '""" + currentDate.strftime("%Y-%m-%d") + """'
                    group by
                    a.xDate
                    ,a.REGION
                    ,a.MICRO_CLUSTER
                    ,a.site_id
                    ,a.BCF_ID
                    ,a.BTS_ID
                    ,a.CELL_ID"""
    elif Request == "retu_crel" :
        sqlscript_query = """
            SELECT a.ANTENA
            ,a.AREA
            ,a.BAND
            ,b.oss
            ,a.SITE_ID
            ,a.MRBTS_ID
            ,b.ALD
            ,c.RETU
            ,c.CREL
            ,c.targetCellDN
            ,b.sectorID
            ,if(d.frequencyBandInUse IS NOT NULL,if(d.frequencyBandInUse = 1,"DCS","GSM"),if(e.UARFCN IS NOT NULL,if(e.UARFCN IN ('3013','3037'),"U900","U2100" ),if(g.earfcnDL IS NOT NULL,if(g.earfcnDL = '1625',"L1800",if(g.earfcnDL IN ('3550','3676'),"L900","L2100")),"null"))) AS "Tech"
            ,if(d.frequencyBandInUse IS NOT NULL,if(d.frequencyBandInUse = 1,CONCAT(d.sectorId,"-1800"),CONCAT(d.sectorId,"-900")),if(e.UARFCN IS NOT NULL,if(e.UARFCN IN ('3013','3037'),CONCAT(e.SectorID,"-900"),CONCAT(e.SectorID,"-2100") ),if(g.earfcnDL IS NOT NULL,if(g.earfcnDL = '1625',CONCAT(g.lncel,"-1800"),if(g.earfcnDL IN ('3550','3676'),CONCAT(g.lncel,"-900"),CONCAT(g.lncel,"-2100"))),"null"))) AS "crel_def"
            FROM isat_adm.t_list_4g_profile a
            left JOIN isat_cm.retu b ON a.MRBTS_ID = b.MRBTS
            left JOIN isat_cm.crel c ON b.oss = c.oss AND b.xdate = c.xdate AND b.MRBTS = c.MRBTS AND b.ALD = c.ALD AND b.RETU = c.RETU
            left JOIN isat_cm.bts d ON c.xdate = d.xdate  and c.oss = d.oss   AND c.targetCellDN = d.distName
            left JOIN isat_cm.wcel e ON c.xdate = e.xdate  and c.oss = e.oss   AND c.targetCellDN = e.distName
            left JOIN isat_cm.lncel f ON c.xdate = f.xdate and c.oss = f.oss  AND c.targetCellDN = f.distName
            left JOIN isat_cm.Lncel_fdd g ON f.xdate = g.xdate AND f.oss = g.oss AND f.mrbts= g.mrbts AND f.lncel = g.lncel
            WHERE b.xdate LIKE '2019-07-30'
            GROUP BY a.AREA,a.SITE_ID,a.MRBTS_ID,b.ALD,c.CREL
            ORDER BY a.SITE_ID ASC, b.antSerial ASC
            limit 1000"""
    elif Request == "2GZero" :
        sqlscript_query = """Select
                    a.xDate
                    ,a.BTS_NAME
                    ,a.BSC_ID
                    ,a.BCF_ID
                    ,a.BTS_ID
                    ,a.CELL_ID

                    ,round(sum(period_duration*ave_busy_tch/res_av_denom14/60),1) as TCH_Traffic_trf_24c

                    from isat_project.t_2g_counter_day a
                    Where a.xDate = '""" + currentDate.strftime("%Y-%m-%d") + """' and ((period_duration*ave_busy_tch/res_av_denom14/60))<0.1
                    group by
                    a.xDate
                    ,a.REGION
                    ,a.MICRO_CLUSTER
                    ,a.site_id
                    ,a.BCF_ID
                    ,a.BTS_ID
                    ,a.CELL_ID"""
    elif Request == "3GZero" :
        sqlscript_query ="""select *
                    from
                    (select
                    a.xdate
                    ,a.RNC_ID
                    ,a.RNCname
                    ,a.site_ID
                    ,a.wbts_id
                    ,a.WCEL_ID
                    ,a.wcelname

                    ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
                    + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as Traffic_CS

                    ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL+NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL+RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as Traffic_PS_Mbit

                    from isat_project.t_3g_counter_day a
                    where a.xDate = '""" + currentDate.strftime("%Y-%m-%d") + """'
                    group by
                    a.xdate
                    ,a.RNC_ID
                    ,a.RNCname
                    ,a.site_ID
                    ,a.wbts_id
                    ,a.WBTSname
                    ,a.WCEL_ID
                    ,a.WBTSname) a

                    where Traffic_CS < 0.1 or Traffic_PS_Mbit < 0.1"""
    elif Request == "4GZero" :
        sqlscript_query ="""SELECT
                    a.xdate
                    ,b.SITE_ID
                    ,a.LNCELname
                    ,a.mrbts_id
                    ,a.LNCEL_ID
                    ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,1) as Total_Payload

                    From isat_project.t_4g_counter_day a JOIN isat_adm.t_list_4g_profile b ON a.mrbts_id = b.MRBTS_ID and a.lnbts_id = b.LNBTS_ID and a.lncel_id = b.LNCEL_ID
                    WHERE (A.XDATE  ='""" + currentDate.strftime("%Y-%m-%d") + """') AND (((PDCP_SDU_VOL_DL)/1000000 )+ ((PDCP_SDU_VOL_UL)/1000000))<1
                    Group by
                    a.xdate
                    ,b.SITE_ID
                    ,a.mrbts_id
                    ,a.LNCEL_ID"""
    elif Request == "chart4G" :
        #print("chart4G")
        sqlscript_query ="""SELECT
            xdate
            ,xHour
            ,REGION
            ,sum(Total_Payload) as Total_Payload
            From isat_tmp.susy_4G_traffic
            WHERE (XDATE  >='""" + tigahariyanglalu.strftime("%Y-%m-%d") + """')
            Group by
            xdate
            ,xHour
            ,REGION"""
    elif Request == "chart4G_band" :
        #print("chart4G")
        sqlscript_query ="""SELECT
            xdate
            ,xHour
            ,BAND
            ,sum(Total_Payload) as Total_Payload
            From isat_tmp.susy_4G_traffic
            WHERE (XDATE  >='""" + tigahariyanglalu.strftime("%Y-%m-%d") + """')
            Group by
            xdate
            ,xHour
            ,BAND"""
    elif Request == "chart3G" :
        sqlscript_query ="""SELECT
            xdate
            ,xHour
            ,REGION
            ,Traffic_CS
            ,Traffic_PS_Mbit
            From isat_tmp.susy_3G_traffic
            WHERE (XDATE  >='""" + tigahariyanglalu.strftime("%Y-%m-%d") + """')
            Group by
            xdate
            ,xHour
            ,REGION"""
    elif Request == "chart2G" :
        sqlscript_query ="""SELECT
            xdate
            ,xHour
            ,region
            ,TCH_Traffic_trf_24c
            From isat_tmp.susy_2G_traffic
            WHERE (XDATE  >='""" + tigahariyanglalu.strftime("%Y-%m-%d") + """')
            Group by
            xdate
            ,xHour
            ,region"""
    elif Request == "prl3Gchart":
        sqlscript_query ="""SELECT xdate,xHour,region,COUNT(wbts_id) AS Numsites
        FROM isat_tmp.susy3GPRL_schedule a
        WHERE PLR > 10 AND region IS NOT null and (XDATE  >='""" + tigahariyanglalu.strftime("%Y-%m-%d") + """')
        GROUP BY xdate,xHour,region"""

    elif Request == "prl4Gchart":
        sqlscript_query ="""SELECT xdate,xhour,region,COUNT(mrbts_id) AS Numsites
        FROM isat_tmp.susy4GPRL_schedule a
        WHERE PLR > 10 AND region IS NOT null and (XDATE  >='""" + tigahariyanglalu.strftime("%Y-%m-%d") + """')
        GROUP BY xdate,xHour,region"""
    elif Request == "chart4G_inserttabel" :
        sqlscript_query ="""REPLACE INTO  isat_tmp.susy_4G_traffic

                        SELECT
                        a.xdate
                        ,a.xHour
                        ,b.REGION
                        ,b.Band
                        ,round(sum(PDCP_SDU_VOL_DL)/1000000 + Sum(PDCP_SDU_VOL_UL)/1000000,1) as Total_Payload
                        From isat_project.t_4g_counter_hour a JOIN isat_adm.t_list_4g_profile b ON a.mrbts_id = b.MRBTS_ID and a.lnbts_id = b.LNBTS_ID and a.lncel_id = b.LNCEL_ID

                        WHERE (A.XDATE  >='""" + todayminus4hour.strftime("%Y-%m-%d") + """' ) AND b.region IS NOT null AND b.Band IS NOT null
                        Group by
                        a.xdate
                        ,a.xHour
                        ,b.REGION
                        ,b.Band"""
    elif Request == "chart3G_inserttabel" :
        sqlscript_query ="""REPLACE INTO  isat_tmp.susy_3G_traffic
                            SELECT
                    a.xdate
                    ,a.xHour
                    ,b.REGION
                     ,round(sum(ifnull(avg_rab_hld_tm_cs_voice,0) + ifnull(rab_hold_time_cs_conv_64,0)*64/12.2
                    + ifnull(rab_hold_time_cs_stream_14_4*14.4/12.2,0) + ifnull(rab_hold_time_cs_stream_57_6*57.6/12.2,0)) / (60*100*60),2) as 'Traffic_CS'
                    ,round(sum(NRT_DCH_DL_DATA_VOL+NRT_DCH_UL_DATA_VOL+HS_DSCH_DATA_VOL
                    +NRT_DCH_HSDPA_UL_DATA_VOL+RT_PS_DCH_UL_DATA_VOL
                    +RT_PS_DCH_DL_DATA_VOL+NRT_EDCH_UL_DATA_VOL)/1000000,2) as 'Traffic_PS_Mbit'

                    From isat_project.t_3g_counter_hour_new a JOIN isat_adm.t_list_3g_profile b ON a.RNC_ID = b.RNC_ID AND a.WBTS_ID = b.WBTS_ID AND a.WCEL_ID  = b.CELL_ID
                    WHERE (A.XDATE  >='""" + todayminus4hour.strftime("%Y-%m-%d") + """' ) AND b.region IS NOT null
                    Group by
                    a.xdate
                    ,a.xHour
                     ,b.REGION"""

    elif Request == "chart2G_inserttabel" :
        sqlscript_query ="""REPLACE INTO  isat_tmp.susy_2G_traffic
                        Select
                        a.xDate
                        ,a.xhour
                        ,a.region


                        ,round(sum(period_duration*ave_busy_tch/res_av_denom14/60),1) as TCH_Traffic_trf_24c

                        from isat_project.t_2g_counter_hour a
                        Where a.xDate >='""" + todayminus4hour.strftime("%Y-%m-%d") + """' AND a.region IS NOT null
                        group by
                        a.xDate
                        ,a.xhour
                        ,a.REGION"""
    elif Request == "prl3G":
        sqlscript_query = """REPLACE into isat_tmp.susy3GPRL_schedule
                        select
                        xDate
                        ,xHour
                        ,b.SITE_ID
                        ,b.REGION as region
                        ,a.WBTSname
                        ,a.RNC_ID
                        ,a.WBTS_ID
                        ,round(100*(max(LOSTTWAMPMESSAGES)/max(TXTWAMPMESSAGES)),2) AS `PLR`
                        from isat_ws_3g.nokrww_ps_ftwam_twamp1_hour a JOIN isat_adm.t_list_3g_profile b ON a.RNC_ID = b.RNC_ID AND a.WBTS_ID = b.WBTS_ID
                        WHERE a.xDate >= '""" + todayminus4hour.strftime("%Y-%m-%d") + """' AND REGION IS NOT NULL AND a.WBTS_ID IS NOT NULL AND a.RNC_ID IS NOT null
                        group by
                        xDate
                        ,xhour
                        ,b.SITE_ID
                        ,a.RNC_ID
                        ,a.WBTS_ID"""

    elif Request == "prl4G":
        sqlscript_query ="""REPLACE into isat_tmp.susy4GPRL_schedule

                        select
                        xDate
                        ,Xhour
                        ,b.SITE_ID
                        ,b.REGION as region
                        ,a.MRBTSname
                        ,a.MRBTS_ID
                        ,round(100*(max(LOSTTWAMPMESSAGES)/max(TXTWAMPMESSAGES)),2) AS `PLR`
                        from isat_ws_4g.nokmrn_ps_twam_twamp_hour a JOIN isat_adm.t_list_4g_profile b  ON a.MRBTS_ID = b.MRBTS_ID
                        WHERE a.xDate >= '""" + todayminus4hour.strftime("%Y-%m-%d") + """'  AND REGION IS NOT NULL AND a.MRBTSname IS NOT NULL AND Xhour IS NOT null
                        group by
                        xDate
                        ,Xhour
                        ,a.MRBTS_ID"""
    elif Request == "2GcriticalBTS" :
            sqlscript_query ="""select a.oss,a.xdate,a.distName,a.BSC,a.BCF,a.BTS,a.cellId,a.name
                        , a.frequencyBandInUse
                        , a.amhTrhoGuardTime
                        , a.amhLowerLoadThreshold
                        , a.amhMaxLoadOfTgtCell
                        , a.amhUpperLoadThreshold
                        , a.diversityUsed
                        , a.maxNumberRetransmission
                        , a.radioLinkTimeout
                        , a.rxLevAccessMin
                        , a.timerPeriodicUpdateMs
                        , a.cellReselectParamInd
                        , a.cellReselectOffset
                        , a.dedicatedGPRScapacity
                        , a.defaultGPRScapacity
                        , a.fddQMin
                        , a.maxGPRSCapacity
                        , a.qSearchI
                        , a.qSearchP
                        , a.callReestablishmentAllowed
                        , a.drInUse
                        , a.precPagingUsage
                        , a.wcdmaPriority
                        , a.gsmPriority
                        , a.cnThreshold
                        , a.btsLoadThreshold
                        , a.drMethod
                        , a.multiBandCellReporting
                        , a.nbrOfSlotsSpreadTrans
                        , a.preferBCCHfreqGPRS2
                        , a.rachDropRxLevelThreshold
                        , a.radioLinkTimeoutAmr
                        , a.radioLinkTimeoutAmrHr
                        , a.btsSpLoadDepTchRateLower
                        , a.btsSpLoadDepTchRateUpper
                        , a.amrConfHrStartMode
                        , a.amrConfFrInitCodecMode
                        , a.amrConfHrInitCodecMode
                        , a.amrConfHrHysteresis1
                        , a.amrConfHrHysteresis2
                        , a.amrHoHrInHoThrDlRxQual
                        , a.amrWbFrHysteresis1
                        , a.amrWbFrHysteresis2
                        , a.amrHoHrThrDlRxQual
                        , a.amrHoHrThrUlRxQual
                        , a.amrConfHrDlThreshold1
                        , a.amrConfHrUlThreshold1
                        , a.amrConfHrDlThreshold2
                        , a.amrConfHrUlThreshold2
                        , a.amrPocFrPcLThrDlRxQual
                        , a.amrPocHrPcLThrDlRxQual
                        , a.amrPocFrPcLThrUlRxQual
                        , a.amrPocHrPcLThrUlRxQual
                        , a.amrHoFrInHoThrDlRxQual
                        , a.amrHoFrThrDlRxQual
                        , a.amrHoFrThrUlRxQual
                        , a.amrPocFrPcUThrDlRxQual
                        , a.amrPocFrPcUThrUlRxQual
                        , a.amrPocHrPcUThrDlRxQual
                        , a.amrPocHrPcUThrUlRxQual
                        , a.amrSegLoadDepTchRateLower
                        , a.amrSegLoadDepTchRateUpper
                        , a.amrWbFrCodecModeSet
                        , a.egprsInitMcsUnAckMode
                        , a.egprsInitMcsAckMode
                        , a.trxPriorityInTchAlloc


                        from isat_cm.bts a
                        where a.xdate like '""" + nowdate.strftime("%Y-%m-%d") + """' and (a.name like '%xxx%' or a.name like '%xyx%')
                        group by a.distName"""

    elif Request == "2GcriticalPOC" :
            sqlscript_query ="""select a.oss,a.xdate,a.distName,a.BSC,a.BCF,a.BTS,a.cellId,a.name
                        , a.frequencyBandInUse
    					, b.pcControlInterval
                        , b.pcLTQualDlNx
                        , b.pcLTQualDlPx
                        , b.pcLTQualUlNx
                        , b.pcLTQualUlPx
                        , b.pcUTQualDlNx
                        , b.pcUTQualDlPx
                        , b.pcUTQualUlNx
                        , b.pcUTQualUlPx
                        , b.enableAla
                        , b.pcALUlWeighting
                        , b.pcAQLUlWeighting
                        , b.pcLTQualUlRxQual
                        , b.pcLowerThresholdsLevDLRxLevel
                        , b.pcUpperThresholdsLevULRxLevel
                        , b.transmitPowerReduction
                        , b.pcUpperThresholdDlRxQualDhr
                        , b.pcUpperThresholdUlRxQualDhr
                        , b.powerDecrQualFactor
                        , b.pcAQLDlWindowSize
                        , b.pcUTQualUlRxQual
                        , b.pcALUlWindowSize
                        , b.pcALDlWindowSize
                        , b.pcLowerThresholsLevULRxLevel
                        , b.pcUpperThresholdsLevDLRxLevel
                        , b.pcUTQualDlRxQual

                        from isat_cm.bts a
                        Join isat_cm.POC b On a.oss = b.oss and a.xdate = b.xdate and a.BSC = b.bsc and a.BCF = b.bcf and a.BTS and b.bts
                        where a.xdate like '""" + nowdate.strftime("%Y-%m-%d") + """' and (a.name like '%xxx%' or a.name like '%xyx%')
                        group by a.distName"""

    elif Request == "2GcriticalHOC" :
            sqlscript_query ="""select a.oss,a.xdate,a.distName,a.BSC,a.BCF,a.BTS,a.cellId,a.name
                        , a.frequencyBandInUse
                        , c.amhTrafficControlMCN
                        , c.amhTrhoPbgtMargin
                        , c.enaFastAveHo
                        , c.enaFastAvePc
                        , c.enableMsDistance
                        , c.hoAveragingLevUlWeighting
                        , c.hoTLDlRxLevel
                        , c.hoTLUlRxLevel
                        , c.hoTQDlRxQual
                        , c.hoTQUlRxQual
                        , c.intraHoLoRxQualLimAmr
                        , c.intraHoUpRxLevLimAmrHr
                        , c.minIntBetweenUnsuccHoAttempt
                        , c.qSearchC
                        , c.hoTQDlPx
                        , c.hoTQUlPx
                        , c.hoAveragingQualUlWeighting
                        , c.hoTQDlNx
                        , c.hoTQUlNx
                        , c.enaFastAveCallSetup


                        from isat_cm.bts a
                        Join isat_cm.HOC c On a.oss = c.oss and a.xdate = c.xdate and a.BSC = c.bsc and a.BCF = c.bcf and a.BTS and c.bts
                        where a.xdate like '""" + nowdate.strftime("%Y-%m-%d") + """' and (a.name like '%xxx%' or a.name like '%xyx%')
                        group by a.distName"""
    elif Request == "3Gcritical" :
        sqlscript_query ="""select a.xdate,a.oss, c.SITE_id, a.name,a.RNC,a.WBTS,a.WCEL
                , a.MaxDLPowerCapability
                , a.PtxCellMax
                , a.PtxMaxHSDPA
                , a.PtxTarget
                , a.ptxoffset
                , a.PtxTargetPSMax
                , a.PtxTargetPSMin
                , a.PtxHighHSDPAPwr
                , a.PtxPrimaryCPICH
                from isat_cm.wcel a
                Join isat_adm.t_list_3g_profile c on a.rnc = c.rnc_id and a.wbts = c.wbts_id and a.WCEL = c.CELL_ID
                where a.xdate like '""" + nowdate.strftime("%Y-%m-%d") + """'
                and (a.name like '%XXX%' or a.name like '%XYX%')
                group by  a.xdate,a.oss, a.RNC,a.WBTS,a.WCEL"""
    elif Request == "4Gcritical" :
        sqlscript_query ="""select a.xdate,a.oss,c.SITE_id,a.name,a.MRBTS,a.LNBTS,a.LNCEL, b.dlChBw,a.pMax,b.dlRsBoost
                    from isat_cm.lncel a
                    Join isat_cm.lncel_fdd b
                    On a.oss = b.oss and a.xdate = b.xdate and a.MRBTS = b.MRBTS and a.LNCEL = b.LNCEL
                    Join isat_adm.t_list_4g_profile C
                    on a.mrbts = c.MRBTS_ID and a.lncel = c.LNCEL_ID
                    where a.xdate like '""" + nowdate.strftime("%Y-%m-%d") + """' and (a.name like '%XXX%' or a.name like '%XYX%')"""
    elif Request == "4G_today_create_table" :
        sqlscript_query = """TRUNCATE isat_tmp.susy4G_today;
                    Replace into isat_tmp.susy4G_today
                    select a.oss,a.xdate,c.SITE_ID,a.name, a.cellname, a.MRBTS,a.lnbts,a.LNCEL,b.earfcnDL,b.dlchbw, a.pMax
                    from isat_cm.lncel a
                    Join isat_cm.LNcel_fdd b
                    On a.oss = b.oss and  a.xdate = b.xdate and a.LNBTS = b.lnbts and a.MRBTS = b.mrbts and a.LNCEL = b.lncel
                    Join isat_adm.t_list_4g_profile c on a.mrbts = c.MRBTS_ID and a.lncel = c.LNCEL_ID
                    where a.xdate = '""" + nowdate.strftime("%Y-%m-%d") + """'
                    group by a.oss,a.xdate, a.MRBTS,a.lnbts,a.LNCEL;"""
    elif Request == "4G_yesterday_create_table" :
        sqlscript_query = """TRUNCATE isat_tmp.susy4G_yesterday;
                    Replace into isat_tmp.susy4G_yesterday
                    select a.oss,a.xdate,c.SITE_ID,a.name, a.cellname, a.MRBTS,a.lnbts,a.LNCEL,b.earfcnDL,b.dlchbw, a.pMax
                    from isat_cm.lncel a
                    Join isat_cm.LNcel_fdd b
                    On a.oss = b.oss and  a.xdate = b.xdate and a.LNBTS = b.lnbts and a.MRBTS = b.mrbts and a.LNCEL = b.lncel
                    Join isat_adm.t_list_4g_profile c on a.mrbts = c.MRBTS_ID and a.lncel = c.LNCEL_ID
                    where a.xdate = '""" + currentDate.strftime("%Y-%m-%d") + """'
                    group by a.oss,a.xdate, a.MRBTS,a.lnbts,a.LNCEL;"""
    elif Request == "3G_today_create_table" :
        sqlscript_query = """TRUNCATE isat_tmp.susy3G_today;
                    REPLACE INTO isat_tmp.susy3G_today
                    select a.oss,a.xdate,c.SITE_ID,a.name,a.RNC,a.WBTS,a.WCEL,b.IPNBId,a.PtxCellMax,a.MBLBStateTransEnabled
                    from isat_cm.wcel a Join isat_cm.wbts b
                    On a.oss = b.oss and  a.xdate = b.xdate and a.rnc = b.rnc and a.wbts = b.wbts
                    Join isat_adm.t_list_3g_profile c on a.rnc = c.rnc_id and a.wbts = c.wbts_id and a.WCEL = c.CELL_ID
                    where a.xdate = '""" + nowdate.strftime("%Y-%m-%d") + """'
                    group by  a.oss,a.xdate, a.RNC,a.WBTS,a.WCEL;"""
    elif Request == "3G_yesterday_create_table" :
        sqlscript_query = """TRUNCATE isat_tmp.susy3G_yesterday;
                    REPLACE INTO isat_tmp.susy3G_yesterday
                    select a.oss,a.xdate,c.SITE_ID,a.name,a.RNC,a.WBTS,a.WCEL,b.IPNBId,a.PtxCellMax,a.MBLBStateTransEnabled
                    from isat_cm.wcel a Join isat_cm.wbts b
                    On a.oss = b.oss and  a.xdate = b.xdate and a.rnc = b.rnc and a.wbts = b.wbts
                    Join isat_adm.t_list_3g_profile c on a.rnc = c.rnc_id and a.wbts = c.wbts_id and a.WCEL = c.CELL_ID
                    where a.xdate = '""" + currentDate.strftime("%Y-%m-%d") + """'
                    group by  a.oss,a.xdate, a.RNC,a.WBTS,a.WCEL;"""
    elif Request == "2G_today_create_table" :
        sqlscript_query = """TRUNCATE isat_tmp.susy2G_today;
                    REplace into isat_tmp.susy2G_today
                    select a.oss,a.xdate,c.SITE_ID,a.name,a.BSC,a.BCF,a.BTS,b.TRX,a.frequencyBandInUse
                    from isat_cm.bts a
                    Join isat_cm.trx b
                    On a.oss = b.oss and  a.xdate = b.xdate and a.bsc = b.bsc and a.bcf = b.bcf and a.bts = b.bts
                    Join isat_adm.t_list_2g_profile c
                    on a.bsc = c.bscid and a.bcf = c.bcfid and a.bts = c.btsid
                    where a.xdate = '""" + todayminus4hour.strftime("%Y-%m-%d") + """'
                    group by a.oss,a.xdate, a.BSC,a.BCF,a.BTS,b.TRX;"""
    elif Request == "2G_yesterday_create_table" :
        sqlscript_query = """TRUNCATE isat_tmp.susy2G_yesterday;
                    REplace into isat_tmp.susy2G_yesterday
                    select a.oss,a.xdate,c.SITE_ID,a.name,a.BSC,a.BCF,a.BTS,b.TRX,a.frequencyBandInUse
                    from isat_cm.bts a
                    Join isat_cm.trx b
                    On a.oss = b.oss and  a.xdate = b.xdate and a.bsc = b.bsc and a.bcf = b.bcf and a.bts = b.bts
                    Join isat_adm.t_list_2g_profile c
                    on a.bsc = c.bscid and a.bcf = c.bcfid and a.bts = c.btsid
                    where a.xdate = '""" + currentDate.strftime("%Y-%m-%d") + """'
                    group by a.oss,a.xdate, a.BSC,a.BCF,a.BTS,b.TRX;"""
    elif Request == "get_missing_4G" :
        sqlscript_query = """SELECT
                    a.oss,a.xdate,a.SITE_ID,a.name, a.cellname, a.MRBTS,a.lnbts,a.LNCEL,a.earfcnDL,a.dlchbw, a.pMax,"Missing" AS remark
                    from  isat_tmp.susy4G_yesterday a
                    left Join isat_tmp.susy4G_today b
                    On a.oss = b.oss and a.LNBTS = b.LNBTS and a.MRBTS = b.MRBTS and a.LNCEL = b.LNCEL
                    WHERE b.lncel IS null
                    group by a.oss, a.MRBTS,a.lnbts,a.LNCEL"""
    elif Request == "get_missing_3G" :
        sqlscript_query = """SELECT
                    a.oss,a.xdate,a.SITE_ID,a.name,a.RNC,a.WBTS,a.WCEL,a.IPNBId,a.PtxCellMax,a.MBLBStateTransEnabled, "Missing" AS Remark
                    from  isat_tmp.susy3G_yesterday a
                    left Join isat_tmp.susy3G_today b
                    ON a.oss = b.oss and a.rnc = b.rnc and a.wbts = b.wbts and a.WCEL = b.WCEL
                    WHERE b.WCEL IS null
                    group BY a.oss, a.RNC,a.WBTS,a.WCEL;"""
    elif Request == "get_missing_2G" :
        sqlscript_query = """SELECT
                    a.oss,a.xdate,a.SITE_ID,a.name,a.BSC,a.BCF,a.BTS,a.TRX,a.frequencyBandInUse, "Missing" AS Remark
                    from  isat_tmp.susy2G_yesterday a
                    left Join isat_tmp.susy2G_today b
                    On a.oss = b.oss AND a.bsc = b.bsc and a.bcf = b.bcf and a.bts = b.bts
                    WHERE b.BTS IS null
                    group by a.oss, a.BSC,a.BCF,a.BTS,a.TRX;"""
    elif Request == "get_union_4G" :
        sqlscript_query = """(SELECT
                    a.oss,a.xdate,a.SITE_ID,b.NAME AS yesterdayName,a.NAME AS todayName, a.cellname,
                    a.MRBTS,a.lnbts,a.LNCEL,a.earfcnDL,a.dlchbw, a.pMax,"newXXX" AS remark
                    from isat_tmp.susy4G_today a
                    Join isat_tmp.susy4G_yesterday b
                    On a.oss = b.oss and a.LNBTS = b.LNBTS and a.MRBTS = b.MRBTS and a.LNCEL = b.LNCEL
                    WHERE (a.NAME  LIKE '%XXX%' ) AND (b.NAME NOT LIKE '%XXX%')
                    group by a.oss, a.MRBTS,b.mrbts,a.lnbts,b.lnbts,a.LNCEL,b.lncel
                    )
                    UNION
                    (SELECT
                    a.oss,a.xdate,a.SITE_ID,b.NAME AS yesterdayName,a.NAME AS todayName, a.cellname,
                    a.MRBTS,a.lnbts,a.LNCEL,a.earfcnDL,a.dlchbw, a.pMax,"newXYX" AS remark
                    from isat_tmp.susy4G_today a
                    Join isat_tmp.susy4G_yesterday b
                    On a.oss = b.oss and a.LNBTS = b.LNBTS and a.MRBTS = b.MRBTS and a.LNCEL = b.LNCEL
                    WHERE (a.NAME  LIKE '%XYX%') AND (b.NAME NOT LIKE '%XYX%')
                    group by a.oss, a.MRBTS,b.mrbts,a.lnbts,b.lnbts,a.LNCEL,b.lncel
                    )
                    UNION
                    (SELECT
                    a.oss,a.xdate,a.SITE_ID,b.NAME AS yesterdayName,a.NAME AS todayName, a.cellname,
                    a.MRBTS,a.lnbts,a.LNCEL,a.earfcnDL,a.dlchbw, a.pMax,"removalXXX" AS remark
                    from isat_tmp.susy4G_today a
                    Join isat_tmp.susy4G_yesterday b
                    On a.oss = b.oss and a.LNBTS = b.LNBTS and a.MRBTS = b.MRBTS and a.LNCEL = b.LNCEL
                    WHERE (b.NAME LIKE '%XXX%') AND (a.NAME NOT LIKE '%XYX%' ) AND (a.NAME NOT LIKE '%XXX%')
                    group by a.oss, a.MRBTS,b.mrbts,a.lnbts,b.lnbts,a.LNCEL,b.lncel
                    )
                    UNION
                    (SELECT
                    a.oss,a.xdate,a.SITE_ID,b.NAME AS yesterdayName,a.NAME AS todayName, a.cellname,
                    a.MRBTS,a.lnbts,a.LNCEL,a.earfcnDL,a.dlchbw, a.pMax,"removalXYX" AS remark
                    from isat_tmp.susy4G_today a
                    Join isat_tmp.susy4G_yesterday b
                    On a.oss = b.oss and a.LNBTS = b.LNBTS and a.MRBTS = b.MRBTS and a.LNCEL = b.LNCEL
                    WHERE (b.NAME LIKE '%XYX%') AND (a.NAME NOT LIKE '%XYX%' ) AND (a.NAME NOT LIKE '%XXX%')
                    group by a.oss, a.MRBTS,b.mrbts,a.lnbts,b.lnbts,a.LNCEL,b.lncel
                    )"""
    elif Request == "get_union_3G" :
        sqlscript_query = """(select
                    a.oss,a.xdate,a.SITE_ID,b.NAME AS yesterdayName,a.NAME AS todayName,a.RNC,a.WBTS,a.WCEL,a.IPNBId,a.PtxCellMax,a.MBLBStateTransEnabled,"newXXX" AS Remark
                    from isat_tmp.susy3G_today a
                    Join isat_tmp.susy3G_yesterday b
                    On a.oss = b.oss and a.rnc = b.rnc and a.wbts = b.wbts and a.WCEL = b.WCEL
                    WHERE (a.NAME  LIKE '%XXX%' ) AND (b.NAME NOT LIKE '%XXX%')
                    group by a.oss, a.rnc, b.rnc, a.wbts, b.wbts, a.WCEL, b.WCEL
                    )
                    UNION
                    (SELECT
                    a.oss,a.xdate,a.SITE_ID,b.NAME AS yesterdayName,a.NAME AS todayName,a.RNC,a.WBTS,a.WCEL,a.IPNBId,a.PtxCellMax,a.MBLBStateTransEnabled,"newXYX" AS Remark
                    from isat_tmp.susy3G_today a
                    Join isat_tmp.susy3G_yesterday b
                    On a.oss = b.oss and a.rnc = b.rnc and a.wbts = b.wbts and a.WCEL = b.WCEL
                    WHERE (a.NAME  LIKE '%XYX%' ) AND (b.NAME NOT LIKE '%XYX%')
                    group by a.oss, a.rnc, b.rnc, a.wbts, b.wbts, a.WCEL, b.WCEL
                    )
                    UNION
                    (SELECT
                    a.oss,a.xdate,a.SITE_ID,b.NAME AS yesterdayName,a.NAME AS todayName,a.RNC,a.WBTS,a.WCEL,a.IPNBId,a.PtxCellMax,a.MBLBStateTransEnabled,"removalXXX" AS Remark
                    from isat_tmp.susy3G_today a
                    Join isat_tmp.susy3G_yesterday b
                    On a.oss = b.oss and a.rnc = b.rnc and a.wbts = b.wbts and a.WCEL = b.WCEL
                    WHERE (b.NAME LIKE '%XXX%') AND (a.NAME NOT LIKE '%XYX%' ) AND (a.NAME NOT LIKE '%XXX%')
                    group by a.oss, a.rnc, b.rnc, a.wbts, b.wbts, a.WCEL, b.WCEL
                    )
                    UNION
                    (SELECT
                    a.oss,a.xdate,a.SITE_ID,b.NAME AS yesterdayName,a.NAME AS todayName,a.RNC,a.WBTS,a.WCEL,a.IPNBId,a.PtxCellMax,a.MBLBStateTransEnabled,"removalXXX" AS Remark
                    from isat_tmp.susy3G_today a
                    Join isat_tmp.susy3G_yesterday b
                    On a.oss = b.oss and a.rnc = b.rnc and a.wbts = b.wbts and a.WCEL = b.WCEL
                    WHERE (b.NAME LIKE '%XYX%') AND (a.NAME NOT LIKE '%XYX%' ) AND (a.NAME NOT LIKE '%XXX%')
                    group by a.oss, a.rnc, b.rnc, a.wbts, b.wbts, a.WCEL, b.WCEL
                    )"""
    elif Request == "get_union_2G" :
        sqlscript_query = """(select
                    a.oss,a.xdate,a.SITE_ID,b.NAME AS yesterdayName,a.NAME AS todayName,a.BSC,a.BCF,a.BTS,a.TRX,a.frequencyBandInUse,"newXXX" AS Remark
                    from isat_tmp.susy2G_today a
                    Join isat_tmp.susy2G_yesterday b
                    On a.oss = b.oss and a.bsc = b.bsc and a.bcf = b.bcf and a.bts = b.bts AND a.TRX = b.TRX
                    WHERE (a.NAME  LIKE '%XXX%' ) AND (b.NAME NOT LIKE '%XXX%')
                    group by a.oss, a.bsc, b.bsc, a.bcf, b.bcf, a.bts, b.bts
                    )
                    UNION
                    (SELECT
                    a.oss,a.xdate,a.SITE_ID,b.NAME AS yesterdayName,a.NAME AS todayName,a.BSC,a.BCF,a.BTS,a.TRX,a.frequencyBandInUse,"newXYX" AS Remark
                    from isat_tmp.susy2G_today a
                    Join isat_tmp.susy2G_yesterday b
                    On a.oss = b.oss and a.bsc = b.bsc and a.bcf = b.bcf and a.bts = b.bts AND a.TRX = b.TRX
                    WHERE (a.NAME  LIKE '%XYX%' ) AND (b.NAME NOT LIKE '%XYX%')
                    group by a.oss, a.bsc, b.bsc, a.bcf, b.bcf, a.bts, b.bts
                    )
                    UNION
                    (SELECT
                    a.oss,a.xdate,a.SITE_ID,b.NAME AS yesterdayName,a.NAME AS todayName,a.BSC,a.BCF,a.BTS,a.TRX,a.frequencyBandInUse,"removalXXX" AS Remark
                    from isat_tmp.susy2G_today a
                    Join isat_tmp.susy2G_yesterday b
                    On a.oss = b.oss and a.bsc = b.bsc and a.bcf = b.bcf and a.bts = b.bts
                    WHERE (b.NAME LIKE '%XXX%') AND (a.NAME NOT LIKE '%XYX%' ) AND (a.NAME NOT LIKE '%XXX%')
                    group by a.oss, a.bsc, b.bsc, a.bcf, b.bcf, a.bts, b.bts
                    )
                    UNION
                    (SELECT
                    a.oss,a.xdate,a.SITE_ID,b.NAME AS yesterdayName,a.NAME AS todayName,a.BSC,a.BCF,a.BTS,a.TRX,a.frequencyBandInUse,"removalXYX" AS Remark
                    from isat_tmp.susy2G_today a
                    Join isat_tmp.susy2G_yesterday b
                    On a.oss = b.oss and a.bsc = b.bsc and a.bcf = b.bcf and a.bts = b.bts
                    WHERE (b.NAME LIKE '%XYX%') AND (a.NAME NOT LIKE '%XYX%' ) AND (a.NAME NOT LIKE '%XXX%')
                    group by a.oss, a.bsc, b.bsc, a.bcf, b.bcf, a.bts, b.bts
                    )"""
    return(sqlscript_query)
